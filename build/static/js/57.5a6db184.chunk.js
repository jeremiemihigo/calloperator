"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[57],{803105:(e,t,n)=>{n.d(t,{Z:()=>r});var l=n(876767),i=n(648623),s=n(624631),d=n(346417);const o=(0,l.D)();const r=function(e){let{value:t,setValue:n,options:l,title:r,propr:a}=e;return(0,d.jsx)(i.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>o(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:l,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+a],renderOption:(e,t)=>(0,d.jsx)("li",{...e,children:t[""+a]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,d.jsx)(s.Z,{...e,label:r||"Titre"})})}},792628:(e,t,n)=>{n.d(t,{Z:()=>h});var l=n(557829),i=n(565280),s=n(406740),d=n(747313),o=n(346417);function r(e){const{children:t,value:n,index:i,...s}=e;return(0,o.jsx)("div",{role:"tabpanel",hidden:n!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...s,children:n===i&&(0,o.jsx)(l.Z,{sx:{p:3},children:t})})}function a(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:t,components:n}=e;const[c,h]=d.useState(0);return(0,o.jsxs)(l.Z,{sx:{width:"100%"},children:[(0,o.jsx)(l.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,o.jsx)(s.Z,{value:c,onChange:(e,t)=>{h(t)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:t.map(((e,t)=>(0,d.createElement)(i.Z,{label:e.label,...a(e.id),key:t})))})}),n.map(((e,t)=>(0,o.jsx)(r,{value:c,index:e.id,children:e.component},t)))]})}const h=d.memo(c)},925057:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var l=n(435045),i=n(809019),s=n(369099),d=n(319159),o=n(835662),r=n(209478),a=n(803105),c=n(792628),h=n(747313),x=n(594500),p=n(661395),u=(n(245135),n(346417));const g=function(e){let{listeDemande:t}=e;return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{className:"statDemande",children:t&&(0,u.jsxs)("p",{style:{textAlign:"center"},children:[(0,u.jsx)("span",{style:{color:"red",marginRight:"10px",fontSize:"1rem"},children:t.filter((e=>e.reponse.length>0)).length}),"demande(s) repondue(s) sur",(0,u.jsx)("span",{style:{color:"red",margin:"7px",fontSize:"1rem"},children:t.length})," demande(s) envoy\xe9e(s)",(0,u.jsx)("span",{style:{color:"red",margin:"7px",fontSize:"1rem"},children:isNaN((100*t.filter((e=>e.reponse.length>0)).length/t.length).toFixed(0))?"":"Soit "+(100*t.filter((e=>e.reponse.length>0)).length/t.length).toFixed(0)+"%"})]})})})};var m=n(372541),j=n(861689),f=n(542420),v=n(270501),b=n(818580),Z=n(416031),y=n.n(Z),S=n(985038),w=n(406740),C=n(565280),A=n(261113),N=n(557829),P=n(70816),D=n.n(P);function z(e){let{data:t}=e;const[n,l]=h.useState({fn:e=>e});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.ZP,{container:!0,sx:{marginBottom:"10px"},children:(0,u.jsx)(i.ZP,{item:!0,lg:8,children:(0,u.jsx)(d.default,{type:"text",onChange:e=>(e=>{let t=e.target.value.toUpperCase();l({fn:e=>""===t?e:e.filter((e=>e.reponse[0].codeclient.includes(t)||e.reponse[0].nomClient.includes(t)))})})(e),placeholder:"Code client ou nom du client"})})}),(0,u.jsx)(i.ZP,{container:!0,children:t&&n.fn((e=>{try{return e.filter((e=>e.reponse.length>0))}catch(t){return[]}})(t)).map((e=>(0,u.jsx)(i.ZP,{sx:{padding:"3px"},item:!0,lg:6,children:(0,u.jsxs)("div",{className:"messagesToutes",children:[(0,u.jsxs)("div",{className:"listeImage",children:[(0,u.jsx)("img",{src:`${p.BP}/${e.file}`,alt:e._id}),(0,u.jsxs)(A.Z,{component:"p",sx:{fontSize:"13px"},children:[void 0!==e.codeclient&&e.codeclient,";",null===e||void 0===e?void 0:e.sat," ",null===e||void 0===e?void 0:e.reference,null===e||void 0===e?void 0:e.statut,"; ",null===e||void 0===e?void 0:e.raison.toLowerCase(),", ",e.numero&&e.numero,";"]})]}),(0,u.jsx)("div",{className:"itemButtons"}),(0,u.jsx)("div",{children:e.conversation.length>0&&e.conversation.map((e=>(0,u.jsxs)("div",{className:"agent"===e.sender?"agent":"callcenter",children:[(0,u.jsx)("p",{className:"messageText",children:e.message}),(0,u.jsx)("p",{className:"heure",children:D()(e.createdAt).fromNow()})]},e._id)))}),(0,u.jsx)("div",{children:e.reponse.length>0&&e.reponse.map((e=>(0,u.jsxs)("div",{className:"reponseListe",children:[(0,u.jsx)("p",{children:e.codeclient}),(0,u.jsx)("p",{style:{fontWeight:"bold"},children:e.nomClient.toUpperCase()}),(0,u.jsxs)("p",{children:["Statut du client : ",(0,u.jsx)("span",{style:{fontWeight:"bolder"},children:e.clientStatut})," "]}),(0,u.jsxs)("p",{children:["Statut payement : ",(0,u.jsx)("span",{style:{fontWeight:"bolder"},children:e.PayementStatut})]}),(0,u.jsxs)("p",{children:["consExpDays :"," ",(0,u.jsxs)("span",{style:{fontWeight:"bolder"},children:[e.consExpDays," jour(s) "]})]}),(0,u.jsx)("p",{children:e.followup?"Categorie : Follow_up":"Categorie : visite"}),(0,u.jsx)("p",{children:null===e||void 0===e?void 0:e.codeCu})]},e._id)))})]})},e._id)))}),t&&0===t.length&&(0,u.jsx)("p",{style:{fontSize:"12px",marginTop:"20px",textAlign:"center",color:"red"},children:"Aucune demande trouv\xe9e"})]})}const k=h.memo(z);var $=n(396180);const B=function(e){let{data:t}=e;const[n,l]=$.ZP.useMessage(),[s,o]=h.useState({fn:e=>e});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(u.Fragment,{children:l}),(0,u.jsx)(i.ZP,{container:!0,sx:{marginBottom:"10px"},children:(0,u.jsx)(i.ZP,{item:!0,lg:8,children:(0,u.jsx)(d.default,{type:"text",onChange:e=>(e=>{let t=e.target.value.toUpperCase();o({fn:e=>""===t?e:e.filter((e=>e.codeclient.includes(t)))})})(e),placeholder:"Code client ou ID demande"})})}),(0,u.jsx)(i.ZP,{container:!0,children:t&&s.fn((e=>{try{return e.filter((e=>0===e.reponse.length))}catch(t){return[]}})(t)).map((e=>(0,u.jsxs)(i.ZP,{item:!0,lg:12,className:"messagesToutes",children:[(0,u.jsxs)("div",{className:"listeImage",children:[(0,u.jsx)("img",{src:`${p.BP}/${e.file}`,alt:e._id}),(0,u.jsxs)(A.Z,{component:"p",sx:{fontSize:"13px"},children:[(0,u.jsxs)(A.Z,{children:["ID : ",e.idDemande,(0,u.jsx)(A.Z,{component:"span",onClick:()=>{return t=e.idDemande,navigator.clipboard.writeText(t),void n.open({type:"success",content:"Done "+t,duration:2});var t},style:{marginLeft:"10px",color:"blue",fontWeight:"bolder",cursor:"pointer",textAlign:"center"},children:"copy ID"}),(0,u.jsx)("span",{style:{float:"right",fontSize:"10px"},children:D()(e.createdAt).fromNow()})]}),void 0!==e.codeclient&&e.codeclient,";",null===e||void 0===e?void 0:e.sat," ",null===e||void 0===e?void 0:e.reference,null===e||void 0===e?void 0:e.statut,"; ",null===e||void 0===e?void 0:e.raison.toLowerCase(),", ",e.numero&&e.numero,";"]})]}),(0,u.jsx)("div",{className:"itemButtons"}),(0,u.jsx)("div",{children:e.conversation.length>0&&e.conversation.map((e=>(0,u.jsxs)("div",{className:"agent"===e.sender?"agent":"callcenter",children:[(0,u.jsx)("p",{className:"messageText",children:e.message}),(0,u.jsx)("p",{className:"heure",children:D()(e.createdAt).fromNow()})]},e._id)))})]},e._id)))}),t&&0===t.length&&(0,u.jsx)("p",{style:{fontSize:"12px",marginTop:"20px",textAlign:"center",color:"red"},children:"Aucune demande trouv\xe9e"})]})};function F(e){const{children:t,value:n,index:l,...i}=e;return(0,u.jsx)("div",{role:"tabpanel",hidden:n!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,...i,children:n===l&&(0,u.jsx)(N.Z,{sx:{p:3},children:(0,u.jsx)(A.Z,{children:t})})})}function T(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function I(e){let{data:t}=e;const[n,l]=h.useState(0);return(0,u.jsxs)(N.Z,{sx:{width:"100%",minWidth:"30rem"},children:[(0,u.jsx)(N.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,u.jsxs)(w.Z,{value:n,onChange:(e,t)=>{l(t)},"aria-label":"basic tabs example",children:[(0,u.jsx)(C.Z,{label:"Valide",...T(0)}),(0,u.jsx)(C.Z,{label:"Attente",...T(1)})]})}),(0,u.jsx)(F,{value:n,index:0,children:(0,u.jsx)(k,{data:t})}),(0,u.jsx)(F,{value:n,index:1,children:(0,u.jsx)(B,{data:t})})]})}const O=function(e){let{listeDemande:t}=e;const[n,l]=h.useState(),[i,s]=h.useState(!1),[o,r]=h.useState();h.useEffect((()=>{(()=>{const e=y().groupBy(t,"codeAgent");try{let n=[],i=Object.keys(e);for(let e=0;e<i.length;e++)n.push({nom:t.filter((t=>t.agent.codeAgent===i[e]))[0].agent.nom,code:i[e],nonRepondu:t.filter((t=>t.agent.codeAgent===i[e]&&0===t.reponse.length)).length,repondu:t.filter((t=>t.agent.codeAgent===i[e]&&t.reponse.length>0&&!t.reponse[0].followup)).length,followup:t.filter((t=>t.agent.codeAgent===i[e]&&t.reponse.length>0&&t.reponse[0].followup)).length,total:t.filter((t=>t.agent.codeAgent===i[e])).length,id:e});l(y().orderBy(n,"total","desc"))}catch(n){console.log(n)}})()}),[t]);const[a,c]=h.useState({fn:e=>e}),x=[{field:"nom",headerName:"Nom Agent",width:250,editable:!1},{field:"code",headerName:"Code Agent",width:130,editable:!1},{field:"repondu",headerName:"Conformes",width:80,editable:!1},{field:"followup",headerName:"Followup",width:80,editable:!1},{field:"nonRepondu",headerName:"Attentes",width:70,editable:!1},{field:"total",headerName:"Total",width:70,editable:!1},{field:"action",headerName:"Action",width:100,editable:!1,renderCell:e=>(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(j.Z,{title:"Plus les d\xe9tails",onClick:n=>((e,n)=>{e.preventDefault(),r(y().filter(t,{codeAgent:n})),s(!0)})(n,e.row.code),children:(0,u.jsx)(f.Z,{size:"small",color:"primary",children:(0,u.jsx)(m.default,{fontSize:"small"})})})})}];return(0,u.jsxs)(v.Z,{elevation:3,sx:{padding:"10px"},children:[(0,u.jsx)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,u.jsx)("div",{style:{width:"30%"},children:(0,u.jsx)(d.default,{onChange:e=>(e=>{let t=e.target.value.toUpperCase();c({fn:e=>""===t?e:e.filter((e=>e.code.includes(t)||e.nom.includes(t)))})})(e),placeholder:"Cherchez le Code agent ou nom Agent"})})}),n&&(0,u.jsx)(b._$,{rows:a.fn(n),columns:x,initialState:{pagination:{paginationModel:{pageSize:7}}},pageSizeOptions:[7],checkboxSelection:!0,disableRowSelectionOnClick:!0}),o&&(0,u.jsx)(S.Z,{open:i,setOpen:s,title:`pour ${o[0].agent.nom} -------- code : ${o[0].agent.codeAgent}`,children:(0,u.jsx)(I,{data:o})})]})};var V=n(71978),_=n(961157),E=n(337169),R=n(326236),W=n(75767),L=n(942450),K=n(763743),U=n(573203),q=n(75854);function M(e){let{donner:t,recherche:n}=e;const[l,s]=(0,h.useState)({datas:[]}),{datas:d}=l;return(0,h.useEffect)((()=>{(()=>{let e=[];const n=y().groupBy(t,"zone.denomination");let l=Object.keys(n);for(let t=0;t<l.length;t++)e.push({region:l[t],agent:n[""+l[t]].filter((e=>"agent"===e.agent.fonction)).length,tech:n[""+l[t]].filter((e=>"tech"===e.agent.fonction)).length});s({datas:e})})()}),[t]),(0,u.jsx)(i.ZP,{container:!0,sx:{height:"25rem"},children:(0,u.jsx)(i.ZP,{item:!0,lg:12,children:!n.codeAgent&&(0,u.jsx)(V.h,{width:"100%",children:(0,u.jsxs)(_.v,{data:d,children:[(0,u.jsx)(E.q,{strokeDasharray:"3 3"}),(0,u.jsx)(R.K,{dataKey:"region"}),(0,u.jsx)(W.B,{}),(0,u.jsx)(L.u,{}),(0,u.jsx)(K.D,{}),(0,u.jsx)(U.$,{dataKey:"agent",fill:"#8884d8",activeBar:(0,u.jsx)(q.A,{fill:"pink",stroke:"blue"})}),(0,u.jsx)(U.$,{dataKey:"tech",fill:"#82ca9d",activeBar:(0,u.jsx)(q.A,{fill:"gold",stroke:"purple"})})]})})})})}const G=(0,h.memo)(M);const H=function(e){let{listeDemande:t,region:n}=e;const l=(0,x.v9)((e=>e.zone.zone));console.log(l),console.log(n);const i=(e,n,l)=>{try{return(t&&t.filter((e=>e.reponse.length>0))).filter((t=>t.reponse[0].clientStatut===n&&t.reponse[0].PayementStatut===l&&t.codeZone===e)).length}catch(i){console.log(i)}},s=e=>{try{return(t&&t.filter((e=>0===e.reponse.length))).filter((t=>t.codeZone===e)).length}catch(n){console.log(n)}},d=e=>{try{let n=t&&t.filter((t=>t.codeZone===e));return{total:n.length,pourcentage:(100*n.length/t.length).toFixed(0)}}catch(n){console.log(n)}};return(0,u.jsx)(v.Z,{elevation:3,children:(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{style:{background:"#dedede"},children:[(0,u.jsx)("td",{children:"Region"}),(0,u.jsx)("td",{children:"Statut du client"}),(0,u.jsx)("td",{children:"Statut payement"}),(0,u.jsx)("td",{children:"Nombre"}),(0,u.jsx)("td",{children:"En attente"})]})}),(0,u.jsx)("tbody",{children:(n?[n]:l).map(((e,t)=>(0,u.jsxs)(h.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{rowSpan:"7",children:e.denomination}),(0,u.jsx)("td",{children:"installed"}),(0,u.jsx)("td",{children:"Normal"}),(0,u.jsx)("td",{children:i(e.idZone,"installed","normal")}),(0,u.jsx)("td",{rowSpan:"6",style:{fontSize:"25px",fontWeight:"bolder"},children:s(e.idZone)})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"installed"}),(0,u.jsx)("td",{children:"expired"}),(0,u.jsx)("td",{children:i(e.idZone,"installed","expired")})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"installed"}),(0,u.jsx)("td",{children:"Defaulted"}),(0,u.jsx)("td",{children:i(e.idZone,"installed","defaulted")})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"pending repossession"}),(0,u.jsx)("td",{children:"defaulted"}),(0,u.jsx)("td",{children:i(e.idZone,"pending repossession","defaulted")})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"pending activation"}),(0,u.jsx)("td",{children:"pending fulfliment"}),(0,u.jsx)("td",{children:i(e.idZone,"pending activation","pending fulfliment")})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"inactive"}),(0,u.jsx)("td",{children:"terminated"}),(0,u.jsx)("td",{children:i(e.idZone,"inactive","terminated")})]}),(0,u.jsxs)("tr",{style:{background:"#dedede"},children:[(0,u.jsx)("td",{colSpan:"3",children:"Total"}),(0,u.jsxs)("td",{style:{padding:"0px",margin:"0px",fontWeight:"bolder"},children:[(0,u.jsx)("span",{style:{fontSize:"15px"},children:d(e.idZone).total}),(0,u.jsxs)("span",{children:[" "," Soit "+d(e.idZone).pourcentage,"%"]})]})]})]},t)))})]})})};const J=function(){const e=(0,x.v9)((e=>e.zone)),[t,n]=h.useState(""),[m,j]=h.useState(""),[f,v]=h.useState({debut:"",fin:""}),{debut:b,fin:Z}=f,[y,S]=h.useState(!1),[w,C]=h.useState(),[A,N]=h.useState();return h.useEffect((()=>{w&&(async()=>{S(!0);try{o.Z.post(p.V6+"/demandeAgentAll",{data:w,debut:b.split("T")[0],fin:Z.split("T")[0]},p.vc).then((e=>{"token expired"===e.data?(localStorage.removeItem("auth"),window.location.replace("/login")):(N(e.data),S(!1))}))}catch(e){console.log(e)}})()}),[w]),(0,u.jsxs)(r.Z,{children:[(0,u.jsxs)(i.ZP,{container:!0,children:[(null===e||void 0===e?void 0:e.zone.length)>0&&(0,u.jsx)(i.ZP,{item:!0,lg:2,sm:6,xs:12,md:6,sx:{padding:"5px"},children:(0,u.jsx)(a.Z,{value:t,setValue:n,options:e.zone,title:"R\xe9gions",propr:"denomination"})}),t&&(0,u.jsx)(i.ZP,{item:!0,lg:2,sm:6,md:6,xs:12,sx:{padding:"5px"},children:(0,u.jsx)(a.Z,{value:m,setValue:j,options:t.shop,title:"Shop",propr:"shop"})}),(0,u.jsx)(i.ZP,{item:!0,lg:3,sm:6,xs:12,md:6,sx:{padding:"5px",display:"flex",alignItems:"center"},children:(0,u.jsx)(d.default,{type:"date",onChange:e=>v({...f,debut:e.target.value}),placeholder:"Date"})}),(0,u.jsx)(i.ZP,{item:!0,lg:3,sm:6,xs:12,md:6,sx:{padding:"5px",display:"flex",alignItems:"center"},children:(0,u.jsx)(d.default,{onChange:e=>v({...f,fin:e.target.value}),type:"date",placeholder:"Date"})}),(0,u.jsx)(i.ZP,{item:!0,lg:2,sx:{padding:"5px",display:"flex",alignItems:"center"},children:(0,u.jsxs)(s.Z,{color:"primary",variant:"contained",disabled:y,onClick:e=>(e=>{e.preventDefault();const n={region:t?t.idZone:void 0,idShop:m?m.idShop:void 0};let l={};void 0!==n.idShop&&(l.idShop=n.idShop),void 0!==n.region&&(l.codeZone=n.region),C(l)})(e),children:[(0,u.jsx)(l.Z,{fontSize:"small"})," ",(0,u.jsx)("span",{style:{marginLeft:"5px"},children:y?"Loading...":"Rechercher"})]})})]}),(0,u.jsx)(i.ZP,{container:!0,children:(0,u.jsx)(i.ZP,{item:!0,lg:12,children:A&&(0,u.jsxs)(i.ZP,{children:[(0,u.jsx)(g,{listeDemande:A}),(0,u.jsx)(c.Z,{titres:[{id:0,label:"Graphique"},{id:1,label:"R\xe9gions"},{id:2,label:"Agents"}],components:[{id:0,component:(0,u.jsx)(G,{donner:A,recherche:w})},{id:1,component:(0,u.jsx)(H,{region:t,listeDemande:A})},{id:2,component:(0,u.jsx)(O,{listeDemande:A})}]})]})})})]})}},245135:()=>{}}]);