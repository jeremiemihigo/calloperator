(self.webpackChunkfront=self.webpackChunkfront||[]).push([[801],{803105:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(81270),a=n(648623),r=n(624631),o=n(346417);const s=(0,i.D)();const d=function(e){let{value:t,setValue:n,options:i,title:d,propr:l}=e;return(0,o.jsx)(a.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>s(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:i,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+l],renderOption:(e,t)=>(0,o.jsx)("li",{...e,children:t[""+l]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,o.jsx)(r.Z,{...e,label:d||"Titre"})})}},680509:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(786138),a=n(747313),r=n(346417);const o=function(e){const{message:t}=e,[n,o]=a.useState(!0);return(0,r.jsx)("div",{children:(0,r.jsx)(i.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:()=>{o(!1)},message:t},"bottom center")})}},792628:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(557829),a=n(565280),r=n(406740),o=n(747313),s=n(346417);function d(e){const{children:t,value:n,index:a,...r}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:n!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...r,children:n===a&&(0,s.jsx)(i.Z,{sx:{p:3},children:t})})}function l(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:t,components:n}=e;const[c,u]=o.useState(0);return(0,s.jsxs)(i.Z,{sx:{width:"100%"},children:[(0,s.jsx)(i.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,s.jsx)(r.Z,{value:c,onChange:(e,t)=>{u(t)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:t.map(((e,t)=>(0,o.createElement)(a.Z,{label:e.label,...l(e.id),key:t})))})}),n.map(((e,t)=>(0,s.jsx)(d,{value:c,index:e.id,children:e.component},t)))]})}const u=o.memo(c)},907293:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var i=n(270501),a=n(792628),r=n(319159),o=n(835662),s=n(210658),d=n.n(s),l=n(747313),c=n(262682),u=n(661395),h=(n(699042),n(346417));const p=function(){const[e,t]=l.useState(!1),[n,i]=l.useState();l.useEffect((()=>{(async()=>{try{t(!0);const e=await o.Z.get(u.xK+"/doublon",u.vc);if(console.log(e),200===e.status){let n=[];for(let t=0;t<e.data.length;t++)n.push({codeclient:e.data[t].precedent.codeclient,premier_visiteur:e.data[t].precedent.demandeur.codeAgent,premier_feedback:e.data[t].precedent.demande.raison,premiere_date:d()(e.data[t].precedent.demande.updatedAt).format("DD/MM/YYYY"),deuxieme_codeAgent:e.data[t].presents.codeAgent,deuxieme_feedback:e.data[t].presents.raison,deuxieme_date:d()(e.data[t].createdAt).format("DD/MM/YYYY")});i(n),t(!1)}}catch(e){console.log(e),e&&t(!1)}})()}),[]);const[a,s]=l.useState({fn:e=>e});return console.log(n),(0,h.jsxs)("div",{children:[e&&(0,h.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),(0,h.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,h.jsx)("div",{style:{width:"40%"},children:(0,h.jsx)(r.default,{onChange:e=>(e=>{let t=e.target.value.toUpperCase();s({fn:e=>""===t?e:e.filter((e=>e.codeclient.includes(t)))})})(e),placeholder:"Cherchez le Code client"})}),n&&n.length>0&&(0,h.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,h.jsx)(c.Z,{data:n,title:"Doublon",fileName:"Doublon.xlsx"})})]}),n&&(0,h.jsxs)("table",{id:"theTable",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"code client"}),(0,h.jsx)("th",{children:"codeAgent"}),(0,h.jsx)("th",{children:"Premier feedback"}),(0,h.jsx)("th",{children:"Deuxieme codeAgent"}),(0,h.jsx)("th",{children:"Deuxieme Feedback"}),(0,h.jsx)("th",{children:"Deuxieme Date"})]})}),(0,h.jsx)("tbody",{children:a.fn(n).map(((e,t)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.codeclient}),(0,h.jsx)("td",{children:e.premier_visiteur}),(0,h.jsx)("td",{children:e.premier_feedback}),(0,h.jsx)("td",{children:e.premiere_date}),(0,h.jsx)("td",{children:e.deuxieme_codeAgent}),(0,h.jsx)("td",{children:e.deuxieme_feedback}),(0,h.jsx)("td",{children:e.deuxieme_date})]},t)))})]})]})};var m=n(435045),x=n(809019),f=n(369099),v=n(585281),g=n(261113),j=n(803105),S=n(680509),b=n(416031),y=n.n(b),Z=n(594500),w=n(528756);const D=function(e){let{data:t}=e;const[n]=l.useState(Object.keys(y().groupBy(t,"demandeur.fonction"))),i=(0,Z.v9)((e=>e.zone.zone)),a=(e,n)=>{let i=[],a=[];return i=t.filter((t=>t.idZone===e)),a=t.filter((t=>t.idZone===e&&t.demandeur.fonction===n)),{region:i.length,agentTech:a.length}},r=(e,n)=>t.filter((t=>t.idShop===e&&t.demandeur.fonction===n)).length;return(0,h.jsx)(h.Fragment,{children:i&&i.length<1?(0,h.jsx)("p",{style:{textAlign:"center"},children:"Loading..."}):(0,h.jsxs)("table",{children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"R\xe9gion/Shop"}),n&&n.map((e=>(0,h.jsx)("td",{children:e},e))),(0,h.jsx)("td",{children:"Total"})]})}),(0,h.jsxs)("tbody",{children:[i&&i.length>0&&i.map(((e,t)=>{var i;return(0,h.jsxs)(l.Fragment,{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{style:{backgroundColor:"#dedede"},children:e.denomination}),n&&n.map((t=>(0,h.jsx)("td",{style:{backgroundColor:"#dedede"},children:a(e.idZone,t).agentTech},t))),(0,h.jsx)("td",{style:{backgroundColor:"#dedede"},children:a(e.idZone).region})]}),null===(i=e.shop)||void 0===i?void 0:i.map(((e,t)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.shop}),n&&n.map((t=>(0,h.jsx)("td",{children:r(e.idShop,t)},e))),(0,h.jsx)("td",{children:r(e.idShop,"tech")+r(e.idShop,"agent")})]},t)))]},t)})),(0,h.jsxs)("tr",{className:"total",children:[(0,h.jsx)("td",{children:"Total g\xe9n\xe9ral"}),n&&n.map((e=>{return(0,h.jsx)("td",{children:(n=e,t.filter((e=>e.demandeur.fonction===n)).length)},e);var n})),(0,h.jsx)("td",{children:t.length})]})]})]})})};var $=n(373951),E=n(614680);const O=function(e){let{data:t,dates:n}=e;const[i,a]=l.useState();return l.useEffect((()=>{(()=>{let e=[],n=y().toArray(Object.keys(y().countBy(t,"demande.raison")));for(let i=0;i<n.length;i++)e.push({title:n[i],nombre:t.filter((e=>e.demande.raison===n[i])).length,id:i});a(y().orderBy(e,"nombre","desc"))})()}),[t]),(0,h.jsxs)("div",{children:[(0,h.jsx)(x.ZP,{className:"pagesTitle",children:(0,h.jsxs)(g.Z,{component:"span",children:["Les plaintes du ",(0,u.ou)(n.debut)," au ",(0,u.ou)(n.fin)]})}),i&&(0,h.jsx)(E._$,{rows:i,columns:[{field:"title",headerName:"Raison",width:250,editable:!1},{field:"nombre",headerName:"Nombre",width:50,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:6}}},pageSizeOptions:[6],checkboxSelection:!0,disableRowSelectionOnClick:!0})]})};var M=n(358446);const T=function(e){let{data:t}=e;const[n,i]=l.useState({options:[],series:[]});l.useEffect((()=>{(()=>{let e=[],n=[],a=y().toArray(Object.keys(y().countBy(t,"agentSave.nom")));for(let i=0;i<a.length;i++)e.push(a[i]),n.push(t.filter((e=>e.agentSave.nom===a[i])).length);i({series:n,options:e})})()}),[t]);const a={chart:{id:"basic-bar"},xaxis:{categories:n.options}},r=[{name:"series-1",data:n.series}];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x.ZP,{className:"pagesTitle",children:(0,h.jsx)(g.Z,{children:"Statistiques Call operator"})}),(0,h.jsx)("div",{className:"mixed-chart",children:(0,h.jsx)(M.Z,{options:a,series:r,type:"bar",width:"100%",height:400})})]})};const k=function(){const[e,t]=l.useState({debut:"",fin:""}),[n,a]=l.useState([]),[s,d]=l.useState(),[p,b]=l.useState(""),[E,M]=l.useState(""),k=(0,Z.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[C,A]=l.useState(""),[P,N]=l.useState(""),_=e=>"null"!==e&&"undefined"!==e&&e?e:"",z=e=>`${e.split("T")[0]}`,[R,I]=l.useState(!1),F=(e,t)=>{let n=(new Date(t.createdAt).getTime()-new Date(e.updatedAt).getTime())/6e4;return n<1?1:n},L=(0,Z.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),Y=(0,Z.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),U=(e,t)=>{return"zone"===t?y().filter(Y,{idZone:e})[0].denomination:null===(n=y().filter(L,{idShop:e})[0])||void 0===n?void 0:n.shop;var n},H=e=>`${e.split("T")[1].split(":")[0]}:${e.split("T")[1].split(":")[1]}`,[V,W]=l.useState(),B=async()=>{try{if((0,u.uS)(e.debut,e.fin)>31)W("Les jours ne doivent pas aller au del\xe0 de 31");else if(""===E||""===e.debut||""===e.fin)W("Veuillez renseigner les champs");else{let Z={};Z.key=E,Z.value="idShop"===E?null===C||void 0===C?void 0:C.idShop:"idZone"===E&&(null===P||void 0===P?void 0:P.idZone);let w={};"overall"!==Z.key&&(w.key=Z.key,w.value=Z.value);let D={debut:e.debut,fin:e.fin,followUp:!1,dataTosearch:w};I(!0);const O=await o.Z.post(u.xK+"/rapport",D,u.vc);if("token expired"===O.data)localStorage.removeItem("auth"),window.location.replace("/login");else{a(O.data);let o=[];for(let e=0;e<O.data.length;e++){var t,n,i,r,s,l,c,h,p,m,x,f,v,g,j,S;o.push({idDemande:O.data[e].idDemande,ID:O.data[e].codeclient,NOMS:O.data[e].nomClient,"SERIAL NUMBER":_(O.data[e].codeCu),"CLIENT STATUS":O.data[e].clientStatut,"PAYMENT STATUS":O.data[e].PayementStatut,"CONS. EXP. DAYS":"normal"===O.data[e].PayementStatut?0:Math.abs(O.data[e].consExpDays),REGION:U(O.data[e].idZone,"zone"),SHOP:U(null===(t=O.data[e])||void 0===t?void 0:t.idShop,"shop"),"CODE AGENT":O.data[e].demandeur.codeAgent,"NOMS DU DEMANDEUR":O.data[e].demandeur.nom,Fonction:(y=O.data[e].demandeur.fonction,"tech"===y?"TECH":"agent"===y?"SA":["agent","tech"].includes(y)?void 0:y),"DATE DE REPONSE":z(O.data[e].dateSave),"C.O":null===(n=O.data[e].agentSave)||void 0===n?void 0:n.nom,"STATUT DE LA DEMANDE":O.data[e].demande.typeImage,"DATE D'ENVOIE":z(O.data[e].demande.updatedAt),"HEURE D'ENVOI":H(O.data[e].demande.updatedAt),"HEURE DE REPONSE":H(O.data[e].createdAt),"TEMPS MOYEN":`${F(O.data[e].demande,O.data[e]).toFixed(0)}`,LONGITUDE:_(null===(i=O.data[e].coordonnee)||void 0===i?void 0:i.longitude),LATITUDE:_(null===(r=O.data[e].coordonnee)||void 0===r?void 0:r.latitude),ALTITUDE:_(null===(s=O.data[e].coordonnee)||void 0===s?void 0:s.altitude),"ETAT PHYSIQUE":"allumer"===(null===(l=O.data[e].demande)||void 0===l?void 0:l.statut)?"allum\xe9":"eteint",RAISON:null===(c=O.data[e].demande)||void 0===c?void 0:c.raison,Item_Swap:null===(h=O.data[e].demande)||void 0===h?void 0:h.itemswap,COMMUNE:null===(p=O.data[e].demande)||void 0===p?void 0:p.commune,QUARTIER:null===(m=O.data[e].demande)||void 0===m?void 0:m.sector,AVENUE:null===(x=O.data[e].demande)||void 0===x?void 0:x.cell,REFERENCE:null===(f=O.data[e].demande)||void 0===f?void 0:f.reference,SAT:null===(v=O.data[e].demande)||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(g=O.data[e].demande)||void 0===g?void 0:g.numero)?null===(j=O.data[e].demande)||void 0===j?void 0:j.numero:"",Adresse:null===(S=O.data[e])||void 0===S?void 0:S.adresschange})}I(!1),d(o),b((0,$.generateNomFile)(e,"Visite menage"))}}}catch(Z){console.log(Z)}var y};return(0,h.jsxs)(i.Z,{sx:{padding:"5px"},elevation:3,children:[V&&(0,h.jsx)(S.Z,{message:V}),L&&L.length>0&&Y&&Y.length>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsxs)(x.ZP,{container:!0,children:[(0,h.jsx)(x.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,h.jsx)(w.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:E,setValue:M})}),k&&"idZone"===E&&(0,h.jsx)(x.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,h.jsx)(j.Z,{value:P,setValue:N,options:k,title:"Selectionnez la region",propr:"denomination"})}),L&&"idShop"===E&&(0,h.jsx)(x.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,h.jsx)(j.Z,{value:C,setValue:A,options:L,title:"Shop",propr:"shop"})}),(0,h.jsx)(x.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,h.jsx)(r.default,{type:"date",onChange:n=>t({...e,debut:n.target.value}),placeholder:"Date"})}),(0,h.jsx)(x.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,h.jsx)(r.default,{onChange:n=>t({...e,fin:n.target.value}),type:"date",placeholder:"Date"})}),(0,h.jsx)(x.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,h.jsx)(f.Z,{disabled:R,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>B(),children:R?(0,h.jsx)(v.Z,{size:12}):(0,h.jsx)(m.Z,{fontSize:"small"})})}),!R&&(0,h.jsx)(x.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,h.jsx)(c.Z,{data:s,title:"",fileName:`${p}.xlsx`})})]})}),n.length>0&&(0,h.jsxs)(x.ZP,{container:!0,children:[(0,h.jsx)(x.ZP,{item:!0,lg:5,sm:5,xs:12,children:(0,h.jsx)(O,{data:n,loadings:B,dates:e})}),(0,h.jsx)(x.ZP,{item:!0,lg:7,sm:7,xs:12,children:(0,h.jsx)(T,{data:n})}),(0,h.jsxs)(x.ZP,{item:!0,lg:12,sm:12,xs:12,children:[(0,h.jsx)(x.ZP,{className:"pagesTitle",children:(0,h.jsxs)(g.Z,{children:["Analyse des visites m\xe9nages du ",(0,u.ou)(e.debut)," au ",(0,u.ou)(e.fin)]})}),(0,h.jsx)(D,{data:n})]})]})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})]})};const C=function(){const[e,t]=l.useState(),[n,a]=l.useState(""),[r,s]=l.useState(""),d=(0,Z.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[p,g]=l.useState(""),[S,b]=l.useState(""),[D,$]=l.useState(!1),O=(0,Z.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),M=(0,Z.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),T=(e,t)=>{var n,i;return"zone"===t?null===(n=y().filter(M,{idZone:e})[0])||void 0===n?void 0:n.denomination:null===(i=y().filter(O,{idShop:e})[0])||void 0===i?void 0:i.shop};return(0,h.jsxs)(i.Z,{sx:{padding:"5px"},elevation:3,children:[O&&O.length>0&&M&&M.length>0?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{children:(0,h.jsxs)(x.ZP,{container:!0,children:[(0,h.jsx)(x.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,h.jsx)(w.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:r,setValue:s})}),d&&"idZone"===r&&(0,h.jsx)(x.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,h.jsx)(j.Z,{value:S,setValue:b,options:d,title:"Selectionnez la region",propr:"denomination"})}),O&&"idShop"===r&&(0,h.jsx)(x.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,h.jsx)(j.Z,{value:p,setValue:g,options:O,title:"Shop",propr:"shop"})}),(0,h.jsx)(x.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,h.jsx)(f.Z,{disabled:D,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>(async()=>{try{let v={};v.key=r,v.value="idShop"===r?null===p||void 0===p?void 0:p.idShop:"idZone"===r&&(null===S||void 0===S?void 0:S.idZone);let g={};"overall"!==v.key&&(g.key=v.key,g.value=v.value);let j={dataTosearch:g};$(!0);const b=await o.Z.get(u.xK+"/followup",j,u.vc);if("token expired"===b.data)localStorage.removeItem("auth"),window.location.replace("/login");else{let r=[];for(let t=0;t<b.data.length;t++){var e,n,i,s,d,l,c,h,m,x;r.push({id:b.data[t].idDemande,CUSTOMER_VISIT:b.data[t].codeclient,REGION:T(b.data[t].codeZone,"zone"),SHOP:T(null===(e=b.data[t])||void 0===e?void 0:e.idShop,"shop"),CODE_AGENT:b.data[t].codeAgent,DATE:(f=b.data[t].createdAt,`${f.split("T")[0]}`),ETAT_PHYSIQUE:"allumer"===(null===(n=b.data[t])||void 0===n?void 0:n.statut)?"allum\xe9":"eteint",RAISON:null===(i=b.data[t])||void 0===i?void 0:i.raison,COMMUNE:null===(s=b.data[t])||void 0===s?void 0:s.commune,QUARTIER:null===(d=b.data[t])||void 0===d?void 0:d.sector,AVENUE:null===(l=b.data[t])||void 0===l?void 0:l.cell,REFERENCE:null===(c=b.data[t])||void 0===c?void 0:c.reference,SAT:null===(h=b.data[t])||void 0===h?void 0:h.sat,CONTACT:"undefined"!==(null===(m=b.data[t])||void 0===m?void 0:m.numero)?null===(x=b.data[t])||void 0===x?void 0:x.numero:"",CUSTOMER_Followup:b.data[t].follow[0].codeclient,F_Status:b.data[t].follow[0].clientStatut,F_PaymentStatut:b.data[t].follow[0].PayementStatut,F_consExpDays:b.data[t].follow[0].consExpDays})}$(!1),t(r),a("Follow up")}}catch(v){console.log(v)}var f})(),children:D?(0,h.jsx)(v.Z,{size:12}):(0,h.jsx)(m.Z,{fontSize:"small"})})}),!D&&(0,h.jsx)(x.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,h.jsx)(c.Z,{data:e,title:"",fileName:`${n}.xlsx`})})]})})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})}),(0,h.jsx)("div",{children:e&&e.length>0&&(0,h.jsx)(E._$,{rows:e,columns:[{field:"id",headerName:"ID",width:120,editable:!1},{field:"CUSTOMER_VISIT",headerName:"CUSTOMER_VISIT",width:100,editable:!1},{field:"REGION",headerName:"REGION",width:100,editable:!1},{field:"SHOP",headerName:"SHOP",width:100,editable:!1},{field:"F_consExpDays",headerName:"F_consExpDays",width:100,editable:!1},{field:"F_PaymentStatut",headerName:"F_PaymentStatut",width:100,editable:!1},{field:"F_Status",headerName:"F_Status",width:100,editable:!1},{field:"CUSTOMER_Followup",headerName:"CUSTOMER_Followup",width:140,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[10],checkboxSelection:!0,disableRowSelectionOnClick:!0})})]})};const A=function(){const[e,t]=l.useState(!1),[n,i]=l.useState(""),a=(0,Z.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),r=(0,Z.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[s,p]=l.useState(""),[m,v]=l.useState(""),[g,S]=l.useState(),b=async e=>{e.preventDefault();try{t(!0);let e={};e.key=n,e.value="idShop"===n?null===s||void 0===s?void 0:s.idShop:"codeZone"===n&&(null===m||void 0===m?void 0:m.idZone);let i={};"overall"!==e.key&&(i.key=e.key,i.value=e.value);const a=await o.Z.post(u.xK+"/conformite",{dataTosearch:i},u.vc);200===a.status&&((e=>{console.log(e);try{const n=e=>e.length>0?e[e.length-1].message:"";if(e){let i=[];for(let a=0;a<e.length;a++){var t;i.push({ID_Demande:e[a].idDemande,codeAgent:e[a].codeAgent,nom:e[a].agent.nom,shop:null===(t=e[a].shop)||void 0===t?void 0:t.shop,commune:e[a].commune,sector:e[a].sector,cell:e[a].cell,sat:e[a].sat,date:d()(e[a].createdAt).format("DD/MM/YYYY"),feedback:n(e[a].conversation)})}S(i)}}catch(n){console.log(n)}})(a.data),t(!1))}catch(i){i&&t(!1)}};return(0,h.jsxs)("div",{children:[(0,h.jsxs)(x.ZP,{container:!0,children:[(0,h.jsx)(x.ZP,{item:!0,lg:3,children:(0,h.jsx)(w.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"codeZone"},{id:3,title:"Overall",value:"overall"}],value:n,setValue:i})}),r&&"codeZone"===n&&(0,h.jsx)(x.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,h.jsx)(j.Z,{value:m,setValue:v,options:r,title:"Selectionnez la region",propr:"denomination"})}),a&&"idShop"===n&&(0,h.jsx)(x.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,h.jsx)(j.Z,{value:s,setValue:p,options:a,title:"Selectionnez le shop",propr:"shop"})}),(0,h.jsx)(x.ZP,{item:!0,lg:2,sx:{padding:"0px 10px"},children:(0,h.jsx)(f.Z,{variant:"contained",color:"primary",onClick:e=>b(e),children:"Chercher"})}),(0,h.jsx)(x.ZP,{item:!0,lg:4,sx:{padding:"0px 10px"},children:g&&g.length>0&&(0,h.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,h.jsx)(c.Z,{data:g,title:"",fileName:"Non_conforme.xlsx"})})})]}),e&&(0,h.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),g&&(0,h.jsxs)("table",{id:"theTable",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"ID demande"}),(0,h.jsx)("th",{children:"SA |TECH"}),(0,h.jsx)("th",{children:"Name"}),(0,h.jsx)("th",{children:"Commune"}),(0,h.jsx)("th",{children:"Secteur"}),(0,h.jsx)("th",{children:"Cell"}),(0,h.jsx)("th",{children:"SAT"}),(0,h.jsx)("th",{children:"Date"}),(0,h.jsx)("th",{children:"Feedback"})]})}),(0,h.jsx)("tbody",{children:g.map(((e,t)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.ID_Demande}),(0,h.jsx)("td",{children:e.codeAgent}),(0,h.jsx)("td",{children:e.nom}),(0,h.jsx)("td",{children:e.commune}),(0,h.jsx)("td",{children:e.sector}),(0,h.jsx)("td",{children:e.cell}),(0,h.jsx)("td",{children:e.sat}),(0,h.jsx)("td",{children:d()(e.createdAt).format("DD/MM/YYYY")}),(0,h.jsx)("td",{children:e.feedback})]},t)))})]})]})};const P=function(){const e=[{id:0,component:(0,h.jsx)(k,{})},{id:1,component:(0,h.jsx)(p,{})},{id:2,component:(0,h.jsx)(A,{})},{id:3,component:(0,h.jsx)(C,{})}];return(0,h.jsx)(i.Z,{children:(0,h.jsx)(a.Z,{titres:[{id:0,label:"Fichier"},{id:1,label:"Doublon"},{id:2,label:"Non_conforme"},{id:3,label:"Follow_up"}],components:e})})}},262682:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(348737),a=n(809019);const r=n.p+"static/media/excelicon.ef839df4248f225f8214.jpg";var o=n(346417);const s=function(e){let{data:t,title:n,fileName:s}=e;return(0,o.jsxs)(a.ZP,{className:"divbtonExcel",onClick:()=>{t&&(e=>{const t=i.P6.json_to_sheet(e),n=i.P6.book_new();i.P6.book_append_sheet(n,t,"Visites"),i.NC(n,s)})(t)},children:[(0,o.jsx)("img",{width:20,height:20,src:r,alt:"Excel_icon"}),(0,o.jsx)("span",{children:n})]})}},786138:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var i=n(747313),a=n(608007),r=n(329846),o=n(218765),s=n(951782),d=n(22375);var l=n(617592),c=n(319860),u=n(577342),h=n(691615),p=n(473365),m=n(683061),x=n(913392),f=n(270501),v=n(814363),g=n(601167);function j(e){return(0,g.ZP)("MuiSnackbarContent",e)}(0,v.Z)("MuiSnackbarContent",["root","message","action"]);var S=n(346417);const b=(0,l.ZP)(f.Z,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?.8:.98,i=(0,x._4)(t.palette.background.default,n);return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(i),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:i,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),y=(0,l.ZP)("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0"}),Z=(0,l.ZP)("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),w=i.forwardRef((function(e,t){const n=(0,u.Z)({props:e,name:"MuiSnackbarContent"}),{action:i,className:r,message:o,role:s="alert",...d}=n,l=n,c=(e=>{const{classes:t}=e;return(0,a.Z)({root:["root"],action:["action"],message:["message"]},j,t)})(l);return(0,S.jsxs)(b,{role:s,square:!0,elevation:6,className:(0,m.Z)(c.root,r),ownerState:l,ref:t,...d,children:[(0,S.jsx)(y,{className:c.message,ownerState:l,children:o}),i?(0,S.jsx)(Z,{className:c.action,ownerState:l,children:i}):null]})}));function D(e){return(0,g.ZP)("MuiSnackbar",e)}(0,v.Z)("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const $=(0,l.ZP)("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`anchorOrigin${(0,h.Z)(n.anchorOrigin.vertical)}${(0,h.Z)(n.anchorOrigin.horizontal)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return{zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",..."top"===n.anchorOrigin.vertical?{top:8}:{bottom:8},..."left"===n.anchorOrigin.horizontal&&{justifyContent:"flex-start"},..."right"===n.anchorOrigin.horizontal&&{justifyContent:"flex-end"},[t.breakpoints.up("sm")]:{..."top"===n.anchorOrigin.vertical?{top:24}:{bottom:24},..."center"===n.anchorOrigin.horizontal&&{left:"50%",right:"auto",transform:"translateX(-50%)"},..."left"===n.anchorOrigin.horizontal&&{left:24,right:"auto"},..."right"===n.anchorOrigin.horizontal&&{right:24,left:"auto"}}}})),E=i.forwardRef((function(e,t){const n=(0,u.Z)({props:e,name:"MuiSnackbar"}),l=(0,c.Z)(),m={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{action:x,anchorOrigin:{vertical:f,horizontal:v}={vertical:"bottom",horizontal:"left"},autoHideDuration:g=null,children:j,className:b,ClickAwayListenerProps:y,ContentProps:Z,disableWindowBlurListener:E=!1,message:O,onBlur:M,onClose:T,onFocus:k,onMouseEnter:C,onMouseLeave:A,open:P,resumeHideDuration:N,TransitionComponent:_=p.Z,transitionDuration:z=m,TransitionProps:{onEnter:R,onExited:I,...F}={},...L}=n,Y={...n,anchorOrigin:{vertical:f,horizontal:v},autoHideDuration:g,disableWindowBlurListener:E,TransitionComponent:_,transitionDuration:z},U=(e=>{const{classes:t,anchorOrigin:n}=e,i={root:["root",`anchorOrigin${(0,h.Z)(n.vertical)}${(0,h.Z)(n.horizontal)}`]};return(0,a.Z)(i,D,t)})(Y),{getRootProps:H,onClickAway:V}=function(e){const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:a,open:r,resumeHideDuration:o}=e,l=i.useRef();i.useEffect((()=>{if(r)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){e.defaultPrevented||"Escape"!==e.key&&"Esc"!==e.key||null==a||a(e,"escapeKeyDown")}}),[r,a]);const c=(0,s.Z)(((e,t)=>{null==a||a(e,t)})),u=(0,s.Z)((e=>{a&&null!=e&&(clearTimeout(l.current),l.current=setTimeout((()=>{c(null,"timeout")}),e))}));i.useEffect((()=>(r&&u(t),()=>{clearTimeout(l.current)})),[r,t,u]);const h=()=>{clearTimeout(l.current)},p=i.useCallback((()=>{null!=t&&u(null!=o?o:.5*t)}),[t,o,u]),m=e=>t=>{const n=e.onBlur;null==n||n(t),p()},x=e=>t=>{const n=e.onFocus;null==n||n(t),h()},f=e=>t=>{const n=e.onMouseEnter;null==n||n(t),h()},v=e=>t=>{const n=e.onMouseLeave;null==n||n(t),p()};return i.useEffect((()=>{if(!n&&r)return window.addEventListener("focus",p),window.addEventListener("blur",h),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",h)}}),[n,p,r]),{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n={...(0,d.Z)(e),...t};return{role:"presentation",...n,onBlur:m(n),onFocus:x(n),onMouseEnter:f(n),onMouseLeave:v(n)}},onClickAway:e=>{null==a||a(e,"clickaway")}}}({...Y}),[W,B]=i.useState(!0),G=(0,r.Z)({elementType:$,getSlotProps:H,externalForwardedProps:L,ownerState:Y,additionalProps:{ref:t},className:[U.root,b]});return!P&&W?null:(0,S.jsx)(o.Z,{onClickAway:V,...y,children:(0,S.jsx)($,{...G,children:(0,S.jsx)(_,{appear:!0,in:P,timeout:z,direction:"top"===f?"down":"up",onEnter:(e,t)=>{B(!1),R&&R(e,t)},onExited:e=>{B(!0),I&&I(e)},...F,children:j||(0,S.jsx)(w,{message:O,action:x,...Z})})})})}))},210658:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,i="millisecond",a="second",r="minute",o="hour",s="day",d="week",l="month",c="quarter",u="year",h="date",p="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},g={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),a=n%60;return(t<=0?"+":"-")+v(i,2,"0")+":"+v(a,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),a=t.clone().add(i,l),r=n-a<0,o=t.clone().add(i+(r?-1:1),l);return+(-(i+(n-a)/(r?a-o:o-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:u,w:d,d:s,D:h,h:o,m:r,s:a,ms:i,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},j="en",S={};S[j]=f;var b="$isDayjsObject",y=function(e){return e instanceof $||!(!e||!e[b])},Z=function e(t,n,i){var a;if(!t)return j;if("string"==typeof t){var r=t.toLowerCase();S[r]&&(a=r),n&&(S[r]=n,a=r);var o=t.split("-");if(!a&&o.length>1)return e(o[0])}else{var s=t.name;S[s]=t,a=s}return!i&&a&&(j=a),a||!i&&j},w=function(e,t){if(y(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new $(n)},D=g;D.l=Z,D.i=y,D.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var $=function(){function f(e){this.$L=Z(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var v=f.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(D.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(m);if(i){var a=i[2]-1||0,r=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)):new Date(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return D},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return w(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<w(e)},v.$g=function(e,t,n){return D.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,i=!!D.u(t)||t,c=D.p(e),p=function(e,t){var a=D.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?a:a.endOf(s)},m=function(e,t){return D.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},x=this.$W,f=this.$M,v=this.$D,g="set"+(this.$u?"UTC":"");switch(c){case u:return i?p(1,0):p(31,11);case l:return i?p(1,f):p(0,f+1);case d:var j=this.$locale().weekStart||0,S=(x<j?x+7:x)-j;return p(i?v-S:v+(6-S),f);case s:case h:return m(g+"Hours",0);case o:return m(g+"Minutes",1);case r:return m(g+"Seconds",2);case a:return m(g+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,d=D.p(e),c="set"+(this.$u?"UTC":""),p=(n={},n[s]=c+"Date",n[h]=c+"Date",n[l]=c+"Month",n[u]=c+"FullYear",n[o]=c+"Hours",n[r]=c+"Minutes",n[a]=c+"Seconds",n[i]=c+"Milliseconds",n)[d],m=d===s?this.$D+(t-this.$W):t;if(d===l||d===u){var x=this.clone().set(h,1);x.$d[p](m),x.init(),this.$d=x.set(h,Math.min(this.$D,x.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[D.p(e)]()},v.add=function(i,c){var h,p=this;i=Number(i);var m=D.p(c),x=function(e){var t=w(p);return D.w(t.date(t.date()+Math.round(e*i)),p)};if(m===l)return this.set(l,this.$M+i);if(m===u)return this.set(u,this.$y+i);if(m===s)return x(1);if(m===d)return x(7);var f=(h={},h[r]=t,h[o]=n,h[a]=e,h)[m]||1,v=this.$d.getTime()+i*f;return D.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var i=e||"YYYY-MM-DDTHH:mm:ssZ",a=D.z(this),r=this.$H,o=this.$m,s=this.$M,d=n.weekdays,l=n.months,c=n.meridiem,u=function(e,n,a,r){return e&&(e[n]||e(t,i))||a[n].slice(0,r)},h=function(e){return D.s(r%12||12,e,"0")},m=c||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(x,(function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return D.s(t.$y,4,"0");case"M":return s+1;case"MM":return D.s(s+1,2,"0");case"MMM":return u(n.monthsShort,s,l,3);case"MMMM":return u(l,s);case"D":return t.$D;case"DD":return D.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,d,2);case"ddd":return u(n.weekdaysShort,t.$W,d,3);case"dddd":return d[t.$W];case"H":return String(r);case"HH":return D.s(r,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return m(r,o,!0);case"A":return m(r,o,!1);case"m":return String(o);case"mm":return D.s(o,2,"0");case"s":return String(t.$s);case"ss":return D.s(t.$s,2,"0");case"SSS":return D.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(i,h,p){var m,x=this,f=D.p(h),v=w(i),g=(v.utcOffset()-this.utcOffset())*t,j=this-v,S=function(){return D.m(x,v)};switch(f){case u:m=S()/12;break;case l:m=S();break;case c:m=S()/3;break;case d:m=(j-g)/6048e5;break;case s:m=(j-g)/864e5;break;case o:m=j/n;break;case r:m=j/t;break;case a:m=j/e;break;default:m=j}return p?m:D.a(m)},v.daysInMonth=function(){return this.endOf(l).$D},v.$locale=function(){return S[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=Z(e,t,!0);return i&&(n.$L=i),n},v.clone=function(){return D.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},f}(),E=$.prototype;return w.prototype=E,[["$ms",i],["$s",a],["$m",r],["$H",o],["$W",s],["$M",l],["$y",u],["$D",h]].forEach((function(e){E[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,$,w),e.$i=!0),w},w.locale=Z,w.isDayjs=y,w.unix=function(e){return w(1e3*e)},w.en=S[j],w.Ls=S,w.p={},w}()}}]);