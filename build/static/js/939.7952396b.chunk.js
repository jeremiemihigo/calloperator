"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[939],{803105:(e,t,n)=>{n.d(t,{Z:()=>o});var d=n(81270),l=n(813292),i=n(624631),a=n(346417);const s=(0,d.D)();const o=function(e){let{value:t,setValue:n,options:d,title:o,propr:r}=e;return(0,a.jsx)(l.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>s(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:d,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+r],renderOption:(e,t)=>(0,a.jsx)("li",{...e,children:t[""+r]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,a.jsx)(i.Z,{...e,label:o||"Titre"})})}},915662:(e,t,n)=>{n.d(t,{Z:()=>a});var d=n(747313),l=n(576940),i=n(346417);const a=function(e){let{disabled:t,fonction:n,title:a,type:s}=e;const[o,r]=d.useState([]);return(0,i.jsx)(l.ZP,{type:s,disabled:t,loading:o[0],onClick:()=>{return e=0,r((t=>{const n=[...t];return n[e]=!0,n})),n(),void r((t=>{const n=[...t];return n[e]=!1,n}));var e},children:a})}},680509:(e,t,n)=>{n.d(t,{Z:()=>a});var d=n(786138),l=n(747313),i=n(346417);const a=function(e){const{message:t}=e,[n,a]=l.useState(!0);return(0,i.jsx)("div",{children:(0,i.jsx)(d.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:()=>{a(!1)},message:t},"bottom center")})}},792628:(e,t,n)=>{n.d(t,{Z:()=>h});var d=n(557829),l=n(565280),i=n(406740),a=n(747313),s=n(346417);function o(e){const{children:t,value:n,index:l,...i}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:n!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,...i,children:n===l&&(0,s.jsx)(d.Z,{sx:{p:3},children:t})})}function r(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:t,components:n}=e;const[c,h]=a.useState(0);return(0,s.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,s.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,s.jsx)(i.Z,{value:c,onChange:(e,t)=>{h(t)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:t.map(((e,t)=>(0,a.createElement)(l.Z,{label:e.label,...r(e.id),key:t})))})}),n.map(((e,t)=>(0,s.jsx)(o,{value:c,index:e.id,children:e.component},t)))]})}const h=a.memo(c)},41939:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var d=n(270501),l=n(792628),i=n(319159),a=n(835662),s=n(210658),o=n.n(s),r=n(747313),c=n(458274),h=n(661395),u=(n(699042),n(346417));const x=function(){const[e,t]=r.useState(!1),[n,d]=r.useState(),[l,s]=r.useState();r.useEffect((()=>{(async()=>{try{t(!0);const e=await a.Z.get(h.xK+"/doublon",h.vc);if(200===e.status){let n=[];for(let t=0;t<e.data.length;t++)n.push({codeclient:e.data[t].codeclient,agent1:e.data[t].agentPrecedent.codeAgent,nom1:e.data[t].agentPrecedent.nom,sat1:e.data[t].precedent.sat,date1:o()(e.data[t].precedent.createdAt).format("DD/MM/YYYY"),agent2:e.data[t].agentPresent.codeAgent,nom2:e.data[t].agentPresent.nom,sat2:e.data[t].presents.sat,shop2:e.data[t].PresentShop[0].shop,date2:o()(e.data[t].presents.createdAt).format("DD/MM/YYYY")});s(n),d(e.data),t(!1)}}catch(e){e&&t(!1)}})()}),[]);const[x,p]=r.useState({fn:e=>e});return(0,u.jsxs)("div",{children:[e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),(0,u.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,u.jsx)("div",{style:{width:"40%"},children:(0,u.jsx)(i.default,{onChange:e=>(e=>{let t=e.target.value.toUpperCase();p({fn:e=>""===t?e:e.filter((e=>e.codeclient.includes(t)||e.agentPresent.codeAgent.includes(t)))})})(e),placeholder:"Cherchez le Code client ou le deuxieme agent"})}),n&&n.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:l,title:"Doublon",fileName:"Doublon.xlsx"})})]}),n&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsxs)("thead",{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{rowSpan:"2",children:"ID"}),(0,u.jsx)("th",{colSpan:"4",style:{textAlign:"center"},children:"Premiere soumission"}),(0,u.jsx)("th",{colSpan:"4",style:{textAlign:"center"},children:"Deuxieme soumission"})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"agent"}),(0,u.jsx)("th",{children:"Nom"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"agent"}),(0,u.jsx)("th",{children:"Nom"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"})]})]}),(0,u.jsx)("tbody",{children:x.fn(n).map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.codeclient}),(0,u.jsx)("td",{children:e.agentPrecedent.codeAgent}),(0,u.jsx)("td",{children:e.agentPrecedent.nom}),(0,u.jsx)("td",{children:e.precedent.sat}),(0,u.jsx)("td",{children:o()(e.precedent.createdAt).format("DD/MM/YYYY")}),(0,u.jsx)("td",{children:e.agentPresent.codeAgent}),(0,u.jsx)("td",{children:e.agentPresent.nom}),(0,u.jsx)("td",{children:e.presents.sat}),(0,u.jsx)("td",{children:o()(e.presents.createdAt).format("DD/MM/YYYY")})]},t)))})]})]})};var p=n(435045),m=n(809019),v=n(369099),g=n(585281),j=n(261113),f=n(803105),S=n(680509),Z=n(416031),b=n.n(Z),y=n(594500),E=n(528756);const A=function(e){let{data:t}=e;const n=e=>t.filter((t=>t.demandeur.fonction===e)).length,d=(0,y.v9)((e=>e.zone.zone)),l=(e,n)=>{let d=[],l=[];return d=t.filter((t=>t.idZone===e)),l=t.filter((t=>t.idZone===e&&t.demandeur.fonction===n)),{region:d.length,agentTech:l.length}},i=(e,n)=>t.filter((t=>t.idShop===e&&t.demandeur.fonction===n)).length;return(0,u.jsx)(u.Fragment,{children:d&&d.length<1?(0,u.jsx)("p",{style:{textAlign:"center"},children:"Loading..."}):(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"R\xe9gion/Shop"}),(0,u.jsx)("td",{children:"SA"}),(0,u.jsx)("td",{children:"Tech"}),(0,u.jsx)("td",{children:"Total"})]})}),(0,u.jsxs)("tbody",{children:[d&&d.length>0&&d.map(((e,t)=>{var n;return(0,u.jsxs)(r.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:e.denomination}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:l(e.idZone,"agent").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:l(e.idZone,"tech").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:l(e.idZone).region})]}),null===(n=e.shop)||void 0===n?void 0:n.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.shop}),(0,u.jsx)("td",{children:i(e.idShop,"agent")}),(0,u.jsx)("td",{children:i(e.idShop,"tech")}),(0,u.jsx)("td",{children:i(e.idShop,"tech")+i(e.idShop,"agent")})]},t)))]},t)})),(0,u.jsxs)("tr",{className:"total",children:[(0,u.jsx)("td",{children:"Total g\xe9n\xe9ral"}),(0,u.jsx)("td",{children:n("agent")}),(0,u.jsx)("td",{children:n("tech")}),(0,u.jsx)("td",{children:n("tech")+n("agent")})]})]})]})})};var T=n(373951),P=n(614680),D=n(985038),N=n(301550),C=n(116429),k=n(183929),O=n(644758),w=n(846968),z=n(844730),I=n(915662);const Y=function(e){let{feedback:t,loading:n}=e;const[d,l]=r.useState([]),[s,o]=r.useState(),[c,x]=r.useState("");return r.useEffect((()=>{o(),l([])}),[t]),(0,u.jsxs)("div",{children:[s&&200===s.status&&(0,u.jsx)(w.Z,{direction:"vertical",style:{width:"100%",marginBottom:"10px"},children:(0,u.jsx)(z.Z,{message:`${s.data.modifiedCount} visites ont \xe9t\xe9 modifi\xe9es`,type:"success",showIcon:!0})}),(0,u.jsx)(m.ZP,{container:!0,children:t.map(((e,t)=>(0,u.jsx)(m.ZP,{item:!0,lg:6,children:(0,u.jsx)(N.Z,{component:"fieldset",variant:"standard",children:(0,u.jsx)(C.Z,{children:(0,u.jsx)(k.Z,{onClick:t=>((e,t)=>{t.preventDefault(),d.includes(e)?l(d.filter((t=>t!==e))):l([...d,e])})(e,t),control:(0,u.jsx)(O.Z,{name:e,checked:d.includes(e)}),label:e})})})},t)))}),(0,u.jsx)(j.Z,{component:"p",children:"Form"}),(0,u.jsx)(m.ZP,{container:!0,children:(0,u.jsx)(m.ZP,{item:!0,lg:12,children:(0,u.jsx)(i.default,{type:"text",placeholder:"Feedback",value:c,onChange:e=>x(e.target.value)})})}),(0,u.jsx)(m.ZP,{sx:{marginTop:"12px"},children:(0,u.jsx)(I.Z,{type:"primary",title:"Midifier",disabled:d.length<1||""===c,fonction:async()=>{const e={table:d,value:c},t=await a.Z.post(h.V6+"/ajuster",e);n(),o(t),x("")}})})]})};const M=function(e){let{data:t,loadings:n,dates:d}=e;const[l,i]=r.useState(),[a,s]=r.useState(!1),[o,c]=r.useState();return r.useEffect((()=>{(()=>{let e=[],n=b().toArray(Object.keys(b().countBy(t,"demande.raison")));c(n);for(let d=0;d<n.length;d++)e.push({title:n[d],nombre:t.filter((e=>e.demande.raison===n[d])).length,id:d});i(b().orderBy(e,"nombre","desc"))})()}),[t]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{className:"pagesTitle",children:[(0,u.jsxs)(j.Z,{component:"span",children:["Les plaintes du ",(0,h.ou)(d.debut)," au ",(0,h.ou)(d.fin)]}),(0,u.jsx)(j.Z,{component:"span",onClick:()=>s(!0),style:{marginLeft:"10px",color:"red",cursor:"pointer"},children:"Ajuster"})]}),l&&(0,u.jsx)(P._$,{rows:l,columns:[{field:"title",headerName:"Raison",width:250,editable:!1},{field:"nombre",headerName:"Nombre",width:50,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:6}}},pageSizeOptions:[6],checkboxSelection:!0,disableRowSelectionOnClick:!0}),o&&(0,u.jsx)(D.Z,{open:a,setOpen:s,title:"Ajustage",children:(0,u.jsx)(Y,{feedback:o,loading:n})})]})};var R=n(358446);const U=function(e){let{data:t}=e;const[n,d]=r.useState({options:[],series:[]});r.useEffect((()=>{(()=>{let e=[],n=[],l=b().toArray(Object.keys(b().countBy(t,"agentSave.nom")));for(let d=0;d<l.length;d++)e.push(l[d]),n.push(t.filter((e=>e.agentSave.nom===l[d])).length);d({series:n,options:e})})()}),[t]);const l={chart:{id:"basic-bar"},xaxis:{categories:n.options}},i=[{name:"series-1",data:n.series}];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsx)(j.Z,{children:"Statistiques Call operator"})}),(0,u.jsx)("div",{className:"mixed-chart",children:(0,u.jsx)(R.Z,{options:l,series:i,type:"bar",width:"100%",height:400})})]})};const V=function(){const[e,t]=r.useState({debut:"",fin:""}),[n,l]=r.useState([]),[s,o]=r.useState(),[x,Z]=r.useState(""),[P,D]=r.useState(""),N=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[C,k]=r.useState(""),[O,w]=r.useState(""),z=e=>"null"!==e&&"undefined"!==e&&e?e:"",I=e=>`${e.split("T")[0]}`,[Y,R]=r.useState(!1),V=(e,t)=>{let n=(new Date(t.createdAt).getTime()-new Date(e.updatedAt).getTime())/6e4;return n<1?1:n},F=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),L=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),$=(e,t)=>{return"zone"===t?b().filter(L,{idZone:e})[0].denomination:null===(n=b().filter(F,{idShop:e})[0])||void 0===n?void 0:n.shop;var n},_=e=>`${e.split("T")[1].split(":")[0]}:${e.split("T")[1].split(":")[1]}`,[H,B]=r.useState(),G=async()=>{try{if((0,h.uS)(e.debut,e.fin)>31)B("Les jours ne doivent pas aller au del\xe0 de 31");else if(""===P||""===e.debut||""===e.fin)B("Veuillez renseigner les champs");else{let b={};b.key=P,b.value="idShop"===P?null===C||void 0===C?void 0:C.idShop:"idZone"===P&&(null===O||void 0===O?void 0:O.idZone);let y={};"overall"!==b.key&&(y.key=b.key,y.value=b.value);let E={debut:e.debut,fin:e.fin,followUp:!1,dataTosearch:y};R(!0);const A=await a.Z.post(h.xK+"/rapport",E,h.vc);if("token expired"===A.data)localStorage.removeItem("auth"),window.location.replace("/login");else{l(A.data);let a=[];for(let e=0;e<A.data.length;e++){var t,n,d,i,s,r,c,u,x,p,m,v,g,j,f;a.push({ID:A.data[e].codeclient,NOMS:A.data[e].nomClient,"SERIAL NUMBER":z(A.data[e].codeCu),"CLIENT STATUS":A.data[e].clientStatut,"PAYMENT STATUS":A.data[e].PayementStatut,"CONS. EXP. DAYS":"normal"===A.data[e].PayementStatut?0:Math.abs(A.data[e].consExpDays),REGION:$(A.data[e].idZone,"zone"),SHOP:$(null===(t=A.data[e])||void 0===t?void 0:t.idShop,"shop"),"CODE AGENT":A.data[e].demandeur.codeAgent,"NOMS DU DEMANDEUR":A.data[e].demandeur.nom,Fonction:(S=A.data[e].demandeur.fonction,"tech"===S?"TECH":"agent"===S?"SA":["agent","tech"].includes(S)?void 0:S),"DATE DE REPONSE":I(A.data[e].dateSave),"C.O":null===(n=A.data[e].agentSave)||void 0===n?void 0:n.nom,"STATUT DE LA DEMANDE":A.data[e].demande.typeImage,"DATE D'ENVOIE":I(A.data[e].demande.updatedAt),"HEURE D'ENVOI":_(A.data[e].demande.updatedAt),"HEURE DE REPONSE":_(A.data[e].createdAt),"TEMPS MOYEN":`${V(A.data[e].demande,A.data[e]).toFixed(0)}`,LONGITUDE:z(null===(d=A.data[e].coordonnee)||void 0===d?void 0:d.longitude),LATITUDE:z(null===(i=A.data[e].coordonnee)||void 0===i?void 0:i.latitude),ALTITUDE:z(null===(s=A.data[e].coordonnee)||void 0===s?void 0:s.altitude),"ETAT PHYSIQUE":"allumer"===(null===(r=A.data[e].demande)||void 0===r?void 0:r.statut)?"allum\xe9":"eteint",RAISON:null===(c=A.data[e].demande)||void 0===c?void 0:c.raison,COMMUNE:null===(u=A.data[e].demande)||void 0===u?void 0:u.commune,QUARTIER:null===(x=A.data[e].demande)||void 0===x?void 0:x.sector,AVENUE:null===(p=A.data[e].demande)||void 0===p?void 0:p.cell,REFERENCE:null===(m=A.data[e].demande)||void 0===m?void 0:m.reference,SAT:null===(v=A.data[e].demande)||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(g=A.data[e].demande)||void 0===g?void 0:g.numero)?null===(j=A.data[e].demande)||void 0===j?void 0:j.numero:"",Adresse:null===(f=A.data[e])||void 0===f?void 0:f.adresschange})}R(!1),o(a),Z((0,T.generateNomFile)(e,"Visite menage"))}}}catch(b){console.log(b)}var S};return(0,u.jsxs)(d.Z,{sx:{padding:"5px"},elevation:3,children:[H&&(0,u.jsx)(S.Z,{message:H}),F&&F.length>0&&L&&L.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:P,setValue:D})}),N&&"idZone"===P&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(f.Z,{value:O,setValue:w,options:N,title:"Selectionnez la region",propr:"denomination"})}),F&&"idShop"===P&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(f.Z,{value:C,setValue:k,options:F,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{type:"date",onChange:n=>t({...e,debut:n.target.value}),placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{onChange:n=>t({...e,fin:n.target.value}),type:"date",placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:Y,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>G(),children:Y?(0,u.jsx)(g.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!Y&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:s,title:"",fileName:`${x}.xlsx`})})]})}),n.length>0&&(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:5,sm:5,xs:12,children:(0,u.jsx)(M,{data:n,loadings:G,dates:e})}),(0,u.jsx)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:(0,u.jsx)(U,{data:n})}),(0,u.jsxs)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsxs)(j.Z,{children:["Analyse des visites m\xe9nages du ",(0,h.ou)(e.debut)," au ",(0,h.ou)(e.fin)]})}),(0,u.jsx)(A,{data:n})]})]})]}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})]})};const F=function(){const[e,t]=r.useState(),[n,l]=r.useState(""),[i,s]=r.useState(""),o=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[x,j]=r.useState(""),[S,Z]=r.useState(""),A=e=>"null"!==e&&"undefined"!==e&&e?e:"",[T,P]=r.useState(!1),D=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),N=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),C=(e,t)=>{var n,d;return console.log(e,t),"zone"===t?null===(n=b().filter(N,{idZone:e})[0])||void 0===n?void 0:n.denomination:null===(d=b().filter(D,{idShop:e})[0])||void 0===d?void 0:d.shop};return(0,u.jsx)(d.Z,{sx:{padding:"5px"},elevation:3,children:D&&D.length>0&&N&&N.length>0?(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:i,setValue:s})}),o&&"idZone"===i&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(f.Z,{value:S,setValue:Z,options:o,title:"Selectionnez la region",propr:"denomination"})}),D&&"idShop"===i&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(f.Z,{value:x,setValue:j,options:D,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:T,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>(async()=>{try{let y={};y.key=i,y.value="idShop"===i?null===x||void 0===x?void 0:x.idShop:"idZone"===i&&(null===S||void 0===S?void 0:S.idZone);let E={};"overall"!==y.key&&(E.key=y.key,E.value=y.value);let T={dataTosearch:E};P(!0);const D=await a.Z.get(h.xK+"/followup",T,h.vc);if("token expired"===D.data)localStorage.removeItem("auth"),window.location.replace("/login");else{let i=[];for(let t=0;t<D.data.length;t++){var e,n,d,s,o,r,c,u,p,m,v,g,j,f;i.push({ID:D.data[t].typeVisit.codeclient,REGION:C(D.data[t].codeZone,"zone"),SHOP:C(null===(e=D.data[t])||void 0===e?void 0:e.idShop,"shop"),"CODE AGENT":D.data[t].codeAgent,"DATE D'ENVOIE":(b=D.data[t].createdAt,`${b.split("T")[0]}`),"HEURE D'ENVOI":(Z=D.data[t].createdAt,`${Z.split("T")[1].split(":")[0]}:${Z.split("T")[1].split(":")[1]}`),LONGITUDE:A(null===(n=D.data[t].coordonnee)||void 0===n?void 0:n.longitude),LATITUDE:A(null===(d=D.data[t].coordonnee)||void 0===d?void 0:d.latitude),ALTITUDE:A(null===(s=D.data[t].coordonnee)||void 0===s?void 0:s.altitude),"ETAT PHYSIQUE":"allumer"===(null===(o=D.data[t])||void 0===o?void 0:o.statut)?"allum\xe9":"eteint",RAISON:null===(r=D.data[t])||void 0===r?void 0:r.raison,COMMUNE:null===(c=D.data[t])||void 0===c?void 0:c.commune,QUARTIER:null===(u=D.data[t])||void 0===u?void 0:u.sector,AVENUE:null===(p=D.data[t])||void 0===p?void 0:p.cell,REFERENCE:null===(m=D.data[t])||void 0===m?void 0:m.reference,SAT:null===(v=D.data[t])||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(g=D.data[t])||void 0===g?void 0:g.numero)?null===(j=D.data[t])||void 0===j?void 0:j.numero:"",Adresse:null===(f=D.data[t])||void 0===f?void 0:f.adresschange})}P(!1),t(i),l("Follow up")}}catch(y){console.log(y)}var Z,b})(),children:T?(0,u.jsx)(g.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!T&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:e,title:"",fileName:`${n}.xlsx`})})]})})}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})})};const L=function(){const[e,t]=r.useState(!1),[n,d]=r.useState(),[l,i]=r.useState(""),s=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),x=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[p,g]=r.useState(""),[j,S]=r.useState(""),[Z,b]=r.useState();return r.useEffect((()=>{(()=>{try{const t=e=>e.length>0?e[e.length-1].message:"";if(n){let d=[];for(let l=0;l<n.length;l++){var e;d.push({ID_Demande:n[l].idDemande,codeAgent:n[l].codeAgent,nom:n[l].agent.nom,shop:null===(e=n[l].shop)||void 0===e?void 0:e.shop,commune:n[l].commune,sector:n[l].sector,cell:n[l].cell,sat:n[l].sat,date:o()(n[l].createdAt).format("DD/MM/YYYY"),feedback:t(n[l].conversation)})}b(d)}}catch(t){console.log(t)}})()}),[n]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"codeZone"},{id:3,title:"Overall",value:"overall"}],value:l,setValue:i})}),x&&"codeZone"===l&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(f.Z,{value:j,setValue:S,options:x,title:"Selectionnez la region",propr:"denomination"})}),s&&"idShop"===l&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(f.Z,{value:p,setValue:g,options:s,title:"Selectionnez le shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"0px 10px"},children:(0,u.jsx)(v.Z,{variant:"contained",color:"primary",onClick:e=>(async e=>{e.preventDefault();try{t(!0);let e={};e.key=l,e.value="idShop"===l?null===p||void 0===p?void 0:p.idShop:"codeZone"===l&&(null===j||void 0===j?void 0:j.idZone);let n={};"overall"!==e.key&&(n.key=e.key,n.value=e.value);const i=await a.Z.post(h.xK+"/conformite",{dataTosearch:n},h.vc);200===i.status&&(d(i.data),t(!1))}catch(n){n&&t(!1)}})(e),children:"Chercher"})}),(0,u.jsx)(m.ZP,{item:!0,lg:4,sx:{padding:"0px 10px"},children:Z&&Z.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:Z,title:"",fileName:"Non_conforme.xlsx"})})})]}),e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),n&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"ID demande"}),(0,u.jsx)("th",{children:"SA |TECH"}),(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"Commune"}),(0,u.jsx)("th",{children:"Secteur"}),(0,u.jsx)("th",{children:"Cell"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"Feedback"})]})}),(0,u.jsx)("tbody",{children:n.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.idDemande}),(0,u.jsx)("td",{children:e.codeAgent}),(0,u.jsx)("td",{children:e.agent.nom}),(0,u.jsx)("td",{children:e.commune}),(0,u.jsx)("td",{children:e.sector}),(0,u.jsx)("td",{children:e.cell}),(0,u.jsx)("td",{children:e.sat}),(0,u.jsx)("td",{children:o()(e.createdAt).format("DD/MM/YYYY")}),(0,u.jsx)("td",{children:e.conversation.map((e=>(0,u.jsx)("p",{className:"messageItem",children:e.message},e._id)))})]},t)))})]})]})};const $=function(){const e=[{id:0,component:(0,u.jsx)(V,{})},{id:1,component:(0,u.jsx)(x,{})},{id:2,component:(0,u.jsx)(L,{})},{id:3,component:(0,u.jsx)(F,{})}];return(0,u.jsx)(d.Z,{children:(0,u.jsx)(l.Z,{titres:[{id:0,label:"Fichier"},{id:1,label:"Doublon"},{id:2,label:"Non_conforme"},{id:3,label:"Follow_up"}],components:e})})}},458274:(e,t,n)=>{n.d(t,{Z:()=>s});var d=n(795703),l=n(369099),i=n(348737),a=n(346417);const s=function(e){let{data:t,title:n,fileName:s}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.Z,{color:"success",variant:"contained",fullWidth:!0,disabled:!t,onClick:()=>(e=>{const t=i.P6.json_to_sheet(e),n=i.P6.book_new();i.P6.book_append_sheet(n,t,"Visites"),i.NC(n,s)})(t),children:[(0,a.jsx)(d.Z,{fontSize:"small"})," ",(0,a.jsx)("span",{className:"ml-2",children:n})]})})}}}]);