"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[939],{803105:(e,t,n)=>{n.d(t,{Z:()=>o});var d=n(876767),a=n(648623),i=n(624631),l=n(346417);const s=(0,d.D)();const o=function(e){let{value:t,setValue:n,options:d,title:o,propr:r}=e;return(0,l.jsx)(a.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>s(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:d,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+r],renderOption:(e,t)=>(0,l.jsx)("li",{...e,children:t[""+r]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,l.jsx)(i.Z,{...e,label:o||"Titre"})})}},915662:(e,t,n)=>{n.d(t,{Z:()=>l});var d=n(747313),a=n(576940),i=n(346417);const l=function(e){let{disabled:t,fonction:n,title:l,type:s}=e;const[o,r]=d.useState([]);return(0,i.jsx)(a.ZP,{type:s,disabled:t,loading:o[0],onClick:()=>{return e=0,r((t=>{const n=[...t];return n[e]=!0,n})),n(),void r((t=>{const n=[...t];return n[e]=!1,n}));var e},children:l})}},680509:(e,t,n)=>{n.d(t,{Z:()=>l});var d=n(936373),a=n(747313),i=n(346417);const l=function(e){const{message:t}=e,[n,l]=a.useState(!0);return(0,i.jsx)("div",{children:(0,i.jsx)(d.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:()=>{l(!1)},message:t},"bottom center")})}},792628:(e,t,n)=>{n.d(t,{Z:()=>h});var d=n(557829),a=n(565280),i=n(406740),l=n(747313),s=n(346417);function o(e){const{children:t,value:n,index:a,...i}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:n!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...i,children:n===a&&(0,s.jsx)(d.Z,{sx:{p:3},children:t})})}function r(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:t,components:n}=e;const[c,h]=l.useState(0);return(0,s.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,s.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,s.jsx)(i.Z,{value:c,onChange:(e,t)=>{h(t)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:t.map(((e,t)=>(0,l.createElement)(a.Z,{label:e.label,...r(e.id),key:t})))})}),n.map(((e,t)=>(0,s.jsx)(o,{value:c,index:e.id,children:e.component},t)))]})}const h=l.memo(c)},41939:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var d=n(270501),a=n(792628),i=n(319159),l=n(835662),s=n(210658),o=n.n(s),r=n(747313),c=n(458274),h=n(661395),u=(n(699042),n(346417));const x=function(){const[e,t]=r.useState(!1),[n,d]=r.useState(),[a,s]=r.useState();r.useEffect((()=>{(async()=>{try{t(!0);const e=await l.Z.get(h.V6+"/doublon",h.vc);if(console.log(e.data),200===e.status){let n=[];for(let t=0;t<e.data.length;t++)n.push({codeclient:e.data[t].codeclient,agent1:e.data[t].agentPrecedent.codeAgent,nom1:e.data[t].agentPrecedent.nom,sat1:e.data[t].precedent.sat,date1:o()(e.data[t].precedent.createdAt).format("DD/MM/YYYY"),agent2:e.data[t].agentPresent.codeAgent,nom2:e.data[t].agentPresent.nom,sat2:e.data[t].presents.sat,shop2:e.data[t].PresentShop[0].shop,date2:o()(e.data[t].presents.createdAt).format("DD/MM/YYYY")});s(n),d(e.data),t(!1)}}catch(e){e&&t(!1)}})()}),[]);const[x,p]=r.useState({fn:e=>e});return(0,u.jsxs)("div",{children:[e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),(0,u.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,u.jsx)("div",{style:{width:"40%"},children:(0,u.jsx)(i.default,{onChange:e=>(e=>{let t=e.target.value.toUpperCase();p({fn:e=>""===t?e:e.filter((e=>e.codeclient.includes(t)||e.agentPresent.codeAgent.includes(t)))})})(e),placeholder:"Cherchez le Code client ou le deuxieme agent"})}),n&&n.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:a,title:"Doublon",fileName:"Doublon.xlsx"})})]}),n&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsxs)("thead",{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{rowSpan:"2",children:"ID"}),(0,u.jsx)("th",{colSpan:"4",style:{textAlign:"center"},children:"Premiere soumission"}),(0,u.jsx)("th",{colSpan:"4",style:{textAlign:"center"},children:"Deuxieme soumission"})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"agent"}),(0,u.jsx)("th",{children:"Nom"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"agent"}),(0,u.jsx)("th",{children:"Nom"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"})]})]}),(0,u.jsx)("tbody",{children:x.fn(n).map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.codeclient}),(0,u.jsx)("td",{children:e.agentPrecedent.codeAgent}),(0,u.jsx)("td",{children:e.agentPrecedent.nom}),(0,u.jsx)("td",{children:e.precedent.sat}),(0,u.jsx)("td",{children:o()(e.precedent.createdAt).format("DD/MM/YYYY")}),(0,u.jsx)("td",{children:e.agentPresent.codeAgent}),(0,u.jsx)("td",{children:e.agentPresent.nom}),(0,u.jsx)("td",{children:e.presents.sat}),(0,u.jsx)("td",{children:o()(e.presents.createdAt).format("DD/MM/YYYY")})]},t)))})]})]})};var p=n(435045),m=n(809019),v=n(369099),g=n(585281),j=n(261113),S=n(803105),f=n(680509),Z=n(416031),E=n.n(Z),b=n(594500),A=n(528756);const T=function(e){let{data:t}=e;const n=e=>t.filter((t=>t.demandeur.fonction===e)).length,d=(0,b.v9)((e=>e.zone.zone)),a=(e,n)=>{let d=[],a=[];return d=t.filter((t=>t.idZone===e)),a=t.filter((t=>t.idZone===e&&t.demandeur.fonction===n)),{region:d.length,agentTech:a.length}},i=(e,n)=>t.filter((t=>t.idShop===e&&t.demandeur.fonction===n)).length;return(0,u.jsx)(u.Fragment,{children:d&&d.length<1?(0,u.jsx)("p",{style:{textAlign:"center"},children:"Loading..."}):(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"R\xe9gion/Shop"}),(0,u.jsx)("td",{children:"SA"}),(0,u.jsx)("td",{children:"Tech"}),(0,u.jsx)("td",{children:"Total"})]})}),(0,u.jsxs)("tbody",{children:[d&&d.length>0&&d.map(((e,t)=>{var n;return(0,u.jsxs)(r.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:e.denomination}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:a(e.idZone,"agent").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:a(e.idZone,"tech").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:a(e.idZone).region})]}),null===(n=e.shop)||void 0===n?void 0:n.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.shop}),(0,u.jsx)("td",{children:i(e.idShop,"agent")}),(0,u.jsx)("td",{children:i(e.idShop,"tech")}),(0,u.jsx)("td",{children:i(e.idShop,"tech")+i(e.idShop,"agent")})]},t)))]},t)})),(0,u.jsxs)("tr",{className:"total",children:[(0,u.jsx)("td",{children:"Total g\xe9n\xe9ral"}),(0,u.jsx)("td",{children:n("agent")}),(0,u.jsx)("td",{children:n("tech")}),(0,u.jsx)("td",{children:n("tech")+n("agent")})]})]})]})})};var y=n(373951),P=n(818580),D=n(985038),N=n(301550),C=n(116429),O=n(183929),k=n(644758),w=n(846968),M=n(844730),z=n(915662);const I=function(e){let{feedback:t,loading:n}=e;const[d,a]=r.useState([]),[s,o]=r.useState(),[c,x]=r.useState("");return r.useEffect((()=>{o(),a([])}),[t]),(0,u.jsxs)("div",{children:[s&&200===s.status&&(0,u.jsx)(w.Z,{direction:"vertical",style:{width:"100%",marginBottom:"10px"},children:(0,u.jsx)(M.Z,{message:`${s.data.modifiedCount} visites ont \xe9t\xe9 modifi\xe9es`,type:"success",showIcon:!0})}),(0,u.jsx)(m.ZP,{container:!0,children:t.map(((e,t)=>(0,u.jsx)(m.ZP,{item:!0,lg:6,children:(0,u.jsx)(N.Z,{component:"fieldset",variant:"standard",children:(0,u.jsx)(C.Z,{children:(0,u.jsx)(O.Z,{onClick:t=>((e,t)=>{t.preventDefault(),d.includes(e)?a(d.filter((t=>t!==e))):a([...d,e])})(e,t),control:(0,u.jsx)(k.Z,{name:e,checked:d.includes(e)}),label:e})})})},t)))}),(0,u.jsx)(j.Z,{component:"p",children:"Form"}),(0,u.jsx)(m.ZP,{container:!0,children:(0,u.jsx)(m.ZP,{item:!0,lg:12,children:(0,u.jsx)(i.default,{type:"text",placeholder:"Feedback",value:c,onChange:e=>x(e.target.value)})})}),(0,u.jsx)(m.ZP,{sx:{marginTop:"12px"},children:(0,u.jsx)(z.Z,{type:"primary",title:"Midifier",disabled:d.length<1||""===c,fonction:async()=>{const e={table:d,value:c},t=await l.Z.post(h.V6+"/ajuster",e);n(),o(t),x("")}})})]})};const U=function(e){let{data:t,loadings:n,dates:d}=e;const[a,i]=r.useState(),[l,s]=r.useState(!1),[o,c]=r.useState();return r.useEffect((()=>{(()=>{let e=[],n=E().toArray(Object.keys(E().countBy(t,"demande.raison")));c(n);for(let d=0;d<n.length;d++)e.push({title:n[d],nombre:t.filter((e=>e.demande.raison===n[d])).length,id:d});i(E().orderBy(e,"nombre","desc"))})()}),[t]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{className:"pagesTitle",children:[(0,u.jsxs)(j.Z,{component:"span",children:["Les plaintes du ",(0,h.ou)(d.debut)," au ",(0,h.ou)(d.fin)]}),(0,u.jsx)(j.Z,{component:"span",onClick:()=>s(!0),style:{marginLeft:"10px",color:"red",cursor:"pointer"},children:"Ajuster"})]}),a&&(0,u.jsx)(P._$,{rows:a,columns:[{field:"title",headerName:"Raison",width:250,editable:!1},{field:"nombre",headerName:"Nombre",width:50,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:6}}},pageSizeOptions:[6],checkboxSelection:!0,disableRowSelectionOnClick:!0}),o&&(0,u.jsx)(D.Z,{open:l,setOpen:s,title:"Ajustage",children:(0,u.jsx)(I,{feedback:o,loading:n})})]})};var R=n(358446);const Y=function(e){let{data:t}=e;const[n,d]=r.useState({options:[],series:[]});r.useEffect((()=>{(()=>{let e=[],n=[],a=E().toArray(Object.keys(E().countBy(t,"agentSave.nom")));for(let d=0;d<a.length;d++)e.push(a[d]),n.push(t.filter((e=>e.agentSave.nom===a[d])).length);d({series:n,options:e})})()}),[t]);const a={chart:{id:"basic-bar"},xaxis:{categories:n.options}},i=[{name:"series-1",data:n.series}];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsx)(j.Z,{children:"Statistiques Call operator"})}),(0,u.jsx)("div",{className:"mixed-chart",children:(0,u.jsx)(R.Z,{options:a,series:i,type:"bar",width:"100%",height:400})})]})};const V=function(){const[e,t]=r.useState({debut:"",fin:""}),[n,a]=r.useState([]),[s,o]=r.useState(),[x,Z]=r.useState(""),[P,D]=r.useState(!1),[N,C]=r.useState(""),O=(0,b.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[k,w]=r.useState(""),[M,z]=r.useState(""),I=e=>"null"!==e&&"undefined"!==e&&e?e:"",R=e=>`${e.split("T")[0]}`,[V,F]=r.useState(!1),L=(e,t)=>{let n=(new Date(t.createdAt).getTime()-new Date(e.updatedAt).getTime())/6e4;return n<1?1:n},$=(0,b.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),_=(0,b.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),H=(e,t)=>{return"zone"===t?E().filter(_,{idZone:e})[0].denomination:null===(n=E().filter($,{idShop:e})[0])||void 0===n?void 0:n.shop;var n},B=e=>`${e.split("T")[1].split(":")[0]}:${e.split("T")[1].split(":")[1]}`,G=async()=>{try{let E={};E.key=N,E.value="idShop"===N?null===k||void 0===k?void 0:k.idShop:"idZone"===N&&(null===M||void 0===M?void 0:M.idZone);let b={};"overall"!==E.key&&(b.key=E.key,b.value=E.value);let A={debut:e.debut,fin:e.fin,followUp:!1,dataTosearch:b};F(!0);const T=await l.Z.post(h.V6+"/rapport",A,h.vc);if("token expired"===T.data)localStorage.removeItem("auth"),window.location.replace("/login");else{a(T.data);let l=[];for(let e=0;e<T.data.length;e++){var t,n,d,i,s,r,c,u,x,p,m,v,g,j,S;l.push({ID:T.data[e].codeclient,NOMS:T.data[e].nomClient,"SERIAL NUMBER":I(T.data[e].codeCu),"CLIENT STATUS":T.data[e].clientStatut,"PAYMENT STATUS":T.data[e].PayementStatut,"CONS. EXP. DAYS":"normal"===T.data[e].PayementStatut?0:Math.abs(T.data[e].consExpDays),REGION:H(T.data[e].idZone,"zone"),SHOP:H(null===(t=T.data[e])||void 0===t?void 0:t.idShop,"shop"),"CODE AGENT":T.data[e].demandeur.codeAgent,"NOMS DU DEMANDEUR":T.data[e].demandeur.nom,Fonction:(f=T.data[e].demandeur.fonction,"tech"===f?"TECH":"agent"===f?"SA":["agent","tech"].includes(f)?void 0:f),"DATE DE REPONSE":R(T.data[e].dateSave),"C.O":null===(n=T.data[e].agentSave)||void 0===n?void 0:n.nom,"STATUT DE LA DEMANDE":T.data[e].demande.typeImage,"DATE D'ENVOIE":R(T.data[e].demande.updatedAt),"HEURE D'ENVOI":B(T.data[e].demande.updatedAt),"HEURE DE REPONSE":B(T.data[e].createdAt),"TEMPS MOYEN":`${L(T.data[e].demande,T.data[e]).toFixed(0)}`,LONGITUDE:I(null===(d=T.data[e].coordonnee)||void 0===d?void 0:d.longitude),LATITUDE:I(null===(i=T.data[e].coordonnee)||void 0===i?void 0:i.latitude),ALTITUDE:I(null===(s=T.data[e].coordonnee)||void 0===s?void 0:s.altitude),"ETAT PHYSIQUE":"allumer"===(null===(r=T.data[e].demande)||void 0===r?void 0:r.statut)?"allum\xe9":"eteint",RAISON:null===(c=T.data[e].demande)||void 0===c?void 0:c.raison,COMMUNE:null===(u=T.data[e].demande)||void 0===u?void 0:u.commune,QUARTIER:null===(x=T.data[e].demande)||void 0===x?void 0:x.sector,AVENUE:null===(p=T.data[e].demande)||void 0===p?void 0:p.cell,REFERENCE:null===(m=T.data[e].demande)||void 0===m?void 0:m.reference,SAT:null===(v=T.data[e].demande)||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(g=T.data[e].demande)||void 0===g?void 0:g.numero)?null===(j=T.data[e].demande)||void 0===j?void 0:j.numero:"",Adresse:null===(S=T.data[e])||void 0===S?void 0:S.adresschange})}F(!1),o(l),Z((0,y.generateNomFile)(e,"Visite menage"))}}catch(E){console.log(E)}var f};return(0,u.jsx)(d.Z,{sx:{padding:"5px"},elevation:3,children:$&&$.length>0&&_&&_.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z,{message:"Veuillez renseigner le shop ainsi que les dates",open:P,setOpen:D}),(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(A.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:N,setValue:C})}),O&&"idZone"===N&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(S.Z,{value:M,setValue:z,options:O,title:"Selectionnez la region",propr:"denomination"})}),$&&"idShop"===N&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(S.Z,{value:k,setValue:w,options:$,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{type:"date",onChange:n=>t({...e,debut:n.target.value}),placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{onChange:n=>t({...e,fin:n.target.value}),type:"date",placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:V,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>G(),children:V?(0,u.jsx)(g.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!V&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:s,title:"",fileName:`${x}.xlsx`})})]})}),n.length>0&&(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:5,sm:5,xs:12,children:(0,u.jsx)(U,{data:n,loadings:G,dates:e})}),(0,u.jsx)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:(0,u.jsx)(Y,{data:n})}),(0,u.jsxs)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsxs)(j.Z,{children:["Analyse des visites m\xe9nages du ",(0,h.ou)(e.debut)," au ",(0,h.ou)(e.fin)]})}),(0,u.jsx)(T,{data:n})]})]})]}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})})};const F=function(){const[e,t]=r.useState({debut:"",fin:""}),[n,a]=r.useState([]),[s,o]=r.useState(),[x,j]=r.useState(""),[Z,P]=r.useState(!1),[D,N]=r.useState(""),C=(0,b.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[O,k]=r.useState(""),[w,M]=r.useState(""),z=e=>"null"!==e&&"undefined"!==e&&e?e:"",I=e=>`${e.split("T")[0]}`,[U,R]=r.useState(!1),Y=(e,t)=>{let n=(new Date(t.createdAt).getTime()-new Date(e.updatedAt).getTime())/6e4;return n<1?1:n},V=(0,b.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),F=(0,b.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),L=(e,t)=>{return"zone"===t?E().filter(F,{idZone:e})[0].denomination:null===(n=E().filter(V,{idShop:e})[0])||void 0===n?void 0:n.shop;var n},$=e=>`${e.split("T")[1].split(":")[0]}:${e.split("T")[1].split(":")[1]}`;return(0,u.jsx)(d.Z,{sx:{padding:"5px"},elevation:3,children:V&&V.length>0&&F&&F.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z,{message:"Veuillez renseigner le shop ainsi que les dates",open:Z,setOpen:P}),(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(A.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:D,setValue:N})}),C&&"idZone"===D&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(S.Z,{value:w,setValue:M,options:C,title:"Selectionnez la region",propr:"denomination"})}),V&&"idShop"===D&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(S.Z,{value:O,setValue:k,options:V,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{type:"date",onChange:n=>t({...e,debut:n.target.value}),placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(i.default,{onChange:n=>t({...e,fin:n.target.value}),type:"date",placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:U,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>(async()=>{try{let b={};b.key=D,b.value="idShop"===D?null===O||void 0===O?void 0:O.idShop:"idZone"===D&&(null===w||void 0===w?void 0:w.idZone);let A={};"overall"!==b.key&&(A.key=b.key,A.value=b.value);let T={debut:e.debut,fin:e.fin,followUp:!0,dataTosearch:A};R(!0);const P=await l.Z.post(h.V6+"/rapport",T,h.vc);if("token expired"===P.data)localStorage.removeItem("auth"),window.location.replace("/login");else{a(P.data);let l=[];for(let e=0;e<P.data.length;e++){var t,n,d,i,s,r,c,u,x,p,m,v,g,S,f,Z;l.push({ID:P.data[e].codeclient,NOMS:P.data[e].nomClient,"SERIAL NUMBER":z(P.data[e].codeCu),"CLIENT STATUS":P.data[e].clientStatut,"PAYMENT STATUS":P.data[e].PayementStatut,"CONS. EXP. DAYS":"normal"===P.data[e].PayementStatut?0:Math.abs(P.data[e].consExpDays),REGION:L(P.data[e].idZone,"zone"),SHOP:L(null===(t=P.data[e])||void 0===t?void 0:t.idShop,"shop"),"CODE AGENT":P.data[e].demandeur.codeAgent,"NOMS DU DEMANDEUR":P.data[e].demandeur.nom,Fonction:(E=P.data[e].demandeur.fonction,"tech"===E?"TECH":"agent"===E?"SA":["agent","tech"].includes(E)?void 0:E),"DATE DE REPONSE":I(P.data[e].dateSave),"C.O":null===(n=P.data[e].agentSave)||void 0===n?void 0:n.nom,"STATUT DE LA DEMANDE":P.data[e].demande.typeImage,"DATE D'ENVOIE":I(P.data[e].demande.updatedAt),"HEURE D'ENVOI":$(P.data[e].demande.updatedAt),"HEURE DE REPONSE":$(P.data[e].createdAt),"TEMPS MOYEN":`${Y(P.data[e].demande,P.data[e]).toFixed(0)}`,LONGITUDE:z(null===(d=P.data[e].coordonnee)||void 0===d?void 0:d.longitude),LATITUDE:z(null===(i=P.data[e].coordonnee)||void 0===i?void 0:i.latitude),ALTITUDE:z(null===(s=P.data[e].coordonnee)||void 0===s?void 0:s.altitude),"ETAT PHYSIQUE":"allumer"===(null===(r=P.data[e].demande)||void 0===r?void 0:r.statut)?"allum\xe9":"eteint",RAISON:null===(c=P.data[e].demande)||void 0===c?void 0:c.raison,COMMUNE:null===(u=P.data[e].demande)||void 0===u?void 0:u.commune,QUARTIER:null===(x=P.data[e].demande)||void 0===x?void 0:x.sector,AVENUE:null===(p=P.data[e].demande)||void 0===p?void 0:p.cell,REFERENCE:null===(m=P.data[e].demande)||void 0===m?void 0:m.reference,SAT:null===(v=P.data[e].demande)||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(g=P.data[e].demande)||void 0===g?void 0:g.numero)?null===(S=P.data[e].demande)||void 0===S?void 0:S.numero:"",Adresse:null===(f=P.data[e])||void 0===f?void 0:f.adresschange,time_followUP:((null===(Z=P.data[e])||void 0===Z?void 0:Z.time_followup)/60).toFixed(0)})}R(!1),o(l),j((0,y.generateNomFile)(e,"Follow_up"))}}catch(b){console.log(b)}var E})(),children:U?(0,u.jsx)(g.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!U&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:s,title:"",fileName:`${x}.xlsx`})})]})}),n.length>0&&(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:5,sm:5,xs:12}),(0,u.jsx)(m.ZP,{item:!0,lg:7,sm:7,xs:12}),(0,u.jsx)(m.ZP,{item:!0,lg:6,sm:7,xs:12,children:(0,u.jsx)(T,{data:n})})]})]}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})})};const L=function(){const[e,t]=r.useState(!1),[n,d]=r.useState(),[a,i]=r.useState(""),s=(0,b.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),x=(0,b.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[p,g]=r.useState(""),[j,f]=r.useState(""),[Z,E]=r.useState();return r.useEffect((()=>{(()=>{if(n){let t=[];for(let d=0;d<n.length;d++){var e;t.push({ID_Demande:n[d].idDemande,codeAgent:n[d].codeAgent,nom:n[d].agent.nom,shop:null===(e=n[d].shop)||void 0===e?void 0:e.shop,commune:n[d].commune,sector:n[d].sector,cell:n[d].cell,sat:n[d].sat,date:o()(n[d].createdAt).format("DD/MM/YYYY"),feedback:n[d].conversation[n[d].conversation.length-1].message})}E(t)}})()}),[n]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:3,children:(0,u.jsx)(A.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"codeZone"},{id:3,title:"Overall",value:"overall"}],value:a,setValue:i})}),Z&&Z.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:Z,title:"Non conforme",fileName:"Non_conforme.xlsx"})}),x&&"codeZone"===a&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(S.Z,{value:j,setValue:f,options:x,title:"Selectionnez la region",propr:"denomination"})}),s&&"idShop"===a&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(S.Z,{value:p,setValue:g,options:s,title:"Selectionnez le shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"0px 10px"},children:(0,u.jsx)(v.Z,{variant:"contained",color:"primary",onClick:e=>(async e=>{e.preventDefault();try{t(!0);let e={};e.key=a,e.value="idShop"===a?null===p||void 0===p?void 0:p.idShop:"codeZone"===a&&(null===j||void 0===j?void 0:j.idZone);let n={};"overall"!==e.key&&(n.key=e.key,n.value=e.value);const i=await l.Z.post(h.V6+"/conformite",{dataTosearch:n},h.vc);200===i.status&&(d(i.data),t(!1))}catch(n){n&&t(!1)}})(e),children:"Chercher"})})]}),e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),n&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"ID demande"}),(0,u.jsx)("th",{children:"SA |TECH"}),(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"Commune"}),(0,u.jsx)("th",{children:"Secteur"}),(0,u.jsx)("th",{children:"Cell"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"Feedback"})]})}),(0,u.jsx)("tbody",{children:n.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.idDemande}),(0,u.jsx)("td",{children:e.codeAgent}),(0,u.jsx)("td",{children:e.agent.nom}),(0,u.jsx)("td",{children:e.commune}),(0,u.jsx)("td",{children:e.sector}),(0,u.jsx)("td",{children:e.cell}),(0,u.jsx)("td",{children:e.sat}),(0,u.jsx)("td",{children:o()(e.createdAt).format("DD/MM/YYYY")}),(0,u.jsx)("td",{children:e.conversation.map((e=>(0,u.jsx)("p",{className:"messageItem",children:e.message},e._id)))})]},t)))})]})]})};const $=function(){const e=[{id:0,component:(0,u.jsx)(V,{})},{id:1,component:(0,u.jsx)(x,{})},{id:2,component:(0,u.jsx)(L,{})},{id:3,component:(0,u.jsx)(F,{})}];return(0,u.jsx)(d.Z,{children:(0,u.jsx)(a.Z,{titres:[{id:0,label:"Fichier"},{id:1,label:"Doublon"},{id:2,label:"Non_conforme"},{id:3,label:"Follow_up"}],components:e})})}},458274:(e,t,n)=>{n.d(t,{Z:()=>s});var d=n(795703),a=n(369099),i=n(348737),l=n(346417);const s=function(e){let{data:t,title:n,fileName:s}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(a.Z,{color:"success",variant:"contained",fullWidth:!0,disabled:!t,onClick:()=>(e=>{const t=i.P6.json_to_sheet(e),n=i.P6.book_new();i.P6.book_append_sheet(n,t,"Visites"),i.NC(n,s)})(t),children:[(0,l.jsx)(d.Z,{fontSize:"small"})," ",(0,l.jsx)("span",{className:"ml-2",children:n})]})})}}}]);