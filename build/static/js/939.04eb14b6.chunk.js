"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[939],{803105:(e,t,n)=>{n.d(t,{Z:()=>s});var d=n(81270),i=n(648623),a=n(624631),l=n(346417);const o=(0,d.D)();const s=function(e){let{value:t,setValue:n,options:d,title:s,propr:r}=e;return(0,l.jsx)(i.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>o(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:d,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+r],renderOption:(e,t)=>(0,l.jsx)("li",{...e,children:t[""+r]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,l.jsx)(a.Z,{...e,label:s||"Titre"})})}},915662:(e,t,n)=>{n.d(t,{Z:()=>l});var d=n(747313),i=n(576940),a=n(346417);const l=function(e){let{disabled:t,fonction:n,title:l,type:o}=e;const[s,r]=d.useState([]);return(0,a.jsx)(i.ZP,{type:o,disabled:t,loading:s[0],onClick:()=>{return e=0,r((t=>{const n=[...t];return n[e]=!0,n})),n(),void r((t=>{const n=[...t];return n[e]=!1,n}));var e},children:l})}},680509:(e,t,n)=>{n.d(t,{Z:()=>l});var d=n(786138),i=n(747313),a=n(346417);const l=function(e){const{message:t}=e,[n,l]=i.useState(!0);return(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:()=>{l(!1)},message:t},"bottom center")})}},792628:(e,t,n)=>{n.d(t,{Z:()=>h});var d=n(557829),i=n(565280),a=n(406740),l=n(747313),o=n(346417);function s(e){const{children:t,value:n,index:i,...a}=e;return(0,o.jsx)("div",{role:"tabpanel",hidden:n!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...a,children:n===i&&(0,o.jsx)(d.Z,{sx:{p:3},children:t})})}function r(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:t,components:n}=e;const[c,h]=l.useState(0);return(0,o.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,o.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,o.jsx)(a.Z,{value:c,onChange:(e,t)=>{h(t)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:t.map(((e,t)=>(0,l.createElement)(i.Z,{label:e.label,...r(e.id),key:t})))})}),n.map(((e,t)=>(0,o.jsx)(s,{value:c,index:e.id,children:e.component},t)))]})}const h=l.memo(c)},41939:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var d=n(270501),i=n(792628),a=n(319159),l=n(835662),o=n(210658),s=n.n(o),r=n(747313),c=n(458274),h=n(661395),u=(n(699042),n(346417));const x=function(){const[e,t]=r.useState(!1),[n,d]=r.useState();r.useEffect((()=>{(async()=>{try{t(!0);const n=await l.Z.get(h.xK+"/doublon",h.vc);if(200===n.status){let i=[];for(let t=0;t<n.data.length;t++){var e;i.push({codeclient:n.data[t].precedent.codeclient,premier_codeAgent:n.data[t].precedent.demandeur.codeAgent,premier_nomAgent:n.data[t].precedent.demandeur.nom,premier_shop:null===(e=n.data[t].PresentShop[0])||void 0===e?void 0:e.shop,premier_sat:n.data[t].precedent.demande.sat,premiere_date:s()(n.data[t].precedent.demande.updatedAt).format("DD/MM/YYYY"),deuxieme_codeAgent:n.data[t].agentPresent.codeAgent,deuxieme_nomAgent:n.data[t].agentPresent.nom,deuxieme_sat:n.data[t].presents.sat,deuxieme_date:s()(n.data[t].presents.createdAt).format("DD/MM/YYYY")})}d(i),t(!1)}}catch(n){n&&t(!1)}})()}),[]);const[i,o]=r.useState({fn:e=>e});return(0,u.jsxs)("div",{children:[e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),(0,u.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,u.jsx)("div",{style:{width:"40%"},children:(0,u.jsx)(a.default,{onChange:e=>(e=>{let t=e.target.value.toUpperCase();o({fn:e=>""===t?e:e.filter((e=>e.codeclient.includes(t)))})})(e),placeholder:"Cherchez le Code client"})}),n&&n.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:n,title:"Doublon",fileName:"Doublon.xlsx"})})]}),n&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"code client"}),(0,u.jsx)("th",{children:"codeAgent"}),(0,u.jsx)("th",{children:"nomAgent"}),(0,u.jsx)("th",{children:"shop"}),(0,u.jsx)("th",{children:"sat"}),(0,u.jsx)("th",{children:"date"}),(0,u.jsx)("th",{children:"codeAgent"}),(0,u.jsx)("th",{children:"nomAgent"}),(0,u.jsx)("th",{children:"sat"}),(0,u.jsx)("th",{children:"date"})]})}),(0,u.jsx)("tbody",{children:i.fn(n).map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.codeclient}),(0,u.jsx)("td",{children:e.premier_codeAgent}),(0,u.jsx)("td",{children:e.premier_nomAgent}),(0,u.jsx)("td",{children:e.premier_shop}),(0,u.jsx)("td",{children:e.premier_sat}),(0,u.jsx)("td",{children:e.premiere_date}),(0,u.jsx)("td",{children:e.deuxieme_codeAgent}),(0,u.jsx)("td",{children:e.deuxieme_nomAgent}),(0,u.jsx)("td",{children:e.deuxieme_sat}),(0,u.jsx)("td",{children:e.deuxieme_date})]},t)))})]})]})};var p=n(435045),m=n(809019),v=n(369099),j=n(585281),g=n(261113),f=n(803105),S=n(680509),Z=n(416031),b=n.n(Z),y=n(594500),E=n(528756);const A=function(e){let{data:t}=e;const n=e=>t.filter((t=>t.demandeur.fonction===e)).length,d=(0,y.v9)((e=>e.zone.zone)),i=(e,n)=>{let d=[],i=[];return d=t.filter((t=>t.idZone===e)),i=t.filter((t=>t.idZone===e&&t.demandeur.fonction===n)),{region:d.length,agentTech:i.length}},a=(e,n)=>t.filter((t=>t.idShop===e&&t.demandeur.fonction===n)).length;return(0,u.jsx)(u.Fragment,{children:d&&d.length<1?(0,u.jsx)("p",{style:{textAlign:"center"},children:"Loading..."}):(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"R\xe9gion/Shop"}),(0,u.jsx)("td",{children:"SA"}),(0,u.jsx)("td",{children:"Tech"}),(0,u.jsx)("td",{children:"Total"})]})}),(0,u.jsxs)("tbody",{children:[d&&d.length>0&&d.map(((e,t)=>{var n;return(0,u.jsxs)(r.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:e.denomination}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:i(e.idZone,"agent").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:i(e.idZone,"tech").agentTech}),(0,u.jsx)("td",{style:{backgroundColor:"#dedede"},children:i(e.idZone).region})]}),null===(n=e.shop)||void 0===n?void 0:n.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.shop}),(0,u.jsx)("td",{children:a(e.idShop,"agent")}),(0,u.jsx)("td",{children:a(e.idShop,"tech")}),(0,u.jsx)("td",{children:a(e.idShop,"tech")+a(e.idShop,"agent")})]},t)))]},t)})),(0,u.jsxs)("tr",{className:"total",children:[(0,u.jsx)("td",{children:"Total g\xe9n\xe9ral"}),(0,u.jsx)("td",{children:n("agent")}),(0,u.jsx)("td",{children:n("tech")}),(0,u.jsx)("td",{children:n("tech")+n("agent")})]})]})]})})};var T=n(373951),P=n(614680),C=n(985038),N=n(301550),D=n(116429),w=n(183929),O=n(644758),_=n(846968),k=n(844730),z=n(915662);const F=function(e){let{feedback:t,loading:n}=e;const[d,i]=r.useState([]),[o,s]=r.useState(),[c,x]=r.useState("");return r.useEffect((()=>{s(),i([])}),[t]),(0,u.jsxs)("div",{children:[o&&200===o.status&&(0,u.jsx)(_.Z,{direction:"vertical",style:{width:"100%",marginBottom:"10px"},children:(0,u.jsx)(k.Z,{message:`${o.data.modifiedCount} visites ont \xe9t\xe9 modifi\xe9es`,type:"success",showIcon:!0})}),(0,u.jsx)(m.ZP,{container:!0,children:t.map(((e,t)=>(0,u.jsx)(m.ZP,{item:!0,lg:6,children:(0,u.jsx)(N.Z,{component:"fieldset",variant:"standard",children:(0,u.jsx)(D.Z,{children:(0,u.jsx)(w.Z,{onClick:t=>((e,t)=>{t.preventDefault(),d.includes(e)?i(d.filter((t=>t!==e))):i([...d,e])})(e,t),control:(0,u.jsx)(O.Z,{name:e,checked:d.includes(e)}),label:e})})})},t)))}),(0,u.jsx)(g.Z,{component:"p",children:"Form"}),(0,u.jsx)(m.ZP,{container:!0,children:(0,u.jsx)(m.ZP,{item:!0,lg:12,children:(0,u.jsx)(a.default,{type:"text",placeholder:"Feedback",value:c,onChange:e=>x(e.target.value)})})}),(0,u.jsx)(m.ZP,{sx:{marginTop:"12px"},children:(0,u.jsx)(z.Z,{type:"primary",title:"Midifier",disabled:d.length<1||""===c,fonction:async()=>{const e={table:d,value:c},t=await l.Z.post(h.V6+"/ajuster",e);n(),s(t),x("")}})})]})};const I=function(e){let{data:t,loadings:n,dates:d}=e;const[i,a]=r.useState(),[l,o]=r.useState(!1),[s,c]=r.useState();return r.useEffect((()=>{(()=>{let e=[],n=b().toArray(Object.keys(b().countBy(t,"demande.raison")));c(n);for(let d=0;d<n.length;d++)e.push({title:n[d],nombre:t.filter((e=>e.demande.raison===n[d])).length,id:d});a(b().orderBy(e,"nombre","desc"))})()}),[t]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{className:"pagesTitle",children:[(0,u.jsxs)(g.Z,{component:"span",children:["Les plaintes du ",(0,h.ou)(d.debut)," au ",(0,h.ou)(d.fin)]}),(0,u.jsx)(g.Z,{component:"span",onClick:()=>o(!0),style:{marginLeft:"10px",color:"red",cursor:"pointer"},children:"Ajuster"})]}),i&&(0,u.jsx)(P._$,{rows:i,columns:[{field:"title",headerName:"Raison",width:250,editable:!1},{field:"nombre",headerName:"Nombre",width:50,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:6}}},pageSizeOptions:[6],checkboxSelection:!0,disableRowSelectionOnClick:!0}),s&&(0,u.jsx)(C.Z,{open:l,setOpen:o,title:"Ajustage",children:(0,u.jsx)(F,{feedback:s,loading:n})})]})};var R=n(358446);const M=function(e){let{data:t}=e;const[n,d]=r.useState({options:[],series:[]});r.useEffect((()=>{(()=>{let e=[],n=[],i=b().toArray(Object.keys(b().countBy(t,"agentSave.nom")));for(let d=0;d<i.length;d++)e.push(i[d]),n.push(t.filter((e=>e.agentSave.nom===i[d])).length);d({series:n,options:e})})()}),[t]);const i={chart:{id:"basic-bar"},xaxis:{categories:n.options}},a=[{name:"series-1",data:n.series}];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsx)(g.Z,{children:"Statistiques Call operator"})}),(0,u.jsx)("div",{className:"mixed-chart",children:(0,u.jsx)(R.Z,{options:i,series:a,type:"bar",width:"100%",height:400})})]})};const U=function(){const[e,t]=r.useState({debut:"",fin:""}),[n,i]=r.useState([]),[o,s]=r.useState(),[x,Z]=r.useState(""),[P,C]=r.useState(""),N=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[D,w]=r.useState(""),[O,_]=r.useState(""),k=e=>"null"!==e&&"undefined"!==e&&e?e:"",z=e=>`${e.split("T")[0]}`,[F,R]=r.useState(!1),U=(e,t)=>{let n=(new Date(t.createdAt).getTime()-new Date(e.updatedAt).getTime())/6e4;return n<1?1:n},V=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),Y=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),$=(e,t)=>{return"zone"===t?b().filter(Y,{idZone:e})[0].denomination:null===(n=b().filter(V,{idShop:e})[0])||void 0===n?void 0:n.shop;var n},L=e=>`${e.split("T")[1].split(":")[0]}:${e.split("T")[1].split(":")[1]}`,[H,B]=r.useState(),G=async()=>{try{if((0,h.uS)(e.debut,e.fin)>31)B("Les jours ne doivent pas aller au del\xe0 de 31");else if(""===P||""===e.debut||""===e.fin)B("Veuillez renseigner les champs");else{let b={};b.key=P,b.value="idShop"===P?null===D||void 0===D?void 0:D.idShop:"idZone"===P&&(null===O||void 0===O?void 0:O.idZone);let y={};"overall"!==b.key&&(y.key=b.key,y.value=b.value);let E={debut:e.debut,fin:e.fin,followUp:!1,dataTosearch:y};R(!0);const A=await l.Z.post(h.xK+"/rapport",E,h.vc);if("token expired"===A.data)localStorage.removeItem("auth"),window.location.replace("/login");else{i(A.data);let l=[];for(let e=0;e<A.data.length;e++){var t,n,d,a,o,r,c,u,x,p,m,v,j,g,f;l.push({ID:A.data[e].codeclient,NOMS:A.data[e].nomClient,"SERIAL NUMBER":k(A.data[e].codeCu),"CLIENT STATUS":A.data[e].clientStatut,"PAYMENT STATUS":A.data[e].PayementStatut,"CONS. EXP. DAYS":"normal"===A.data[e].PayementStatut?0:Math.abs(A.data[e].consExpDays),REGION:$(A.data[e].idZone,"zone"),SHOP:$(null===(t=A.data[e])||void 0===t?void 0:t.idShop,"shop"),"CODE AGENT":A.data[e].demandeur.codeAgent,"NOMS DU DEMANDEUR":A.data[e].demandeur.nom,Fonction:(S=A.data[e].demandeur.fonction,"tech"===S?"TECH":"agent"===S?"SA":["agent","tech"].includes(S)?void 0:S),"DATE DE REPONSE":z(A.data[e].dateSave),"C.O":null===(n=A.data[e].agentSave)||void 0===n?void 0:n.nom,"STATUT DE LA DEMANDE":A.data[e].demande.typeImage,"DATE D'ENVOIE":z(A.data[e].demande.updatedAt),"HEURE D'ENVOI":L(A.data[e].demande.updatedAt),"HEURE DE REPONSE":L(A.data[e].createdAt),"TEMPS MOYEN":`${U(A.data[e].demande,A.data[e]).toFixed(0)}`,LONGITUDE:k(null===(d=A.data[e].coordonnee)||void 0===d?void 0:d.longitude),LATITUDE:k(null===(a=A.data[e].coordonnee)||void 0===a?void 0:a.latitude),ALTITUDE:k(null===(o=A.data[e].coordonnee)||void 0===o?void 0:o.altitude),"ETAT PHYSIQUE":"allumer"===(null===(r=A.data[e].demande)||void 0===r?void 0:r.statut)?"allum\xe9":"eteint",RAISON:null===(c=A.data[e].demande)||void 0===c?void 0:c.raison,COMMUNE:null===(u=A.data[e].demande)||void 0===u?void 0:u.commune,QUARTIER:null===(x=A.data[e].demande)||void 0===x?void 0:x.sector,AVENUE:null===(p=A.data[e].demande)||void 0===p?void 0:p.cell,REFERENCE:null===(m=A.data[e].demande)||void 0===m?void 0:m.reference,SAT:null===(v=A.data[e].demande)||void 0===v?void 0:v.sat,CONTACT:"undefined"!==(null===(j=A.data[e].demande)||void 0===j?void 0:j.numero)?null===(g=A.data[e].demande)||void 0===g?void 0:g.numero:"",Adresse:null===(f=A.data[e])||void 0===f?void 0:f.adresschange})}R(!1),s(l),Z((0,T.generateNomFile)(e,"Visite menage"))}}}catch(b){console.log(b)}var S};return(0,u.jsxs)(d.Z,{sx:{padding:"5px"},elevation:3,children:[H&&(0,u.jsx)(S.Z,{message:H}),V&&V.length>0&&Y&&Y.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:P,setValue:C})}),N&&"idZone"===P&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(f.Z,{value:O,setValue:_,options:N,title:"Selectionnez la region",propr:"denomination"})}),V&&"idShop"===P&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(f.Z,{value:D,setValue:w,options:V,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(a.default,{type:"date",onChange:n=>t({...e,debut:n.target.value}),placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:4,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(a.default,{onChange:n=>t({...e,fin:n.target.value}),type:"date",placeholder:"Date"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:F,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>G(),children:F?(0,u.jsx)(j.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!F&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:o,title:"",fileName:`${x}.xlsx`})})]})}),n.length>0&&(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:5,sm:5,xs:12,children:(0,u.jsx)(I,{data:n,loadings:G,dates:e})}),(0,u.jsx)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:(0,u.jsx)(M,{data:n})}),(0,u.jsxs)(m.ZP,{item:!0,lg:7,sm:7,xs:12,children:[(0,u.jsx)(m.ZP,{className:"pagesTitle",children:(0,u.jsxs)(g.Z,{children:["Analyse des visites m\xe9nages du ",(0,h.ou)(e.debut)," au ",(0,h.ou)(e.fin)]})}),(0,u.jsx)(A,{data:n})]})]})]}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})})]})};const V=function(){const[e,t]=r.useState(),[n,i]=r.useState(""),[a,o]=r.useState(""),s=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[x,g]=r.useState(""),[S,Z]=r.useState(""),[A,T]=r.useState(!1),C=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),N=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),D=(e,t)=>{var n,d;return"zone"===t?null===(n=b().filter(N,{idZone:e})[0])||void 0===n?void 0:n.denomination:null===(d=b().filter(C,{idShop:e})[0])||void 0===d?void 0:d.shop};return(0,u.jsxs)(d.Z,{sx:{padding:"5px"},elevation:3,children:[C&&C.length>0&&N&&N.length>0?(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{children:(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:12,md:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"idZone"},{id:3,title:"Overall",value:"overall"}],value:a,setValue:o})}),s&&"idZone"===a&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"5px"},sm:3,xs:8,md:3,children:(0,u.jsx)(f.Z,{value:S,setValue:Z,options:s,title:"Selectionnez la region",propr:"denomination"})}),C&&"idShop"===a&&(0,u.jsx)(m.ZP,{item:!0,lg:2,sm:3,xs:8,md:3,sx:{padding:"5px"},children:(0,u.jsx)(f.Z,{value:x,setValue:g,options:C,title:"Shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,xs:6,md:3,sx:{padding:"5px"},children:(0,u.jsx)(v.Z,{disabled:A,fullWidth:!0,color:"primary",variant:"contained",onClick:()=>(async()=>{try{let j={};j.key=a,j.value="idShop"===a?null===x||void 0===x?void 0:x.idShop:"idZone"===a&&(null===S||void 0===S?void 0:S.idZone);let g={};"overall"!==j.key&&(g.key=j.key,g.value=j.value);let f={dataTosearch:g};T(!0);const Z=await l.Z.get(h.xK+"/followup",f,h.vc);if("token expired"===Z.data)localStorage.removeItem("auth"),window.location.replace("/login");else{let a=[];for(let t=0;t<Z.data.length;t++){var e,n,d,o,s,r,c,u,p,m;a.push({id:Z.data[t].idDemande,CUSTOMER_VISIT:Z.data[t].codeclient,REGION:D(Z.data[t].codeZone,"zone"),SHOP:D(null===(e=Z.data[t])||void 0===e?void 0:e.idShop,"shop"),CODE_AGENT:Z.data[t].codeAgent,DATE:(v=Z.data[t].createdAt,`${v.split("T")[0]}`),ETAT_PHYSIQUE:"allumer"===(null===(n=Z.data[t])||void 0===n?void 0:n.statut)?"allum\xe9":"eteint",RAISON:null===(d=Z.data[t])||void 0===d?void 0:d.raison,COMMUNE:null===(o=Z.data[t])||void 0===o?void 0:o.commune,QUARTIER:null===(s=Z.data[t])||void 0===s?void 0:s.sector,AVENUE:null===(r=Z.data[t])||void 0===r?void 0:r.cell,REFERENCE:null===(c=Z.data[t])||void 0===c?void 0:c.reference,SAT:null===(u=Z.data[t])||void 0===u?void 0:u.sat,CONTACT:"undefined"!==(null===(p=Z.data[t])||void 0===p?void 0:p.numero)?null===(m=Z.data[t])||void 0===m?void 0:m.numero:"",CUSTOMER_Followup:Z.data[t].follow[0].codeclient,F_Status:Z.data[t].follow[0].clientStatut,F_PaymentStatut:Z.data[t].follow[0].PayementStatut,F_consExpDays:Z.data[t].follow[0].consExpDays})}T(!1),t(a),i("Follow up")}}catch(j){console.log(j)}var v})(),children:A?(0,u.jsx)(j.Z,{size:12}):(0,u.jsx)(p.Z,{fontSize:"small"})})}),!A&&(0,u.jsx)(m.ZP,{item:!0,lg:1,sm:2,md:3,xs:6,sx:{padding:"5px"},children:(0,u.jsx)(c.Z,{data:e,title:"",fileName:`${n}.xlsx`})})]})})}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("p",{style:{textAlign:"center"},children:"Patientez le Chargement des shops et regions...."})}),(0,u.jsx)("div",{children:e&&e.length>0&&(0,u.jsx)(P._$,{rows:e,columns:[{field:"id",headerName:"ID",width:120,editable:!1},{field:"CUSTOMER_VISIT",headerName:"CUSTOMER_VISIT",width:100,editable:!1},{field:"REGION",headerName:"REGION",width:100,editable:!1},{field:"SHOP",headerName:"SHOP",width:100,editable:!1},{field:"F_consExpDays",headerName:"F_consExpDays",width:100,editable:!1},{field:"F_PaymentStatut",headerName:"F_PaymentStatut",width:100,editable:!1},{field:"F_Status",headerName:"F_Status",width:100,editable:!1},{field:"CUSTOMER_Followup",headerName:"CUSTOMER_Followup",width:140,editable:!1}],initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[10],checkboxSelection:!0,disableRowSelectionOnClick:!0})})]})};const Y=function(){const[e,t]=r.useState(!1),[n,d]=r.useState(""),i=(0,y.v9)((e=>{var t;return null===(t=e.shop)||void 0===t?void 0:t.shop})),a=(0,y.v9)((e=>{var t;return null===(t=e.zone)||void 0===t?void 0:t.zone})),[o,x]=r.useState(""),[p,j]=r.useState(""),[g,S]=r.useState(),Z=async e=>{e.preventDefault();try{t(!0);let e={};e.key=n,e.value="idShop"===n?null===o||void 0===o?void 0:o.idShop:"codeZone"===n&&(null===p||void 0===p?void 0:p.idZone);let d={};"overall"!==e.key&&(d.key=e.key,d.value=e.value);const i=await l.Z.post(h.xK+"/conformite",{dataTosearch:d},h.vc);200===i.status&&((e=>{console.log(e);try{const n=e=>e.length>0?e[e.length-1].message:"";if(e){let d=[];for(let i=0;i<e.length;i++){var t;d.push({ID_Demande:e[i].idDemande,codeAgent:e[i].codeAgent,nom:e[i].agent.nom,shop:null===(t=e[i].shop)||void 0===t?void 0:t.shop,commune:e[i].commune,sector:e[i].sector,cell:e[i].cell,sat:e[i].sat,date:s()(e[i].createdAt).format("DD/MM/YYYY"),feedback:n(e[i].conversation)})}S(d)}}catch(n){console.log(n)}})(i.data),t(!1))}catch(d){d&&t(!1)}};return(0,u.jsxs)("div",{children:[(0,u.jsxs)(m.ZP,{container:!0,children:[(0,u.jsx)(m.ZP,{item:!0,lg:3,children:(0,u.jsx)(E.Z,{label:"Filtrer par",data:[{id:1,title:"Shop",value:"idShop"},{id:2,title:"Region",value:"codeZone"},{id:3,title:"Overall",value:"overall"}],value:n,setValue:d})}),a&&"codeZone"===n&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(f.Z,{value:p,setValue:j,options:a,title:"Selectionnez la region",propr:"denomination"})}),i&&"idShop"===n&&(0,u.jsx)(m.ZP,{item:!0,lg:3,sx:{padding:"0px 10px"},children:(0,u.jsx)(f.Z,{value:o,setValue:x,options:i,title:"Selectionnez le shop",propr:"shop"})}),(0,u.jsx)(m.ZP,{item:!0,lg:2,sx:{padding:"0px 10px"},children:(0,u.jsx)(v.Z,{variant:"contained",color:"primary",onClick:e=>Z(e),children:"Chercher"})}),(0,u.jsx)(m.ZP,{item:!0,lg:4,sx:{padding:"0px 10px"},children:g&&g.length>0&&(0,u.jsx)("div",{style:{width:"40%",marginLeft:"10px"},children:(0,u.jsx)(c.Z,{data:g,title:"",fileName:"Non_conforme.xlsx"})})})]}),e&&(0,u.jsx)("p",{style:{textAlign:"center",fontSize:"13px",color:"blue",fontWeight:"bolder"},children:"Please wait..."}),g&&(0,u.jsxs)("table",{id:"theTable",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"ID demande"}),(0,u.jsx)("th",{children:"SA |TECH"}),(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"Commune"}),(0,u.jsx)("th",{children:"Secteur"}),(0,u.jsx)("th",{children:"Cell"}),(0,u.jsx)("th",{children:"SAT"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"Feedback"})]})}),(0,u.jsx)("tbody",{children:g.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.ID_Demande}),(0,u.jsx)("td",{children:e.codeAgent}),(0,u.jsx)("td",{children:e.nom}),(0,u.jsx)("td",{children:e.commune}),(0,u.jsx)("td",{children:e.sector}),(0,u.jsx)("td",{children:e.cell}),(0,u.jsx)("td",{children:e.sat}),(0,u.jsx)("td",{children:s()(e.createdAt).format("DD/MM/YYYY")}),(0,u.jsx)("td",{children:e.feedback})]},t)))})]})]})};const $=function(){const e=[{id:0,component:(0,u.jsx)(U,{})},{id:1,component:(0,u.jsx)(x,{})},{id:2,component:(0,u.jsx)(Y,{})},{id:3,component:(0,u.jsx)(V,{})}];return(0,u.jsx)(d.Z,{children:(0,u.jsx)(i.Z,{titres:[{id:0,label:"Fichier"},{id:1,label:"Doublon"},{id:2,label:"Non_conforme"},{id:3,label:"Follow_up"}],components:e})})}},458274:(e,t,n)=>{n.d(t,{Z:()=>o});var d=n(795703),i=n(369099),a=n(348737),l=n(346417);const o=function(e){let{data:t,title:n,fileName:o}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(i.Z,{color:"success",variant:"contained",fullWidth:!0,disabled:!t,onClick:()=>(e=>{const t=a.P6.json_to_sheet(e),n=a.P6.book_new();a.P6.book_append_sheet(n,t,"Visites"),a.NC(n,o)})(t),children:[(0,l.jsx)(d.Z,{fontSize:"small"})," ",(0,l.jsx)("span",{className:"ml-2",children:n})]})})}}}]);