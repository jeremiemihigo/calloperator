"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[262],{803105:(e,n,t)=>{t.d(n,{Z:()=>d});var i=t(876767),s=t(648623),o=t(624631),l=t(346417);const a=(0,i.D)();const d=function(e){let{value:n,setValue:t,options:i,title:d,propr:r}=e;return(0,l.jsx)(s.Z,{value:n,onChange:(e,n)=>{"string"===typeof n?t({title:n}):n&&n.inputValue?t({title:n.inputValue}):t(n)},filterOptions:(e,n)=>a(e,n),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:i,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+r],renderOption:(e,n)=>(0,l.jsx)("li",{...e,children:n[""+r]},n.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,l.jsx)(o.Z,{...e,label:d||"Titre"})})}},680509:(e,n,t)=>{t.d(n,{Z:()=>l});var i=t(936373),s=t(747313),o=t(346417);const l=function(e){const{message:n}=e,[t,l]=s.useState(!0);return(0,o.jsx)("div",{children:(0,o.jsx)(i.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,onClose:()=>{l(!1)},message:n},"bottom center")})}},792628:(e,n,t)=>{t.d(n,{Z:()=>p});var i=t(557829),s=t(565280),o=t(406740),l=t(747313),a=t(346417);function d(e){const{children:n,value:t,index:s,...o}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:t!==s,id:`simple-tabpanel-${s}`,"aria-labelledby":`simple-tab-${s}`,...o,children:t===s&&(0,a.jsx)(i.Z,{sx:{p:3},children:n})})}function r(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c(e){let{titres:n,components:t}=e;const[c,p]=l.useState(0);return(0,a.jsxs)(i.Z,{sx:{width:"100%"},children:[(0,a.jsx)(i.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsx)(o.Z,{value:c,onChange:(e,n)=>{p(n)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:n.map(((e,n)=>(0,l.createElement)(s.Z,{label:e.label,...r(e.id),key:n})))})}),t.map(((e,n)=>(0,a.jsx)(d,{value:c,index:e.id,children:e.component},n)))]})}const p=l.memo(c)},571659:(e,n,t)=>{t.d(n,{Z:()=>l});t(747313);var i=t(70816),s=t.n(i),o=(t(208890),t(346417));const l=function(e){let{demandes:n}=e;return(0,o.jsx)("div",{className:"chats",children:n&&n.length>0&&n.map((e=>(0,o.jsxs)("div",{className:"co"===e.sender?"co":"agent",children:[(0,o.jsx)("p",{children:e.message}),(0,o.jsxs)("p",{style:{fontSize:"11px"},children:[(0,o.jsx)("span",{style:{textAlign:"center"},children:e.codeAgent}),(0,o.jsx)("span",{style:{float:"right"},children:s()(e.createdAt).fromNow()})]})]},e._id)))})}},108262:(e,n,t)=>{t.d(n,{Z:()=>F});var i=t(747313),s=t(661395),o=t(261113),l=t(809019),a=t(873428),d=t(792628),r=t(435593),c=t(396180),p=t(846968),u=t(471562),m=t(70816),x=t.n(m),h=t(286961),v=t(571659),g=t(319159),f=t(835662),j=t(594500),y=t(346417);const{TextArea:C}=g.default;const Z=function(e){let{demande:n,update:t}=e;const[o,l]=(0,i.useState)(""),a=(0,j.v9)((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.user}));return(0,y.jsx)("div",{className:"container",children:(0,y.jsx)("div",{className:"row",children:(0,y.jsx)(C,{required:!0,value:o,onKeyUp:e=>(async e=>{if(t&&13===e.keyCode&&""!==o){l("");const e={message:o,_id:t._id,idDemande:t.idDemande,sender:"co",codeAgent:null===a||void 0===a?void 0:a.codeAgent};if(200===(await f.Z.post(s.V6+"/reclamation",e)).status)return}if(n&&13===e.keyCode&&""!==o){const e={_id:n._id,message:o,sender:"co",idDemande:n.idDemande,codeAgent:null===a||void 0===a?void 0:a.codeAgent};l("");const t=await f.Z.post(s.V6+"/reclamation",e);if(console.log(t),200===t.status)return}})(e),onChange:e=>{e.preventDefault(),l(e.target.value)},placeholder:"Messages",autoSize:{minRows:3,maxRows:5}})})})};var S=t(371207),b=t(808425),D=t(157983),A=t(624631),w=t(557829),E=t(301550),P=t(116429),z=t(183929),k=t(644758),N=t(369099),V=t(585281),T=t(803105),$=t(680509),W=t(65387),B=t(528756),R=t(799881),U=t(91554);const I=function(e){let{update:n}=e;const t=(0,j.v9)((e=>e.zone.zone)),o=(0,j.I0)(),[a,d]=i.useState(""),[c,p]=i.useState(""),[u,m]=i.useState(!1),[x,h]=i.useState({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),v=e=>{const{name:n,value:t}=e.target;h({...x,[n]:t})},{demande:g}=(0,i.useContext)(r.E),{codeCu:C,codeClient:Z,consExpDays:_,nomClient:I}=x;let[O,F]=i.useState({payement:"",statut:""});const{payement:q,statut:L}=O,[K,M]=i.useState(""),[H,J]=i.useState(!1),[G,Q]=i.useState("");function X(){h({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),F({payement:"",statut:""}),d(""),p(""),Q("")}const Y=(0,j.v9)((e=>e.reponse)),[ee,ne]=i.useState(""),te=e=>{ne(""),h({...x,consExpDays:e});let n="",t="";return e>=0&&(n="installed",t="normal"),e>=-30&&e<=-1&&(n="installed",t="expired"),e>=-44&&e<=-31&&(n="installed",t="defaulted"),e<=-45&&(n="pending repossession",t="defaulted"),isNaN(e)&&(n="",t=""),F({payement:t,statut:n}),{payement:t,statut:n}},ie=(0,j.v9)((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.user})),se=async()=>{var e;if(12===Z.trim().length&&Z.toUpperCase().trim().startsWith("BDRC"))if(a&&c&&a.idZone!==c.idZone)M("Veuillez v\xe9rifier si le shop est enregistr\xe9 dans la region selection\xe9e"),J(!0);else if(g&&!["PO","ZBM"].includes(g.agent.fonction)&&(null===(e=g.shopAgent[0])||void 0===e?void 0:e.idShop)!==c.idShop){var n;M(`y a pas une conformit\xe9 entre le shop du client << ${null===c||void 0===c?void 0:c.shop} >> et celui de l'agent << ${null===g||void 0===g||null===(n=g.shopAgent[0])||void 0===n?void 0:n.shop} >>`),J(!0)}else{const e={idDemande:g.idDemande,codeClient:Z.toUpperCase().trim(),codeCu:C.trim(),codeAgent:null===ie||void 0===ie?void 0:ie.codeAgent,clientStatut:L,PayementStatut:q,adresschange:G,consExpDays:_.trim(),nomClient:I,idZone:a.idZone,idShop:c.idShop,fonctionAgent:g.agent.fonction,codeAgentDemandeur:g.agent.codeAgent,_idDemande:g._id,nomAgentSave:null===ie||void 0===ie?void 0:ie.nom,createdAt:null===g||void 0===g?void 0:g.createdAt};o((0,W.Z1)(e))}else M("Le code client n'est pas conforme"),J(!0)};i.useEffect((()=>{"success"===Y.postDemande&&X()}),[Y]),i.useEffect((()=>{if(n){let e={consExpDays:n.consExpDays,codeClient:n.codeclient,codeCu:n.codeCu};te(n.consExpDays),h({...x,...e})}}),[n]);const oe=(e,n)=>{n.preventDefault(),ne(e),F("inactive"===e?{payement:"terminated",statut:"inactive"}:{payement:"pending fulfliment",statut:"pending activation"})},le=async()=>{let e=12===Z.trim().length?Z.toUpperCase().trim():8===Z.length?"BDRC"+Z.trim():"";if(""!==e){m(!0);const n=await f.Z.get(`${s.V6}/customer/${e}`);if(200===n.status){h({...x,codeCu:n.data.customer_cu,nomClient:n.data.nomClient,consExpDays:"",codeClient:e});let i=t.filter((e=>e._id===n.data.region._id));p(n.data.shop),d(i[0]),m(!1)}else m(!1),h({...x,codeCu:"",nomClient:"",consExpDays:""}),d(""),p("")}},ae=(0,j.v9)((e=>e.reponse));return(0,y.jsxs)(l.ZP,{children:["rejected"===ae.postDemande&&(0,y.jsx)(R.Z,{variant:"filled",severity:"error",children:ae.postDemandeError}),"pending"===ae.postDemande&&(0,y.jsx)(U.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,y.jsx)("div",{children:(0,y.jsx)("p",{style:{textAlign:"center",margin:"0px",padding:"0px"},children:"Please wait..."})})}),H&&(0,y.jsx)($.Z,{message:K,open:H,setOpen:J}),(0,y.jsxs)(l.ZP,{container:!0,children:[(0,y.jsx)(l.ZP,{item:!0,lg:10,xs:10,children:(0,y.jsx)(A.Z,{style:{marginTop:"10px"},onChange:e=>v(e),name:"codeClient",onKeyUp:e=>(e=>{13===e.keyCode&&le()})(e),autoComplete:"off",fullWidth:!0,value:Z,label:"Code du Client"})}),(0,y.jsx)(l.ZP,{item:!0,lg:2,xs:2,sx:{display:"flex",cursor:"pointer",alignItems:"center",justifyContent:"center"},children:u?(0,y.jsx)(V.Z,{size:15}):(0,y.jsx)(D.default,{onClick:e=>le(),fontSize:"small"})})]}),(0,y.jsx)(A.Z,{style:{marginTop:"10px"},onChange:e=>v(e),name:"nomClient",autoComplete:"off",fullWidth:!0,value:I,label:"Nom du Client"}),(0,y.jsx)(A.Z,{style:{marginTop:"10px"},onChange:e=>v(e),value:C,name:"codeCu",autoComplete:"off",fullWidth:!0,label:"Code CU"}),(0,y.jsxs)(l.ZP,{container:!0,children:[(0,y.jsx)(l.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px"},children:(0,y.jsx)(T.Z,{value:a,setValue:d,options:t,title:t&&t.length<1?"Loading...":"Regions",propr:"denomination"})}),(0,y.jsx)(l.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px"},children:a&&""!==a&&null!==a&&(0,y.jsx)(T.Z,{value:c,setValue:p,options:a&&a.shop,title:"Shop",propr:"shop"})})]}),(0,y.jsx)("div",{style:{margin:"10px 0px"},children:(0,y.jsx)(B.Z,{label:"Adresse",data:[{id:1,title:"Identifique \xe0 pulse",value:"Identique"},{id:2,title:"N'est pas identifique \xe0 pulse",value:"N'est pas identique"}],value:G,setValue:Q})}),(0,y.jsx)("div",{className:"expiredDate",children:(0,y.jsx)(A.Z,{onChange:e=>te(e.target.value),style:{marginTop:"10px"},name:"consExpDays",autoComplete:"off",fullWidth:!0,onKeyUp:n?()=>{}:e=>(e=>{13===e.keyCode&&se()})(e),value:_,label:"consExpDays"})}),(0,y.jsxs)(w.Z,{sx:{display:"flex"},children:[(0,y.jsx)(E.Z,{component:"fieldset",variant:"standard",children:(0,y.jsx)(P.Z,{children:(0,y.jsx)(z.Z,{onClick:e=>oe("inactive",e),control:(0,y.jsx)(k.Z,{name:"inactive",checked:"inactive"===ee}),label:"Inactive"})})}),(0,y.jsx)(E.Z,{component:"fieldset",variant:"standard",children:(0,y.jsx)(P.Z,{children:(0,y.jsx)(z.Z,{onClick:e=>oe("pending",e),control:(0,y.jsx)(k.Z,{name:"pending",checked:"pending"===ee}),label:"Pending activation"})})})]}),(0,y.jsx)(A.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),F({...O,statut:e.target.value})},name:"statut",autoComplete:"off",fullWidth:!0,value:L,label:"Statut du client"}),(0,y.jsx)(A.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),F({...O,payement:e.target.value})},name:"payement",autoComplete:"off",fullWidth:!0,value:q,label:"Statut Payement"}),(0,y.jsx)("div",{style:{marginTop:"10px"},children:(0,y.jsxs)(N.Z,{disabled:!g&&!n,fullWidth:!0,variant:"contained",color:"primary",onClick:n?()=>(async()=>{J(!1),f.Z.put(s.V6+"/reponse",{idReponse:n._id,data:{codeclient:Z,nomClient:I,codeCu:C,clientStatut:L,PayementStatut:q,consExpDays:_,idZone:a.idZone,idShop:c.idShop}},s.vc).then((e=>{M(e.data),X(),J(!0)})).catch((e=>{console.log(e)}))})():e=>{e.preventDefault(),se()},children:[n?(0,y.jsx)(S.Z,{fontSize:"small"}):(0,y.jsx)(b.Z,{fontSize:"small"})," ",(0,y.jsxs)("span",{style:{marginLeft:"10px"},children:[" ",n?"Update":"Save"]})]})})]})};t(421331);function O(e){const{update:n}=e,{demande:t,reponseNow:m}=(0,i.useContext)(r.E),g=[{id:0,component:(0,y.jsx)(I,{update:n})},{id:1,component:(0,y.jsx)(Z,{demande:t,update:n})}],[f,j]=c.ZP.useMessage();function C(e){let{demandes:n}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"demandeJsx",style:{textAlign:"justify"},children:["undefined"!==n.codeclient&&(0,y.jsxs)(o.Z,{component:"p",className:"codeClient",onClick:()=>{return e=n.codeclient,navigator.clipboard.writeText(e),void f.open({type:"success",content:"Done "+e,duration:2});var e},style:{color:(t=n.codeclient,!t&&"red"),fontSize:"15px",fontWeight:"bolder"},children:["code client : ",n.codeclient&&n.codeclient.toUpperCase()]}),"undefined"!==n.numero&&(0,y.jsxs)("p",{children:["Num\xe9ro joignable du client: ",n.numero]}),(0,y.jsxs)("p",{children:["Statut du client : ",""+("allumer"===n.statut?"allum\xe9":"\xe9teint")," "]}),(0,y.jsxs)("p",{children:["Sector : ",null===n||void 0===n?void 0:n.sector," "]}),(0,y.jsxs)("p",{children:["Cell : ",null===n||void 0===n?void 0:n.cell," "]}),(0,y.jsxs)("p",{children:["Sat : ",null===n||void 0===n?void 0:n.sat," "]}),(0,y.jsxs)("p",{children:["Reference : ",null===n||void 0===n?void 0:n.reference," "]}),(0,y.jsxs)("p",{children:["Feedback : ",n.raison.toLowerCase()]})]}),(0,y.jsx)(v.Z,{demandes:n.conversation})]});var t}const S=(0,h.v9)((e=>e.zone.zone)),b=e=>{var n;return null===(n=_.filter(S,{idZone:e})[0])||void 0===n?void 0:n.denomination};return(0,y.jsxs)(l.ZP,{container:!0,children:[(0,y.jsx)(y.Fragment,{children:j}),(0,y.jsxs)(l.ZP,{item:!0,lg:6,children:[(t||n)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.Z,{size:12,children:(0,y.jsx)(u.Z,{width:200,src:`${s.BP}/${n?n.demande.file:t.file}`,placeholder:(0,y.jsx)(u.Z,{preview:!1,src:`${s.BP}/${n?n.demande.file:t.file}`,width:200})})}),t&&!n&&(0,y.jsx)(C,{demandes:t}),n&&(0,y.jsx)(C,{demandes:n.demande})]}),!t&&m&&m.length>0&&(0,y.jsxs)("div",{style:{padding:"10px"},children:[(0,y.jsx)("p",{style:{padding:"0px",marginBottom:"15px",textAlign:"center",fontWeight:"bolder"},children:"Recent answers"}),m.map((e=>{var n;return(0,y.jsx)(a.Z,{style:{cursor:"pointer",padding:"5px",marginBottom:"4px"},children:(0,y.jsxs)("div",{children:[(0,y.jsxs)("p",{style:{padding:"0px",fontSize:"12px",margin:"0px"},children:[null===(n=e.agentSave)||void 0===n?void 0:n.nom,";",b(e.idZone)]}),(0,y.jsxs)("p",{style:{padding:"0px",fontSize:"12px",margin:"0px"},children:[(null===e||void 0===e?void 0:e.consExpDays)+"jr(s)",";"," "+(null===e||void 0===e?void 0:e.clientStatut),";"," "+(null===e||void 0===e?void 0:e.PayementStatut),(0,y.jsx)("span",{style:{float:"right",fontSize:"9px"},children:x()(e.createdAt).fromNow()})]})]})},e._id)}))]})]}),(0,y.jsx)(l.ZP,{item:!0,lg:6,children:(0,y.jsx)(d.Z,{titres:[{id:0,label:"Reponse"},{id:1,label:"Feedback"}],components:g})})]})}const F=i.memo(O)},208890:()=>{},421331:()=>{}}]);