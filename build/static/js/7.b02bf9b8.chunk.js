"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[7],{878375:(e,n,s)=>{s.d(n,{Z:()=>a});var i=s(557829),t=s(319860),l=s(346417);const a=e=>{let{text:n,taille:s,...a}=e;const d=(0,t.Z)();let r;switch(n){case"OUT SLA":case"Ouvert":case"Complaint to close":r=d.palette.warning.main;break;case"IN SLA":r=d.palette.info.main;break;case"Fermer":case"closed":case"resolved":r=d.palette.success.main;break;default:r=d.palette.secondary.main}return(0,l.jsx)(i.Z,{sx:{width:"100%",height:"50%",textAlign:"center",color:"white",borderRadius:"2px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",bgcolor:r,fontSize:s||12},...a,children:n&&(o=n,o.charAt(0).toUpperCase()+o.slice(1))});var o}},911:(e,n,s)=>{s.r(n),s.d(n,{default:()=>T});var i=s(557829),t=s(209478),l=s(435045),a=s(809019),d=s(301550),r=s(649914),o=s(241727),c=s(369099),p=s(861689),x=s(873428),h=s(619536),u=s(396180),m=s(846968),v=s(471562),j=s(835662),g=s(210658),Z=s.n(g),f=s(416031),P=s.n(f),y=s(70816),N=s.n(y),b=s(108262),w=s(747313),S=s(594500),D=s(661395),C=s(334811),k=s(270501),A=s(261113),M=s(346417);function Y(e){var n,s,i,t,l,d,r,o;let{plainteSelect:c}=e;const p=(0,S.v9)((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.user})),[x,u]=w.useState([]);w.useEffect((()=>{u(null===c||void 0===c?void 0:c.message)}),[c]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(a.ZP,{container:!0,sx:{marginTop:"10px"},children:[(0,M.jsxs)(a.ZP,{item:!0,lg:4,xs:12,sm:4,md:4,children:[(0,M.jsxs)(k.Z,{children:[(0,M.jsx)(a.ZP,{sx:{padding:"10px",backgroundColor:"rgb(0, 169, 224)",color:"#fff"},children:(0,M.jsx)(A.Z,{sx:{fontSize:"13px",fontWeight:"bolder"},noWrap:!0,children:c.nomClient})}),(0,M.jsxs)(a.ZP,{sx:{padding:"5px"},children:[(0,M.jsx)(a.ZP,{className:"month",children:c.codeclient}),(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"Type Plainte"}),(0,M.jsx)(A.Z,{className:"values",children:c.typePlainte})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"Plainte"}),(0,M.jsx)(A.Z,{className:"values",children:c.plainteSelect})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"Commentaire"}),(0,M.jsx)(A.Z,{className:"values",children:c.recommandation})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"Delai"}),(0,M.jsx)(A.Z,{className:"values",children:null===c||void 0===c?void 0:c.delai})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"openBy"}),(0,M.jsx)(A.Z,{className:"values",children:null===c||void 0===c?void 0:c.submitedBy})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:6,xs:12,sm:12,md:12,className:"grid",children:[(0,M.jsx)(A.Z,{className:"title",children:"statut"}),(0,M.jsx)(A.Z,{className:"values",children:null===c||void 0===c?void 0:c.statut})]})]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsx)(a.ZP,{item:!0,lg:12,xs:12,sm:12,md:12,className:"grid",children:(0,M.jsxs)("div",{children:["Desengagement"===c.statut&&(0,M.jsxs)("div",{className:"downgrade",children:[(0,M.jsx)("p",{className:"downgradeP",children:"Desengagement du client"}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Raison"})," : ",null===c||void 0===c||null===(n=c.desangagement)||void 0===n?void 0:n.raison]}),(0,M.jsx)("a",{rel:"noreferrer",target:"_blank",href:"".concat(D.fX,"/").concat(null===c||void 0===c||null===(s=c.desangagement)||void 0===s?void 0:s.filename),children:(0,M.jsx)("span",{children:"ouvrir le contrat"})})]}),"Downgrade"===c.statut&&(0,M.jsxs)("div",{className:"downgrade",children:[(0,M.jsx)("p",{className:"downgradeP",children:"Downgrade"}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"num_synchro"})," : ",null===c||void 0===c||null===(i=c.downgrade)||void 0===i?void 0:i.num_synchro]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"kit"})," : ",null===c||void 0===c||null===(t=c.downgrade)||void 0===t?void 0:t.kit]})]}),"Repossession volontaire"===c.statut&&(0,M.jsxs)("div",{className:"downgrade",children:[(0,M.jsx)("p",{className:"downgradeP",children:"Repossession volontaire"}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"num_synchro"})," : ",null===c||void 0===c||null===(l=c.repo_volontaire)||void 0===l?void 0:l.num_synchro]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Materiels"})," :"," ",null===c||void 0===c?void 0:c.repo_volontaire.materiel.map((e=>(0,M.jsx)("span",{children:e},e)))]})]}),"Upgrade"===c.statut&&(0,M.jsxs)("div",{className:"downgrade",children:[(0,M.jsx)("p",{className:"downgradeP",children:"Upgrade"}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Materiel"})," : ",null===c||void 0===c?void 0:c.upgrade]})]}),"Regularisation"===c.statut&&(0,M.jsxs)("div",{className:"downgrade",children:[(0,M.jsx)("p",{className:"downgradeP",children:"Regularisation"}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Jours"})," : ",null===c||void 0===c||null===(d=c.regularisation)||void 0===d?void 0:d.jours," jour(s)"]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"C.U"})," : ",null===c||void 0===c||null===(r=c.regularisation)||void 0===r?void 0:r.cu]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"date_coupure"})," : ",N()(null===c||void 0===c||null===(o=c.regularisation)||void 0===o?void 0:o.date_coupure).format("DD/MM/YYYY")]})]})]})}),(0,M.jsx)(a.ZP,{item:!0,lg:12,xs:12,sm:12,md:12,className:"grid",children:null!==c&&void 0!==c&&c.open?(0,D.bQ)((c.time_delai-((e,n)=>{let s=(new Date(n).getTime()-new Date(e).getTime())/6e4;return s<1?1:s})(c.fullDateSave,new Date)).toFixed(0)):(0,M.jsx)("p",{style:{background:"rgb(0, 169, 224)",color:"white",padding:"10px",margin:"0px",textAlign:"center"},children:null===c||void 0===c?void 0:c.delai})})]})]})]}),(0,M.jsx)(k.Z,{sx:{padding:"10px",marginTop:"4px"},children:c&&(null===c||void 0===c?void 0:c.resultat.length)>0&&(null===c||void 0===c?void 0:c.resultat.map((e=>(0,M.jsx)("div",{className:"resultat",children:(0,M.jsxs)("div",{children:[(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"last_status : "}),null===e||void 0===e?void 0:e.laststatus]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"change_to : "}),null===e||void 0===e?void 0:e.changeto]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Do_by : "}),null===e||void 0===e?void 0:e.nomAgent]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"SLA : "}),null===e||void 0===e?void 0:e.delai]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Comment : "}),null===e||void 0===e?void 0:e.commentaire]}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{children:"Date : "}),N()(null===e||void 0===e?void 0:e.fullDate).format("DD/MM/YYYY hh:mm")]})]})},e._id))))})]}),(0,M.jsxs)(a.ZP,{item:!0,lg:8,xs:12,sm:8,md:8,children:[(0,M.jsxs)(k.Z,{className:"papierConv",elevation:3,children:["ID complaint : ",null===c||void 0===c?void 0:c.idPlainte]}),(0,M.jsx)("div",{children:x&&x.map((e=>(0,M.jsx)(k.Z,{elevation:3,className:"papierConv",children:(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsx)(a.ZP,{item:!0,lg:2,className:"userP",children:(0,M.jsx)("div",{children:(0,M.jsx)(A.Z,{noWrap:!0,component:"p",children:e.agent===p.nom?"Moi":e.agent})})}),(0,M.jsx)(a.ZP,{item:!0,lg:10,className:"body_content",children:(0,M.jsx)("p",{children:e.content})})]})},e._id)))})]})]})})}const _=w.memo(Y);var R=s(728288),E=s(878375);const L=function(){const[e,n]=w.useState(""),[s,i]=w.useState(),[t,g]=w.useState(!1),[f,y]=w.useState(!1),[k,A]=w.useState([]),Y=(0,S.v9)((e=>e.user.user)),[L,T]=u.ZP.useMessage(),z=(e,n)=>{L.open({type:n,content:e,duration:5})},[F,I]=w.useState(0),[W,O]=w.useState(),[B,U]=w.useState(),q=async n=>{n.preventDefault();try{g(!0),i();const n=await j.Z.get("".concat(D.V6,"/oneReponse/").concat(e),D.vc);"token expired"===n.data?(localStorage.removeItem("auth"),window.location.replace("/login")):(I(0),i(P().groupBy(n.data.visites,"demande.lot")),A(P().groupBy(n.data.appels,"periode")),g(!1),0===n.data.visites.length&&z("No visits found","error"))}catch(s){g(!1)}};return(0,M.jsxs)(M.Fragment,{children:[T,(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsx)(a.ZP,{item:!0,lg:8,children:(0,M.jsx)(d.Z,{sx:{width:"100%"},children:(0,M.jsx)(r.Z,{size:"small",id:"header-search",startAdornment:(0,M.jsx)(o.Z,{position:"start",sx:{mr:-.5},children:(0,M.jsx)(R.Z,{})}),"aria-describedby":"header-search-text",inputProps:{"aria-label":"weight"},value:e,onChange:e=>(e=>{e.preventDefault(),n(e.target.value)})(e),onKeyUp:n=>(async n=>{13===n.keyCode&&""!==e&&q(n)})(n),placeholder:"Recherche"})})}),(0,M.jsx)(a.ZP,{item:!0,lg:2,sx:{paddingLeft:"10px"},children:(0,M.jsxs)(c.Z,{disabled:t,onClick:e=>q(e),variant:"contained",color:"primary",children:[(0,M.jsx)(l.Z,{fontSize:"small"})," ",t?"Loading...":"Recherche"]})})]}),0===F&&(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsx)(a.ZP,{item:!0,lg:9,children:(0,M.jsxs)(a.ZP,{sx:{marginTop:"10px"},children:[s&&Object.keys(s).map(((e,n)=>(0,M.jsxs)(w.Fragment,{children:[(0,M.jsx)("div",{className:"lot",children:e}),(0,M.jsxs)(a.ZP,{container:!0,children:[s[""+e].map(((e,n)=>{var s,i,t,l,d,r,o,c,u,j,g,f,P,N;return(0,M.jsxs)(w.Fragment,{children:[(0,M.jsx)(a.ZP,{item:!0,lg:4,children:(0,M.jsx)(p.Z,{title:"Cliquez pour modifier la reponse",children:(0,M.jsxs)(x.Z,{className:"reponseClasse",onClick:()=>(e=>{"superUser"===(null===Y||void 0===Y?void 0:Y.fonction)||["lionel","p.jonathan"].includes(null===Y||void 0===Y?void 0:Y.codeAgent)?(U(e),y(!0)):z("Cette visite ne peut pas \xeatre modifier, veuillez contacter l\u2019\xe9quipe support en cas de besoin","warning")})(e),variant:"outlined",sx:{padding:"5px",cursor:"pointer"},children:[(0,M.jsxs)("p",{className:"code",children:[e.codeclient,";"]}),(0,M.jsxs)("p",{children:[e.nomClient," "]}),(0,M.jsx)("p",{children:"Statut du compte:"}),(0,M.jsxs)("p",{children:["statut client : ",(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:e.clientStatut})]}),(0,M.jsxs)("p",{children:["statut payement : ",(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:e.PayementStatut})]}),(0,M.jsxs)("p",{children:["consExpDays : ",e.consExpDays," jour(s)"]}),(0,M.jsxs)("p",{children:["Saved by : ",e.agentSave.nom]}),(0,M.jsxs)("p",{className:"retard",children:["Date ",Z()(e.createdAt).format("DD/MM/YYYY")," \xe0 ",e.createdAt.split("T")[1].split(":")[0],":",e.createdAt.split("T")[1].split(":")[1]]})]})})}),(0,M.jsx)(a.ZP,{item:!0,lg:8,children:(0,M.jsxs)(a.ZP,{container:!0,children:[(0,M.jsx)(a.ZP,{item:!0,lg:3,sx:{padding:"5px"},children:(0,M.jsx)(m.Z,{size:12,children:(0,M.jsx)(v.Z,{width:150,height:150,src:"".concat(D.BP,"/").concat(null===(s=e.demande)||void 0===s?void 0:s.file),placeholder:(0,M.jsx)(v.Z,{preview:!1,src:"".concat(D.BP,"/").concat(null===(i=e.demande)||void 0===i?void 0:i.file),width:200,height:100})})})}),(0,M.jsx)(a.ZP,{item:!0,lg:9,sx:{paddingLeft:"30px"},children:(0,M.jsxs)(a.ZP,{className:"reponseClasse",children:[(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:"Statut du client : "})," ",e.demande.statut,";"]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:"Feedback : "})," ",null===(t=e.demande)||void 0===t?void 0:t.raison.toLowerCase(),";"]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:"Adresse "}),": ",null===(l=e.demande)||void 0===l?void 0:l.sector,","," ",null===(d=e.demande)||void 0===d?void 0:d.cell,", ",null===(r=e.demande)||void 0===r?void 0:r.sat,", ",e.demande.reference," "]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)("p",{children:[e.demandeur.fonction," ",e.demandeur.codeAgent,"; ",e.demandeur.nom,";"," "]}),"undefined"!==(null===(o=e.demande)||void 0===o?void 0:o.numero)&&(0,M.jsxs)("p",{children:[(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:"Numero joignable du client"})," : ",null===(c=e.demande)||void 0===c?void 0:c.numero]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)("p",{children:["undefined"!==(null===(u=e.coordonnee)||void 0===u?void 0:u.longitude)&&"long : ".concat(null===(j=e.coordonnee)||void 0===j?void 0:j.longitude),"undefined"!==(null===(g=e.coordonnee)||void 0===g?void 0:g.latitude)&&"lat : ".concat(null===(f=e.coordonnee)||void 0===f?void 0:f.latitude),"undefined"!==(null===(P=e.coordonnee)||void 0===P?void 0:P.altitude)&&"alt : ".concat(null===(N=e.coordonnee)||void 0===N?void 0:N.altitude)]}),(0,M.jsx)(h.Z,{}),(0,M.jsxs)("p",{className:"retard",children:[(0,M.jsx)("span",{style:{fontWeight:"bolder"},children:"Date"})," ",Z()(e.demande.createdAt).format("DD/MM/YYYY")," \xe0"," ",e.demande.createdAt.split("T")[1].split(":")[0],":",e.demande.createdAt.split("T")[1].split(":")[1]]})]})})]})})]},n+1)})),(0,M.jsx)("div",{className:"marge"})]})]},n))),B&&(0,M.jsx)(C.Z,{open:f,setOpen:y,title:"Modification",children:(0,M.jsx)(b.Z,{update:B})})]})}),(0,M.jsx)(a.ZP,{item:!0,lg:3,children:k&&Object.keys(k).map(((e,n)=>(0,M.jsxs)(w.Fragment,{children:[(0,M.jsx)("div",{className:"lot",children:e}),(0,M.jsx)(a.ZP,{container:!0,children:k[""+e].map(((e,n)=>(0,M.jsx)(a.ZP,{onClick:()=>(O(e),void I(1)),item:!0,lg:12,sx:{marginBottom:"2px"},children:(0,M.jsxs)(x.Z,{className:"reponseClasse",variant:"outlined",sx:{padding:"5px",cursor:"pointer"},children:[(0,M.jsxs)("p",{className:"code",children:["ID : ",e.idPlainte,"; type : ",e.type]}),(0,M.jsx)(E.Z,{text:e.open?"Ouvert":"Fermer"}),(0,M.jsxs)("p",{children:["statut :",null===e||void 0===e?void 0:e.statut," "]}),(0,M.jsxs)("p",{className:"retard",children:["Date ",N()(e.fullDateSave).format("DD/MM/YYYY hh:mm")," property : ",null===e||void 0===e?void 0:e.property]})]})},n+1)))})]},n)))})]}),1===F&&W&&(0,M.jsx)(_,{plainteSelect:W})]})};function T(){return(0,M.jsx)(t.Z,{children:(0,M.jsxs)(i.Z,{children:[" ",(0,M.jsx)(L,{})]})})}},334811:(e,n,s)=>{s.d(n,{Z:()=>x});var i=s(747313),t=s(966149),l=s(896467),a=s(233604),d=s(850301),r=s(508586),o=s(261113),c=s(346417);const p=i.forwardRef((function(e,n){return(0,c.jsx)(d.Z,{direction:"up",ref:n,...e})}));const x=function(e){let{open:n,children:s,setOpen:i,title:d}=e;return(0,c.jsx)("div",{children:(0,c.jsxs)(t.Z,{open:n,TransitionComponent:p,keepMounted:!0,onClose:()=>{i(!1)},"aria-describedby":"alert-dialog-slide-description",children:[(0,c.jsxs)(a.Z,{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)(o.Z,{children:d}),(0,c.jsx)(r.Z,{fontSize:"small",color:"secondary",style:{cursor:"pointer"},onClick:()=>i(!1)})]}),(0,c.jsx)(l.Z,{children:s})]})})}},728288:(e,n,s)=>{s.d(n,{Z:()=>r});var i=s(601413),t=s(747313),l=s(187190),a=s(690393),d=function(e,n){return t.createElement(a.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:n,icon:l.Z}))};d.displayName="SearchOutlined";const r=t.forwardRef(d)},241727:(e,n,s)=>{s.d(n,{Z:()=>Z});var i=s(747313),t=s(683061),l=s(608007),a=s(691615),d=s(261113),r=s(591397),o=s(799008),c=s(617592),p=s(814363),x=s(601167);function h(e){return(0,x.ZP)("MuiInputAdornment",e)}const u=(0,p.Z)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var m,v=s(577342),j=s(346417);const g=(0,c.ZP)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,n["position".concat((0,a.Z)(s.position))],!0===s.disablePointerEvents&&n.disablePointerEvents,n[s.variant]]}})((e=>{let{theme:n,ownerState:s}=e;return{display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(n.vars||n).palette.action.active,..."filled"===s.variant&&{["&.".concat(u.positionStart,"&:not(.").concat(u.hiddenLabel,")")]:{marginTop:16}},..."start"===s.position&&{marginRight:8},..."end"===s.position&&{marginLeft:8},...!0===s.disablePointerEvents&&{pointerEvents:"none"}}})),Z=i.forwardRef((function(e,n){const s=(0,v.Z)({props:e,name:"MuiInputAdornment"}),{children:c,className:p,component:x="div",disablePointerEvents:u=!1,disableTypography:Z=!1,position:f,variant:P,...y}=s,N=(0,o.Z)()||{};let b=P;P&&N.variant,N&&!b&&(b=N.variant);const w={...s,hiddenLabel:N.hiddenLabel,size:N.size,disablePointerEvents:u,position:f,variant:b},S=(e=>{const{classes:n,disablePointerEvents:s,hiddenLabel:i,position:t,size:d,variant:r}=e,o={root:["root",s&&"disablePointerEvents",t&&"position".concat((0,a.Z)(t)),r,i&&"hiddenLabel",d&&"size".concat((0,a.Z)(d))]};return(0,l.Z)(o,h,n)})(w);return(0,j.jsx)(r.Z.Provider,{value:null,children:(0,j.jsx)(g,{as:x,ownerState:w,className:(0,t.Z)(S.root,p),ref:n,...y,children:"string"!==typeof c||Z?(0,j.jsxs)(i.Fragment,{children:["start"===f?m||(m=(0,j.jsx)("span",{className:"notranslate",children:"\u200b"})):null,c]}):(0,j.jsx)(d.Z,{color:"text.secondary",children:c})})})}))}}]);