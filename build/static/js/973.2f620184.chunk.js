"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[973],{350723:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(91554),a=n(270501),s=n(585281),l=n(346417);const d=function(e){let{open:t,title:n,taille:d}=e;return(0,l.jsx)(r.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+100},open:t,children:(0,l.jsx)(a.Z,{sx:{width:d||"7rem",display:"flex",padding:"10px",alignItems:"center",justifyContent:"center"},children:(0,l.jsxs)("div",{style:{textAlign:"center"},children:[(0,l.jsx)(s.Z,{size:15,color:"primary"}),(0,l.jsx)("p",{style:{fontSize:"12px"},children:n||"Laading..."})]})})})}},249555:(e,t,n)=>{n.d(t,{Z:()=>s});const r=n.p+"static/media/loader.a8e321df755614ca01e3.gif";var a=n(346417);const s=function(e){let{width:t,height:n}=e;return(0,a.jsx)("div",{style:{display:"flex",alignContent:"center",justifyContent:"center",width:"100%",marginTop:"30px"},children:(0,a.jsx)("img",{width:t,height:n,src:r,alt:"Loading"})})}},876503:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(270501),a=n(809019),s=n(261113),l=n(614680),d=n(835662),i=n(249555),o=n(70816),c=n.n(o),h=n(747313),x=n(661395),u=n(348737),m=n(396180),p=n(350723),f=(n(699042),n(346417));const g=function(){const[e,t]=h.useState([]),[n,r]=h.useState(!1),[l,i]=m.ZP.useMessage(),o=(e,t)=>{l.open({type:t,content:""+e,duration:10})};return(0,f.jsxs)("div",{children:[(0,f.jsxs)(f.Fragment,{children:[i,n&&(0,f.jsx)(p.Z,{open:!0,title:"Please wait...",taille:"10rem"}),(0,f.jsxs)(a.ZP,{sx:{paddingLeft:"10px"},children:[(0,f.jsx)("input",{type:"file",id:"actual-btn",accept:".xlsx",hidden:!0,onChange:e=>(e=>{e.preventDefault(),r(!0);try{if(e.target.files){const n=new FileReader;n.onload=e=>{const n=e.target.result,a=u.ij(n,{type:"array"}),s=a.SheetNames[0],l=a.Sheets[s],d=u.P6.sheet_to_json(l);t(d),r(!1)},n.readAsArrayBuffer(e.target.files[0])}}catch(n){alert("Error "+n)}})(e)}),(0,f.jsx)("label",{className:"label",htmlFor:"actual-btn",children:"Clic here to choose file (you mast import only the customer id)"})]}),e.length>0&&(0,f.jsxs)(s.Z,{sx:{marginLeft:"15px",cursor:"pointer",color:"blue"},onClick:t=>(async t=>{t.preventDefault();try{let t=[];for(let r=0;r<e.length;r++)t.push(e[r].id);const n=await d.Z.post(x.V6+"/refresh_payment",{data:t},x.vc);200===n.status?o("Update of "+n.data.matchedCount+" customer","success"):o(""+n.data,"error")}catch(n){o(""+n,"error")}})(t),children:["Send data ",e.length]})]}),(0,f.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,f.jsxs)("table",{style:{width:"30%"},children:[(0,f.jsx)("thead",{children:(0,f.jsx)("tr",{children:(0,f.jsx)("td",{style:{textAlign:"center"},children:"id"})})}),(0,f.jsxs)("tbody",{children:[(0,f.jsx)("tr",{children:(0,f.jsx)("td",{style:{textAlign:"center"},children:"BDRC00000000"})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{style:{textAlign:"center"},children:"BDRC00000000"})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{style:{textAlign:"center"},children:"BDRC00000000"})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{style:{textAlign:"center"},children:"BDRC00000000"})})]})]})})]})},j=()=>{const[e,t]=h.useState(),[n,o]=h.useState(!1);h.useEffect((()=>{(async()=>{o(!0);try{const c=await d.Z.get(x.V6+"/call_today",x.vc);if(200===c.status){let d=c.data,h=[];for(let t=0;t<d.length;t++){var e,n,r,a,s,l,i;h.push({id:d[t].idDemande,customer_ID:d[t].codeclient,customer_name:d[t].nomClient,customer_status:d[t].clientStatut,PayementStatut:d[t].PayementStatut,Days:d[t].demande.jours,adresschange:d[t].adresschange,contact:"undefined"===(null===(e=d[t].demande)||void 0===e?void 0:e.numero)?"":null===(n=d[t].demande)||void 0===n?void 0:n.numero,Date:d[t].dateSave,commune:null===(r=d[t].demande)||void 0===r?void 0:r.commune,sector:null===(a=d[t].demande)||void 0===a?void 0:a.sector,cell:null===(s=d[t].demande)||void 0===s?void 0:s.cell,reference:null===(l=d[t].demande)||void 0===l?void 0:l.reference,sat:null===(i=d[t].demande)||void 0===i?void 0:i.sat})}t(h),o(!1)}}catch(c){console.log(c)}})()}),[]);const m=[{field:"customer_ID",headerName:"Customer",width:120,editable:!1},{field:"PayementStatut",headerName:"PayementStatut",width:100,editable:!1},{field:"Days",headerName:"Days",width:70,editable:!1,renderCell:e=>(0,f.jsx)(f.Fragment,{children:e.row.Days>1?e.row.Days+" jours":e.row.Days+"jour"})},{field:"adresschange",headerName:"Adresschange",width:100,editable:!1},{field:"contact",headerName:"contact",width:100,editable:!1},{field:"Date",headerName:"Date",width:100,editable:!1,renderCell:e=>(0,f.jsx)(f.Fragment,{children:c()(e.row.Date).format("DD-MM-YYYY")})},{field:"Adresse",headerName:"Adresse",width:430,editable:!1,renderCell:e=>(0,f.jsx)(f.Fragment,{children:e.row.commune+"/"+e.row.sector+"/"+e.row.cell+"/"+e.row.sat+"/"+e.row.reference})}],[p,j]=h.useState(!0);return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(r.Z,{elevation:4,sx:{padding:"10px"},children:[(0,f.jsxs)(a.ZP,{sx:{display:"flex"},children:[(0,f.jsx)(s.Z,{component:"p",onClick:()=>j(!p),style:{color:"blue",padding:"0px",margin:"0px",cursor:"pointer",fontWeight:"bolder",fontSize:"12px"},children:p?"Import payment":"Go back"}),e&&(0,f.jsx)(s.Z,{component:"p",onClick:()=>(()=>{const t=u.P6.json_to_sheet(e),n=u.P6.book_new();u.P6.book_append_sheet(n,t,"Customer_to_call_back"),u.NC(n,"Customer_to_call_back.xlsx")})(),style:{color:"green",padding:"0px",margin:"0px 15px",cursor:"pointer",fontWeight:"bolder",fontSize:"12px"},children:"Export to excel"})]}),n&&(0,f.jsx)(i.Z,{width:400,height:400}),p&&!n&&(0,f.jsx)(a.ZP,{children:e&&(0,f.jsx)(l._$,{rows:e,columns:m,initialState:{pagination:{paginationModel:{pageSize:15}}},pageSizeOptions:[15],checkboxSelection:!0,disableRowSelectionOnClick:!0})}),!p&&(0,f.jsx)(g,{})]})})}}}]);