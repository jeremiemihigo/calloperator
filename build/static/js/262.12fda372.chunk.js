"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[262],{803105:(e,n,t)=>{t.d(n,{Z:()=>d});var i=t(876767),o=t(648623),s=t(624631),l=t(346417);const a=(0,i.D)();const d=function(e){let{value:n,setValue:t,options:i,title:d,propr:c}=e;return(0,l.jsx)(o.Z,{value:n,onChange:(e,n)=>{"string"===typeof n?t({title:n}):n&&n.inputValue?t({title:n.inputValue}):t(n)},filterOptions:(e,n)=>a(e,n),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:i,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+c],renderOption:(e,n)=>(0,l.jsx)("li",{...e,children:n[""+c]},n.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,l.jsx)(s.Z,{...e,label:d||"Titre"})})}},680509:(e,n,t)=>{t.d(n,{Z:()=>s});var i=t(936373),o=t(346417);const s=function(e){const{message:n,open:t,setOpen:s}=e;return(0,o.jsx)("div",{children:(0,o.jsx)(i.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,onClose:()=>{s(!1)},message:n},"bottom center")})}},792628:(e,n,t)=>{t.d(n,{Z:()=>p});var i=t(557829),o=t(565280),s=t(406740),l=t(747313),a=t(346417);function d(e){const{children:n,value:t,index:o,...s}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:t!==o,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o),...s,children:t===o&&(0,a.jsx)(i.Z,{sx:{p:3},children:n})})}function c(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function r(e){let{titres:n,components:t}=e;const[r,p]=l.useState(0);return(0,a.jsxs)(i.Z,{sx:{width:"100%"},children:[(0,a.jsx)(i.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsx)(s.Z,{value:r,onChange:(e,n)=>{p(n)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:n.map(((e,n)=>(0,l.createElement)(o.Z,{label:e.label,...c(e.id),key:n})))})}),t.map(((e,n)=>(0,a.jsx)(d,{value:r,index:e.id,children:e.component},n)))]})}const p=l.memo(r)},571659:(e,n,t)=>{t.d(n,{Z:()=>l});t(747313);var i=t(70816),o=t.n(i),s=(t(208890),t(346417));const l=function(e){let{demandes:n}=e;return(0,s.jsx)("div",{className:"chats",children:n&&n.length>0&&n.map((e=>(0,s.jsxs)("div",{className:"co"===e.sender?"co":"agent",children:[(0,s.jsx)("p",{children:e.message}),(0,s.jsxs)("p",{style:{fontSize:"11px"},children:[(0,s.jsx)("span",{style:{textAlign:"center"},children:e.codeAgent}),(0,s.jsx)("span",{style:{float:"right"},children:o()(e.createdAt).fromNow()})]})]},e._id)))})}},108262:(e,n,t)=>{t.d(n,{Z:()=>F});var i=t(747313),o=t(661395),s=t(261113),l=t(809019),a=t(873428),d=t(792628),c=t(435593),r=t(396180),p=t(846968),u=t(471562),x=t(70816),m=t.n(x),h=t(286961),v=t(571659),g=t(319159),f=t(835662),j=t(594500),Z=t(346417);const{TextArea:C}=g.default;const y=function(e){let{demande:n,update:t}=e;const[s,l]=(0,i.useState)(""),a=(0,j.v9)((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.user}));return(0,Z.jsx)("div",{className:"container",children:(0,Z.jsx)("div",{className:"row",children:(0,Z.jsx)(C,{required:!0,value:s,onKeyUp:e=>(async e=>{if(t&&13===e.keyCode&&""!==s){l("");const e={message:s,_id:t._id,idDemande:t.idDemande,sender:"co",codeAgent:null===a||void 0===a?void 0:a.codeAgent};if(200===(await f.Z.post(o.V6+"/reclamation",e)).status)return}if(n&&13===e.keyCode&&""!==s){const e={_id:n._id,message:s,sender:"co",idDemande:n.idDemande,codeAgent:null===a||void 0===a?void 0:a.codeAgent};l("");const t=await f.Z.post(o.V6+"/reclamation",e);if(console.log(t),200===t.status)return}})(e),onChange:e=>{e.preventDefault(),l(e.target.value)},placeholder:"Messages",autoSize:{minRows:3,maxRows:5}})})})};var b=t(371207),S=t(808425),D=t(157983),w=t(624631),A=t(557829),E=t(301550),P=t(116429),z=t(183929),k=t(644758),N=t(369099),V=t(91554),T=t(585281),O=t(803105),W=t(680509),B=t(65387),I=t(528756);const R=function(e){let{update:n}=e;const t=(0,j.v9)((e=>e.zone.zone)),[s,a]=i.useState(""),[d,r]=i.useState(""),[p,u]=i.useState(!1),[x,m]=i.useState({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),h=e=>{const{name:n,value:t}=e.target;m({...x,[n]:t})},{demande:v}=(0,i.useContext)(c.E),{codeCu:g,codeClient:C,consExpDays:y,nomClient:_}=x;let[R,U]=i.useState({payement:"",statut:""});const{payement:F,statut:q}=R,[L,K]=i.useState(""),[M,H]=i.useState(!1),[J,G]=i.useState("");function Q(){m({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),U({payement:"",statut:""}),a(""),r(""),G("")}const X=(0,j.v9)((e=>e.reponse)),[Y,$]=i.useState(""),ee=e=>{$(""),m({...x,consExpDays:e});let n="",t="";return e>=0&&(n="installed",t="normal"),e>=-30&&e<=-1&&(n="installed",t="expired"),e>=-44&&e<=-31&&(n="installed",t="defaulted"),e<=-45&&(n="pending repossession",t="defaulted"),isNaN(e)&&(n="",t=""),U({payement:t,statut:n}),{payement:t,statut:n}},ne=(0,j.v9)((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.user})),te=(0,j.I0)(),ie=async()=>{var e;if(12===C.length&&C.toUpperCase().trim().startsWith("BDRC"))if(s&&d&&s.idZone!==d.idZone)K("Veuillez v\xe9rifier si le shop est enregistr\xe9 dans la region selection\xe9e"),H(!0);else if(v&&!["PO","ZBM"].includes(v.agent.fonction)&&(null===(e=v.shopAgent[0])||void 0===e?void 0:e.idShop)!==d.idShop){var n;K("y a pas une conformit\xe9 entre le shop du client << ".concat(null===d||void 0===d?void 0:d.shop," >> et celui de l'agent << ").concat(null===v||void 0===v||null===(n=v.shopAgent[0])||void 0===n?void 0:n.shop," >>")),H(!0)}else{const e={idDemande:v.idDemande,codeClient:C.toUpperCase().trim(),codeCu:g.trim(),codeAgent:null===ne||void 0===ne?void 0:ne.codeAgent,clientStatut:q,PayementStatut:F,adresschange:J,consExpDays:y.trim(),nomClient:_,idZone:s.idZone,idShop:d.idShop,fonctionAgent:v.agent.fonction,codeAgentDemandeur:v.agent.codeAgent,_idDemande:v._id,nomAgentSave:null===ne||void 0===ne?void 0:ne.nom};te((0,B.Z1)(e))}else K("Le code client n'est pas conforme"),H(!0)};i.useEffect((()=>{"success"===X.postDemande&&Q()}),[X]),i.useEffect((()=>{if(n){let e={consExpDays:n.consExpDays,codeClient:n.codeclient,codeCu:n.codeCu};ee(n.consExpDays),m({...x,...e})}}),[n]);const oe=(e,n)=>{n.preventDefault(),$(e),U("inactive"===e?{payement:"terminated",statut:"inactive"}:{payement:"pending fulfliment",statut:"pending activation"})},se=async()=>{let e=12===C.trim().length?C.toUpperCase().trim():8===C.length?"BDRC"+C.trim():"";if(""!==e){u(!0);const n=await f.Z.get("".concat(o.V6,"/customer/").concat(e));200===n.status?(m({...x,codeCu:n.data.customer_cu,nomClient:n.data.nomClient,consExpDays:"",codeClient:e}),r(n.data.shop),a(n.data.region),u(!1)):(u(!1),m({...x,codeCu:"",nomClient:"",consExpDays:""}),a(""),r(""))}},le=(0,j.v9)((e=>e.reponse));return(0,Z.jsxs)(l.ZP,{children:["pending"===le.postDemande&&(0,Z.jsx)(V.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,Z.jsx)("div",{children:(0,Z.jsx)("p",{style:{textAlign:"center",margin:"0px",padding:"0px"},children:"Please wait..."})})}),M&&(0,Z.jsx)(W.Z,{message:L,open:M,setOpen:H}),(0,Z.jsxs)(l.ZP,{container:!0,children:[(0,Z.jsx)(l.ZP,{item:!0,lg:10,xs:10,children:(0,Z.jsx)(w.Z,{style:{marginTop:"10px"},onChange:e=>h(e),name:"codeClient",onKeyUp:e=>(e=>{13===e.keyCode&&se()})(e),autoComplete:"off",fullWidth:!0,value:C,label:"Code du Client"})}),(0,Z.jsx)(l.ZP,{item:!0,lg:2,xs:2,sx:{display:"flex",cursor:"pointer",alignItems:"center",justifyContent:"center"},children:p?(0,Z.jsx)(T.Z,{size:15}):(0,Z.jsx)(D.default,{onClick:e=>se(),fontSize:"small"})})]}),(0,Z.jsx)(w.Z,{style:{marginTop:"10px"},onChange:e=>h(e),name:"nomClient",autoComplete:"off",fullWidth:!0,value:_,label:"Nom du Client"}),(0,Z.jsx)(w.Z,{style:{marginTop:"10px"},onChange:e=>h(e),value:g,name:"codeCu",autoComplete:"off",fullWidth:!0,label:"Code CU"}),(0,Z.jsxs)(l.ZP,{container:!0,children:[(0,Z.jsx)(l.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px"},children:(0,Z.jsx)(O.Z,{value:s,setValue:a,options:t,title:t&&t.length<1?"Loading...":"Regions",propr:"denomination"})}),(0,Z.jsx)(l.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px"},children:s&&""!==s&&null!==s&&(0,Z.jsx)(O.Z,{value:d,setValue:r,options:s&&s.shop,title:"Shop",propr:"shop"})})]}),(0,Z.jsx)("div",{style:{margin:"10px 0px"},children:(0,Z.jsx)(I.Z,{label:"Adresse",data:[{id:1,title:"Identifique \xe0 pulse",value:"Identique"},{id:2,title:"N'est pas identifique \xe0 pulse",value:"N'est pas identique"}],value:J,setValue:G})}),(0,Z.jsx)("div",{className:"expiredDate",children:(0,Z.jsx)(w.Z,{onChange:e=>ee(e.target.value),style:{marginTop:"10px"},name:"consExpDays",autoComplete:"off",fullWidth:!0,onKeyUp:n?()=>{}:e=>(e=>{13===e.keyCode&&ie()})(e),value:y,label:"consExpDays"})}),(0,Z.jsxs)(A.Z,{sx:{display:"flex"},children:[(0,Z.jsx)(E.Z,{component:"fieldset",variant:"standard",children:(0,Z.jsx)(P.Z,{children:(0,Z.jsx)(z.Z,{onClick:e=>oe("inactive",e),control:(0,Z.jsx)(k.Z,{name:"inactive",checked:"inactive"===Y}),label:"Inactive"})})}),(0,Z.jsx)(E.Z,{component:"fieldset",variant:"standard",children:(0,Z.jsx)(P.Z,{children:(0,Z.jsx)(z.Z,{onClick:e=>oe("pending",e),control:(0,Z.jsx)(k.Z,{name:"pending",checked:"pending"===Y}),label:"Pending activation"})})})]}),(0,Z.jsx)(w.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),U({...R,statut:e.target.value})},name:"statut",autoComplete:"off",fullWidth:!0,value:q,label:"Statut du client"}),(0,Z.jsx)(w.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),U({...R,payement:e.target.value})},name:"payement",autoComplete:"off",fullWidth:!0,value:F,label:"Statut Payement"}),(0,Z.jsx)("div",{style:{marginTop:"10px"},children:(0,Z.jsxs)(N.Z,{disabled:!v&&!n,fullWidth:!0,variant:"contained",color:"primary",onClick:n?()=>(async()=>{H(!1),f.Z.put(o.V6+"/reponse",{idReponse:n._id,data:{codeclient:C,nomClient:_,codeCu:g,clientStatut:q,PayementStatut:F,consExpDays:y,idZone:s.idZone,idShop:d.idShop}},o.vc).then((e=>{K(e.data),Q(),H(!0)})).catch((e=>{console.log(e)}))})():e=>{e.preventDefault(),ie()},children:[n?(0,Z.jsx)(b.Z,{fontSize:"small"}):(0,Z.jsx)(S.Z,{fontSize:"small"})," ",(0,Z.jsxs)("span",{style:{marginLeft:"10px"},children:[" ",n?"Update":"Save"]})]})})]})};t(421331);function U(e){const{update:n}=e,{demande:t,reponseNow:x}=(0,i.useContext)(c.E),g=[{id:0,component:(0,Z.jsx)(R,{update:n})},{id:1,component:(0,Z.jsx)(y,{demande:t,update:n})}],[f,j]=r.ZP.useMessage();function C(e){let{demandes:n}=e;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"demandeJsx",style:{textAlign:"justify"},children:["undefined"!==n.codeclient&&(0,Z.jsxs)(s.Z,{component:"p",className:"codeClient",onClick:()=>{return e=n.codeclient,navigator.clipboard.writeText(e),void f.open({type:"success",content:"Done "+e,duration:2});var e},style:{color:(t=n.codeclient,!t&&"red"),fontSize:"15px",fontWeight:"bolder"},children:["code client : ",n.codeclient&&n.codeclient.toUpperCase()]}),"undefined"!==n.numero&&(0,Z.jsxs)("p",{children:["Num\xe9ro joignable du client: ",n.numero]}),(0,Z.jsxs)("p",{children:["Statut du client : ","".concat("allumer"===n.statut?"allum\xe9":"\xe9teint")," "]}),(0,Z.jsxs)("p",{children:["Sector : ",null===n||void 0===n?void 0:n.sector," "]}),(0,Z.jsxs)("p",{children:["Cell : ",null===n||void 0===n?void 0:n.cell," "]}),(0,Z.jsxs)("p",{children:["Sat : ",null===n||void 0===n?void 0:n.sat," "]}),(0,Z.jsxs)("p",{children:["Reference : ",null===n||void 0===n?void 0:n.reference," "]}),(0,Z.jsxs)("p",{children:["Feedback : ",n.raison.toLowerCase()]})]}),(0,Z.jsx)(v.Z,{demandes:n.conversation})]});var t}const b=(0,h.v9)((e=>e.zone.zone)),S=e=>{var n;return null===(n=_.filter(b,{idZone:e})[0])||void 0===n?void 0:n.denomination};return(0,Z.jsxs)(l.ZP,{container:!0,children:[(0,Z.jsx)(Z.Fragment,{children:j}),(0,Z.jsxs)(l.ZP,{item:!0,lg:6,children:[(t||n)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(p.Z,{size:12,children:(0,Z.jsx)(u.Z,{width:200,src:"".concat(o.BP,"/").concat(n?n.demande.file:t.file),placeholder:(0,Z.jsx)(u.Z,{preview:!1,src:"".concat(o.BP,"/").concat(n?n.demande.file:t.file),width:200})})}),t&&!n&&(0,Z.jsx)(C,{demandes:t}),n&&(0,Z.jsx)(C,{demandes:n.demande})]}),!t&&x&&x.length>0&&(0,Z.jsxs)("div",{style:{padding:"10px"},children:[(0,Z.jsx)("p",{style:{padding:"0px",marginBottom:"15px",textAlign:"center",fontWeight:"bolder"},children:"Recent answers"}),x.map((e=>{var n;return(0,Z.jsx)(a.Z,{style:{cursor:"pointer",padding:"5px",marginBottom:"4px"},children:(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("p",{style:{padding:"0px",fontSize:"12px",margin:"0px"},children:[null===(n=e.agentSave)||void 0===n?void 0:n.nom,";",S(e.idZone)]}),(0,Z.jsxs)("p",{style:{padding:"0px",fontSize:"12px",margin:"0px"},children:[(null===e||void 0===e?void 0:e.consExpDays)+"jr(s)",";"," "+(null===e||void 0===e?void 0:e.clientStatut),";"," "+(null===e||void 0===e?void 0:e.PayementStatut),(0,Z.jsx)("span",{style:{float:"right",fontSize:"9px"},children:m()(e.createdAt).fromNow()})]})]})},e._id)}))]})]}),(0,Z.jsx)(l.ZP,{item:!0,lg:6,children:(0,Z.jsx)(d.Z,{titres:[{id:0,label:"Reponse"},{id:1,label:"Feedback"}],components:g})})]})}const F=i.memo(U)},528756:(e,n,t)=>{t.d(n,{Z:()=>c});var i=t(747313),o=t(315090),s=t(51405),l=t(301550),a=t(788797),d=t(346417);const c=function(e){const{label:n,data:t,value:c,setValue:r}=e,[p,u]=i.useState(!1);return(0,d.jsxs)(l.Z,{sx:{width:"100%"},children:[(0,d.jsx)(o.Z,{id:"demo-controlled-open-select-label",children:n}),(0,d.jsx)(a.Z,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:p,onClose:()=>{u(!1)},onOpen:()=>{u(!0)},value:c,label:n,onChange:e=>{r(e.target.value)},children:function(e){return e.map(((e,n)=>(0,d.jsx)(s.Z,{value:e.value,children:e.title},n)))}(t)})]})}},208890:()=>{},421331:()=>{}}]);