"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[78],{803105:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(81270),i=n(648623),o=n(624631),a=n(346417);const l=(0,s.D)();const d=function(e){let{value:t,setValue:n,options:s,title:d,propr:r}=e;return(0,a.jsx)(i.Z,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>l(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with",options:s,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+r],renderOption:(e,t)=>(0,a.jsx)("li",{...e,children:t[""+r]},t.id),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,a.jsx)(o.Z,{...e,label:d||"Titre"})})}},350723:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(91554),i=n(270501),o=n(585281),a=n(346417);const l=function(e){let{open:t,title:n,taille:l}=e;return(0,a.jsx)(s.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+100},open:t,children:(0,a.jsx)(i.Z,{sx:{width:l||"7rem",display:"flex",padding:"10px",alignItems:"center",justifyContent:"center"},children:(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)(o.Z,{size:15,color:"primary"}),(0,a.jsx)("p",{style:{fontSize:"12px"},children:n||"Laading..."})]})})})}},680509:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(786138),i=n(747313),o=n(346417);const a=function(e){const{message:t}=e,[n,a]=i.useState(!0);return(0,o.jsx)("div",{children:(0,o.jsx)(s.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:()=>{a(!1)},message:t},"bottom center")})}},899830:(e,t,n)=>{n.d(t,{Z:()=>D});var s=n(371207),i=n(157983),o=n(809019),a=n(624631),l=n(557829),d=n(301550),r=n(116429),c=n(183929),p=n(644758),u=n(369099),x=n(585281),h=n(803105),m=n(887392),v=n(846968),j=n(471562),g=n(835662),f=n(680509),Z=n(416031),y=n.n(Z),C=n(747313),b=n(594500),S=n(661395),P=n(528756),w=n(91554),E=n(346417);const D=function(e){let{update:t,show:n}=e;const Z=(0,b.v9)((e=>e.zone.zone)),D=(0,b.v9)((e=>e.shop.shop)),[k,N]=C.useState(""),[$,z]=C.useState(""),[W,I]=C.useState(!1),[T,R]=C.useState({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),L=e=>{const{name:t,value:n}=e.target;R({...T,[t]:n})},{resetData:V,changeReponse:A}=(0,C.useContext)(m.E),{codeCu:O,codeClient:M,consExpDays:U,nomClient:B}=T;let[F,K]=C.useState({payement:"",statut:""});const{payement:q,statut:_}=F,[H,Y]=C.useState(""),[G,J]=C.useState(!1),[Q,X]=C.useState("");function ee(){try{R({codeCu:"",codeClient:"",consExpDays:"",nomClient:""}),K({payement:"",statut:""}),N(""),z(""),X("")}catch(e){console.log(e)}}C.useEffect((()=>{ee()}),[V]);const[te,ne]=C.useState(""),se=e=>{ne(""),R({...T,consExpDays:e});let t="",n="";return e>=0&&(t="installed",n="normal"),e>=-30&&e<=-1&&(t="installed",n="expired"),e>=-44&&e<=-31&&(t="installed",n="defaulted"),e<=-45&&(t="pending repossession",n="defaulted"),isNaN(e)&&(t="",n=""),K({payement:n,statut:t}),{payement:n,statut:t}},ie=(0,b.v9)((e=>e.user.user)),[oe,ae]=C.useState(!1),le=async()=>{ae(!0);try{var e,n;if((null===ie||void 0===ie?void 0:ie.nom)!==(null===t||void 0===t||null===(e=t.agentSave)||void 0===e?void 0:e.nom)&&"superUser"!==(null===ie||void 0===ie?void 0:ie.fonction))Y(`seulement ${null===t||void 0===t||null===(n=t.agentSave)||void 0===n?void 0:n.nom} peut apporter une modification \xe0 cette r\xe9ponse`),J(!0),ae(!1);else if(""===M||""===B||""===O||""===_||""===q||""===U||isNaN(parseInt(U))||""===k||""===$||""===Q)Y("Veuillez renseigner tous les champs"),J(!0);else{J(!1);const e=await g.Z.put(S.V6+"/reponse",{idReponse:t._id,data:{codeclient:M,nomClient:B,codeCu:O,clientStatut:_,PayementStatut:q,consExpDays:U,idZone:k.idZone,idShop:$.idShop,adresse:Q}},S.vc);200===e.status?(A(e.data),ae(!1),Y("Mofication effectu\xe9e"),ee(),J(!0)):(ae(!1),Y("Error"),J(!0))}}catch(s){Y("Error "+s),J(!0),ae(!1)}},de=[{id:1,title:"Identifique \xe0 pulse",value:"Identique"},{id:2,title:"N'est pas identifique \xe0 pulse",value:"N'est pas identique"}];C.useEffect((()=>{if(t){let e={consExpDays:t.consExpDays,codeClient:t.codeclient,codeCu:t.codeCu,nomClient:t.nomClient};se(t.consExpDays),R({...T,...e});let n=de.filter((e=>e.value===(null===t||void 0===t?void 0:t.adresschange)));X(n[0].value);let s=y().filter(Z,{idZone:null===t||void 0===t?void 0:t.idZone}),i=y().filter(D,{idShop:null===t||void 0===t?void 0:t.idShop});N(s[0]),z(i[0])}}),[t]);const re=(e,t)=>{t.preventDefault(),ne(e),K("inactive"===e?{payement:"terminated",statut:"inactive"}:{payement:"pending fulfliment",statut:"pending activation"})},ce=async()=>{try{let e=12===M.trim().length?M.toUpperCase().trim():8===M.length?"BDRC"+M.trim():"";if(""!==e){I(!0);const t=await g.Z.get(`${S.V6}/customer/${e}`);if(200===t.status){const{info:n}=t.data;R({...T,codeCu:n.customer_cu,nomClient:n.nomClient,consExpDays:"",codeClient:e});let s=Z.filter((e=>e._id===n.region._id));z(n.shop),N(s[0]),I(!1)}else Y("Tu peux chercher ses informations dans pulse"),J(!0),I(!1),R({...T,codeCu:"",nomClient:"",consExpDays:""}),N(""),z("")}}catch(e){console.log(e)}};return(0,E.jsxs)(o.ZP,{children:[oe&&(0,E.jsx)(w.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,E.jsx)("div",{children:(0,E.jsx)("p",{style:{textAlign:"center",margin:"0px",padding:"0px"},children:"Please wait..."})})}),G&&(0,E.jsx)(f.Z,{message:H,open:G,setOpen:J}),(0,E.jsxs)(o.ZP,{container:!0,children:[(0,E.jsxs)(o.ZP,{item:!0,lg:10,xs:10,children:[n&&(0,E.jsx)(v.Z,{size:12,children:(0,E.jsx)(j.Z,{width:200,src:`${S.BP}/${t.demande.file}`,placeholder:(0,E.jsx)(j.Z,{preview:!1,src:`${S.BP}/${t.demande.file}`,width:200})})}),(0,E.jsx)(a.Z,{style:{marginTop:"10px"},onChange:e=>L(e),name:"codeClient",onKeyUp:e=>(e=>{13===e.keyCode&&ce()})(e),autoComplete:"off",fullWidth:!0,value:M,label:"Code du Client"})]}),(0,E.jsx)(o.ZP,{item:!0,lg:2,xs:2,sx:{display:"flex",cursor:"pointer",alignItems:"center",justifyContent:"center"},children:W?(0,E.jsx)(x.Z,{size:15}):(0,E.jsx)(i.default,{onClick:e=>ce(),fontSize:"small"})})]}),(0,E.jsx)(a.Z,{style:{marginTop:"10px"},onChange:e=>L(e),name:"nomClient",autoComplete:"off",fullWidth:!0,value:B,label:"Nom du Client"}),(0,E.jsx)(a.Z,{style:{marginTop:"10px"},onChange:e=>L(e),value:O,name:"codeCu",autoComplete:"off",fullWidth:!0,label:"Code CU"}),(0,E.jsxs)(o.ZP,{container:!0,children:[(0,E.jsx)(o.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px",paddingRight:"3px"},children:(0,E.jsx)(h.Z,{value:k,setValue:N,options:Z,title:Z&&Z.length<1?"Loading...":"Regions",propr:"denomination"})}),(0,E.jsx)(o.ZP,{item:!0,lg:6,sm:6,xs:12,sx:{marginTop:"10px"},children:k&&""!==k&&null!==k&&(0,E.jsx)(h.Z,{value:$,setValue:z,options:k&&k.shop,title:"Shop",propr:"shop"})})]}),(0,E.jsx)("div",{style:{margin:"10px 0px"},children:(0,E.jsx)(P.Z,{label:"Adresse",data:de,value:Q,setValue:X})}),(0,E.jsx)("div",{className:"expiredDate",children:(0,E.jsx)(a.Z,{onChange:e=>se(e.target.value),style:{marginTop:"10px"},name:"consExpDays",autoComplete:"off",fullWidth:!0,onKeyUp:e=>(e=>{13===e.keyCode&&le()})(e),value:U,label:"consExpDays"})}),(0,E.jsxs)(l.Z,{sx:{display:"flex"},children:[(0,E.jsx)(d.Z,{component:"fieldset",variant:"standard",children:(0,E.jsx)(r.Z,{children:(0,E.jsx)(c.Z,{onClick:e=>re("inactive",e),control:(0,E.jsx)(p.Z,{name:"inactive",checked:"inactive"===te}),label:"Inactive"})})}),(0,E.jsx)(d.Z,{component:"fieldset",variant:"standard",children:(0,E.jsx)(r.Z,{children:(0,E.jsx)(c.Z,{onClick:e=>re("pending",e),control:(0,E.jsx)(p.Z,{name:"pending",checked:"pending"===te}),label:"Pending activation"})})})]}),(0,E.jsxs)(o.ZP,{container:!0,children:[(0,E.jsx)(o.ZP,{item:!0,lg:6,sx:{paddingRight:"3px"},children:(0,E.jsx)(a.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),K({...F,statut:e.target.value})},disabled:!0,name:"statut",autoComplete:"off",fullWidth:!0,value:_,label:"Statut du client"})}),(0,E.jsxs)(o.ZP,{item:!0,lg:6,children:[" ",(0,E.jsx)(a.Z,{style:{marginTop:"10px"},onChange:e=>{e.preventDefault(),K({...F,payement:e.target.value})},disabled:!0,name:"payement",autoComplete:"off",fullWidth:!0,value:q,label:"Statut Payement"})]})]}),(0,E.jsx)("div",{style:{marginTop:"10px"},children:(0,E.jsxs)(u.Z,{disabled:!t,fullWidth:!0,variant:"contained",color:"primary",onClick:()=>le(),children:[(0,E.jsx)(s.Z,{fontSize:"small"}),(0,E.jsx)("span",{style:{marginLeft:"10px"},children:" Update"})]})})]})}},110078:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var s=n(557829),i=n(435045),o=n(301550),a=n(649914),l=n(241727),d=n(809019),r=n(873428),c=n(619536),p=n(396180),u=n(846968),x=n(471562),h=n(835662),m=n(416031),v=n.n(m),j=n(70816),g=n.n(j),f=n(747313),Z=n(661395),y=n(181171),C=n(346417);const b=(0,y.Z)((0,C.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");var S=n(270501),P=n(261113),w=n(350723),E=n(899830),D=n(594500),k=n(985038),N=n(861689),$=n(624631),z=n(369099);const W=function(e){let{id:t}=e;const[n,s]=f.useState(""),[i,o]=p.ZP.useMessage(),a=(e,t)=>{i.open({type:t,content:e,duration:5})};return(0,C.jsxs)("div",{style:{width:"20rem"},children:[o,(0,C.jsx)("div",{style:{marginTop:"10px"},children:(0,C.jsx)($.Z,{value:n,fullWidth:!0,onChange:e=>s(e.target.value),label:"Raison",id:"raison",type:"text",name:"raison"})}),(0,C.jsx)("div",{style:{marginTop:"10px"},children:(0,C.jsx)(z.Z,{fullWidth:!0,onClick:()=>(async()=>{try{const e=await h.Z.post(Z.V6+"/deletedemande",{message:n,id:t.idDemande},Z.vc);200===e.status?(a("Done","success"),s("")):a(""+e.data,"error")}catch(e){a(""+e,"error")}})(),variant:"contained",color:"primary",children:"Valider"})})]})};const I=function(){const[e,t]=f.useState(""),[n,s]=f.useState(),[m,j]=f.useState(!1),y=(0,D.v9)((e=>e.user.user)),[$,z]=p.ZP.useMessage(),[I,T]=f.useState(0),R=async e=>{try{j(!0),s();const i=await h.Z.get(`${Z.V6}/oneReponse/${e}`,Z.vc);"token expired"===i.data&&(localStorage.removeItem("auth"),window.location.replace("/login")),200===i.status&&(T(0),0===i.data.length?(t="No visits found",n="error",$.open({type:n,content:t,duration:5}),j(!1)):(s(v().groupBy(i.data,"demande.lot")),j(!1)))}catch(i){j(!1)}var t,n},L=e=>{if(e){let t=new Date(e),n=new Date(t.setHours(t.getHours()+1)).toISOString();return`${g()(n.split("T")[0]).format("DD/MM/YYYY")} \xe0 ${n.split("T")[1]}`}return""},[V,A]=f.useState(!1),[O,M]=f.useState(),[U,B]=f.useState(!1),[F,K]=f.useState("");return(0,C.jsxs)(C.Fragment,{children:[z,(0,C.jsx)(w.Z,{open:m,taille:"10rem",title:"Chargement..."}),(0,C.jsx)(N.Z,{title:"Go back",children:(0,C.jsx)(S.Z,{onClick:()=>{t(""),s()},elevation:1,sx:{padding:"5px",float:"left",cursor:"pointer"},children:(0,C.jsx)(b,{})})}),!n&&(0,C.jsx)("div",{className:"historique",children:(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{children:"Customer code"}),(0,C.jsx)(S.Z,{elevation:2,children:(0,C.jsx)(o.Z,{sx:{width:"100%"},children:(0,C.jsx)(a.Z,{size:"small",onKeyUp:e=>13===e.keyCode&&R(e.target.value),id:"header-search",className:"inputclasse",startAdornment:(0,C.jsx)(l.Z,{position:"start",sx:{mr:-.5},children:(0,C.jsx)(i.Z,{})}),"aria-describedby":"header-search-text",inputProps:{"aria-label":"weight"},value:e,onChange:e=>t(e.target.value),placeholder:""})})})]})}),0===I&&(0,C.jsx)(d.ZP,{container:!0,children:(0,C.jsx)(d.ZP,{item:!0,lg:12,children:(0,C.jsx)(d.ZP,{sx:{marginTop:"10px"},children:n&&Object.keys(n).map(((e,t)=>(0,C.jsxs)(f.Fragment,{children:[(0,C.jsx)("div",{className:"lot",children:e}),(0,C.jsxs)(d.ZP,{container:!0,children:[n[""+e].map(((e,t)=>{var n,s,i,o,a,l,p,h,m,v,j,g,b,S,w;return(0,C.jsxs)(f.Fragment,{children:[(0,C.jsx)(d.ZP,{item:!0,lg:4,md:5,sm:5,xs:10,children:(0,C.jsxs)(r.Z,{className:"reponseClasse",variant:"outlined",sx:{padding:"5px",cursor:"pointer"},children:[(0,C.jsxs)(P.Z,{className:"code",component:"p",children:[e.codeclient,y&&"superUser"===y.fonction&&(0,C.jsx)(P.Z,{component:"span",onClick:()=>(M(e),void A(!0)),style:{backgroundColor:"red",color:"#fff",borderRadius:"5px",padding:"4px 10px",cursor:"pointer"},children:"Delete"}),(0,C.jsx)(P.Z,{component:"span",onClick:()=>(K(e),void B(!0)),style:{backgroundColor:"rgb(0,169,244)",color:"#fff",borderRadius:"5px",marginLeft:"10px",padding:"4px 10px",cursor:"pointer"},children:"Edit"})]}),(0,C.jsxs)("p",{className:"customer_name",children:[e.nomClient," "]}),(0,C.jsx)("p",{children:"Statut du compte:"}),(0,C.jsxs)("p",{children:["statut client : ",(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:e.clientStatut})]}),(0,C.jsxs)("p",{children:["statut payement : ",(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:e.PayementStatut})]}),(0,C.jsxs)("p",{children:["consExpDays : ",(0,C.jsxs)("span",{style:{fontWeight:"bolder"},children:[e.consExpDays," jour(s)"]})]}),(0,C.jsxs)("p",{children:["Saved by : ",(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:e.agentSave.nom})]}),(0,C.jsxs)("p",{className:"retard",children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Kinshasa le, "})," ",L(e.createdAt)]})]})}),(0,C.jsx)(d.ZP,{item:!0,lg:3,md:2,sm:2,xs:2,sx:{padding:"5px"},children:(0,C.jsx)(u.Z,{children:(0,C.jsx)(x.Z,{style:{width:"100%",heigth:"100%"},src:`${Z.BP}/${null===(n=e.demande)||void 0===n?void 0:n.file}`,placeholder:(0,C.jsx)(x.Z,{preview:!1,src:`${Z.BP}/${null===(s=e.demande)||void 0===s?void 0:s.file}`,width:200,height:100})})})}),(0,C.jsx)(d.ZP,{item:!0,lg:5,md:5,sm:5,xs:12,sx:{lg:{paddingLeft:"30px"}},children:(0,C.jsxs)(d.ZP,{className:"reponseClasse",children:[(0,C.jsxs)("p",{children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Statut du client : "})," ",e.demande.statut,";"]}),(0,C.jsx)(c.Z,{}),(0,C.jsxs)("p",{children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Feedback : "})," ",null===(i=e.demande)||void 0===i?void 0:i.raison.toLowerCase(),";"]}),(0,C.jsx)(c.Z,{}),(0,C.jsxs)("p",{children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Adresse "}),": ",null===(o=e.demande)||void 0===o?void 0:o.sector,", ",null===(a=e.demande)||void 0===a?void 0:a.cell,","," ",null===(l=e.demande)||void 0===l?void 0:l.sat,", ",e.demande.reference," "]}),(0,C.jsx)(c.Z,{}),(0,C.jsxs)("p",{children:[e.demandeur.fonction," ",e.demandeur.codeAgent,"; ",e.demandeur.nom,";"," "]}),"undefined"!==(null===(p=e.demande)||void 0===p?void 0:p.numero)&&(0,C.jsxs)("p",{children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Numero joignable du client"})," : ",null===(h=e.demande)||void 0===h?void 0:h.numero]}),(0,C.jsx)(c.Z,{}),(0,C.jsxs)("p",{children:["undefined"!==(null===(m=e.coordonnee)||void 0===m?void 0:m.longitude)&&`long : ${null===(v=e.coordonnee)||void 0===v?void 0:v.longitude}`,"undefined"!==(null===(j=e.coordonnee)||void 0===j?void 0:j.latitude)&&`lat : ${null===(g=e.coordonnee)||void 0===g?void 0:g.latitude}`,"undefined"!==(null===(b=e.coordonnee)||void 0===b?void 0:b.altitude)&&`alt : ${null===(S=e.coordonnee)||void 0===S?void 0:S.altitude}`]}),(0,C.jsx)(c.Z,{}),(0,C.jsxs)("p",{className:"retard",children:[(0,C.jsx)("span",{style:{fontWeight:"bolder"},children:"Kinshasa le, "})," ",L(e.demande.createdAt||(null===(w=e.demande)||void 0===w?void 0:w.updatedAt))]})]})})]},t+1)})),(0,C.jsx)("div",{className:"marge"})]})]},t)))})})}),O&&(0,C.jsx)(k.Z,{open:V,setOpen:A,title:"Raison de suppression",children:(0,C.jsx)(W,{id:O})}),F&&(0,C.jsx)(k.Z,{open:U,setOpen:B,title:"Edit",children:(0,C.jsx)(E.Z,{update:F,show:!1})})]})};function T(){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(s.Z,{children:(0,C.jsx)(I,{})})})}},241727:(e,t,n)=>{n.d(t,{Z:()=>f});var s=n(747313),i=n(683061),o=n(608007),a=n(691615),l=n(261113),d=n(591397),r=n(799008),c=n(617592),p=n(814363),u=n(601167);function x(e){return(0,u.ZP)("MuiInputAdornment",e)}const h=(0,p.Z)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var m,v=n(577342),j=n(346417);const g=(0,c.ZP)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${(0,a.Z)(n.position)}`],!0===n.disablePointerEvents&&t.disablePointerEvents,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return{display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active,..."filled"===n.variant&&{[`&.${h.positionStart}&:not(.${h.hiddenLabel})`]:{marginTop:16}},..."start"===n.position&&{marginRight:8},..."end"===n.position&&{marginLeft:8},...!0===n.disablePointerEvents&&{pointerEvents:"none"}}})),f=s.forwardRef((function(e,t){const n=(0,v.Z)({props:e,name:"MuiInputAdornment"}),{children:c,className:p,component:u="div",disablePointerEvents:h=!1,disableTypography:f=!1,position:Z,variant:y,...C}=n,b=(0,r.Z)()||{};let S=y;y&&b.variant,b&&!S&&(S=b.variant);const P={...n,hiddenLabel:b.hiddenLabel,size:b.size,disablePointerEvents:h,position:Z,variant:S},w=(e=>{const{classes:t,disablePointerEvents:n,hiddenLabel:s,position:i,size:l,variant:d}=e,r={root:["root",n&&"disablePointerEvents",i&&`position${(0,a.Z)(i)}`,d,s&&"hiddenLabel",l&&`size${(0,a.Z)(l)}`]};return(0,o.Z)(r,x,t)})(P);return(0,j.jsx)(d.Z.Provider,{value:null,children:(0,j.jsx)(g,{as:u,ownerState:P,className:(0,i.Z)(w.root,p),ref:t,...C,children:"string"!==typeof c||f?(0,j.jsxs)(s.Fragment,{children:["start"===Z?m||(m=(0,j.jsx)("span",{className:"notranslate",children:"\u200b"})):null,c]}):(0,j.jsx)(l.Z,{color:"text.secondary",children:c})})})}))}}]);