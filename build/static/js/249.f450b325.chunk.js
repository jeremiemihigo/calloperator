"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[249],{483327:(e,t,l)=>{l.r(t),l.d(t,{default:()=>P});var n=l(270501),r=l(809019),i=l(301550),s=l(183929),a=l(644758),o=l(261113),c=l(835662),d=l(70816),u=l.n(d),p=l(747313),m=l(258467),h=l(262682),x=l(661395),v=l(985038),g=l(502040),f=l(799881),j=l(624631),Z=l(369099),b=l(528756),y=l(346417);const C=function(e){let{idServey:t}=e;const[l,n]=p.useState(""),[i,s]=p.useState(""),[a,d]=p.useState(),[u,m]=p.useState(""),[h,v]=p.useState([]);return(0,y.jsxs)("div",{style:{minWidth:"20rem",padding:"10px"},children:[(0,y.jsxs)("div",{style:{marginBottom:"5px"},children:[" ",a&&(0,y.jsx)(f.Z,{children:a})]}),(0,y.jsx)("div",{style:{marginBottom:"10px"},children:(0,y.jsx)(j.Z,{onChange:e=>{n(e.target.value),d()},name:"question",id:"outlined-multiline-static",label:"Question",fullWidth:!0})}),(0,y.jsx)("div",{children:(0,y.jsx)(b.Z,{label:"Select",data:[{id:1,title:"Select one",value:"select_one"},{id:2,title:"Select many",value:"select_many"},{id:3,title:"text",value:"text"},{id:4,title:"date",value:"date"}],value:i,setValue:s})}),i&&["select_one","select_many"].includes(i)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(r.ZP,{container:!0,sx:{margin:"10px 0px"},children:[(0,y.jsx)(r.ZP,{item:!0,lg:u?10:12,children:(0,y.jsx)(j.Z,{onChange:e=>{m(e.target.value),d()},value:u,name:"question",id:"outlined-multiline-static",label:"Item",fullWidth:!0})}),u&&(0,y.jsxs)(r.ZP,{item:!0,lg:2,sx:{display:"flex",paddingLeft:"4px",alignItems:"center"},children:[(0,y.jsx)(Z.Z,{onClick:()=>{v([...h,u]),m("")},variant:"contained",color:"secondary",children:(0,y.jsx)(g.Z,{fontSize:"small"})})," "]})]}),(0,y.jsx)("div",{children:h.map(((e,t)=>(0,y.jsxs)(o.Z,{onClick:()=>{v(h.filter((t=>t!==e)))},component:"p",children:[e," ",(0,y.jsx)("span",{style:{marginLeft:"10px",cursor:"pointer",fontSize:"10px",color:"red"},children:"Delete"})]},t)))})]}),(0,y.jsx)("div",{style:{marginTop:"10px"},children:(0,y.jsx)(Z.Z,{fullWidth:!0,onClick:()=>(async()=>{try{const e=await c.Z.post(`${x.n2}/question`,{question:l,type_reponse:i||"text",idServey:t,item:h},x.vc);200===e.status?(d("Done"),s(""),n("")):d(JSON.stringify(e.data))}catch(e){d(JSON.stringify(e))}})(),variant:"contained",color:"primary",children:"Valider"})})]})};const S=function(e){let{id:t}=e;const[l,n]=p.useState({debut:"",fin:""}),{debut:i,fin:s}=l,[a,o]=p.useState("");return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(r.ZP,{container:!0,style:{minWidth:"20rem",padding:"10px"},children:[a&&(0,y.jsx)(f.Z,{type:"success",children:a}),(0,y.jsx)(r.ZP,{item:!0,lg:1,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,y.jsx)("span",{children:"De"})}),(0,y.jsx)(r.ZP,{item:!0,lg:5,children:(0,y.jsx)(j.Z,{name:"debut",id:"outlined-multiline-static",type:"time",label:"Debut",onChange:e=>n({...l,debut:e.target.value}),fullWidth:!0})}),(0,y.jsx)(r.ZP,{item:!0,lg:1,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:"\xe0"}),(0,y.jsx)(r.ZP,{item:!0,lg:5,children:(0,y.jsx)(j.Z,{name:"Fin",type:"time",id:"outlined-multiline-static",label:"Fin",onChange:e=>n({...l,fin:e.target.value}),fullWidth:!0})})]}),(0,y.jsx)("div",{style:{marginTop:"10px"},children:(0,y.jsx)(Z.Z,{onClick:()=>(async()=>{try{const e=await c.Z.post(x.n2+"/requiredAt",{id:t,debut:i,fin:s},x.vc);200===e.status?o("Done"):o(e.data)}catch(e){console.log(e)}})(),variant:"contained",color:"primary",fullWidth:!0,children:"Submit"})})]})};l(522960);const P=function(){var e;const t=(0,m.UO)(),l=null===t||void 0===t?void 0:t.id,[d,g]=p.useState(!1),[f,j]=p.useState({questions:[],servey:{}}),{questions:Z,servey:b}=f,[P,A]=p.useState();p.useEffect((()=>{(async()=>{try{const e=await c.Z.get(`${x.n2}/fichier_servey/${l}`,x.vc);A(e.data)}catch(e){console.log(e)}})(),(async()=>{try{const e=await c.Z.get(`${x.n2}/readAllReponse/${l}`,x.vc);j(e.data)}catch(e){console.log(e)}})()}),[l]);const[k,$]=p.useState(!1),[q,M]=p.useState(!1);return(0,y.jsxs)("div",{children:[b&&(0,y.jsx)(n.Z,{elevation:3,className:"papier",children:(0,y.jsxs)(r.ZP,{container:!0,children:[(0,y.jsxs)(r.ZP,{item:!0,lg:6,className:"leftitem",children:[(0,y.jsx)("p",{className:"title",children:b.title}),(0,y.jsx)("p",{className:"subtitle",children:b.subtitle})]}),(0,y.jsxs)(r.ZP,{item:!0,lg:2,children:[(0,y.jsxs)("p",{children:["Closed at ",u()(b.dateFin).fromNow()]}),(0,y.jsxs)("p",{children:["Concerne les"," ",null===b||void 0===b||null===(e=b.concerne)||void 0===e?void 0:e.map(((e,t)=>(0,y.jsx)("span",{children:e+"; "},t)))]})]}),(0,y.jsxs)(r.ZP,{item:!0,lg:4,children:[(0,y.jsx)(i.Z,{component:"fieldset",variant:"standard",children:(0,y.jsx)(s.Z,{control:(0,y.jsx)(a.Z,{checked:k,onChange:()=>$(!k),value:k}),label:"Obligatoire \xe0 ceux qui n'ont pas encore repondu"})}),(0,y.jsx)(o.Z,{sx:{color:"blue",fontWeight:"bolder",cursor:"pointer",fontSize:"12px",marginBottom:"10px"},onClick:()=>g(!0),component:"p",children:"Cliquez ici pour ajouter une question"}),(0,y.jsx)(o.Z,{sx:{fontWeight:"bolder",cursor:"pointer",fontSize:"12px",marginBottom:"10px"},onClick:()=>M(!0),component:"p",children:"Cliquez ici pour voir le questionnaire"}),(0,y.jsx)(h.Z,{data:P,title:"Exporter_en_Excel",fileName:`${null===b||void 0===b?void 0:b.title}.xlsx`})]})]})}),(0,y.jsx)(v.Z,{open:q,setOpen:M,title:"Questionnaire",children:Z&&Z.length>0&&Z.map((e=>(0,y.jsxs)("div",{className:"q",children:[(0,y.jsxs)("p",{className:"q_title",children:[e.question," ",(0,y.jsx)("span",{className:"q_type",children:e.type_reponse})]}),["select_one","select_many"].includes(e.type_reponse)&&e.item.map(((e,t)=>(0,y.jsx)("span",{className:"q_item",children:e+"; "},t)))]},e._id)))}),(0,y.jsx)(n.Z,{elevation:2,sx:{padding:"5px"},children:(0,y.jsxs)("table",{children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"#"}),(0,y.jsx)("td",{children:"Code agent"}),Z&&Z.map((e=>(0,y.jsx)("td",{children:e.question},e._id)))]})}),(0,y.jsx)("tbody",{children:P&&P.map(((e,t)=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:t+1}),(0,y.jsx)("td",{children:e.codeAgent}),Z&&Z.map((t=>{return(0,y.jsx)("td",{children:(l=t.question,n=e.codeAgent,P.filter((e=>e.codeAgent===n)).length>0?P.filter((e=>e.codeAgent===n))[0][""+l]:"")},t._id);var l,n}))]},t)))})]})}),(0,y.jsx)(v.Z,{open:d,setOpen:g,title:"Add question",children:(0,y.jsx)(C,{idServey:l})}),(0,y.jsx)(v.Z,{open:k,setOpen:$,title:"Required at",children:(0,y.jsx)(S,{id:null===b||void 0===b?void 0:b._id})})]})}},262682:(e,t,l)=>{l.d(t,{Z:()=>a});var n=l(348737),r=l(809019);const i=l.p+"static/media/excelicon.ef839df4248f225f8214.jpg";var s=l(346417);const a=function(e){let{data:t,title:l,fileName:a}=e;return(0,s.jsxs)(r.ZP,{className:"divbtonExcel",onClick:()=>{t&&(e=>{const t=n.P6.json_to_sheet(e),l=n.P6.book_new();n.P6.book_append_sheet(l,t,"Visites"),n.NC(l,a)})(t)},children:[(0,s.jsx)("img",{width:20,height:20,src:i,alt:"Excel_icon"}),(0,s.jsx)("span",{children:l})]})}},502040:(e,t,l)=>{l.d(t,{Z:()=>i});var n=l(181171),r=l(346417);const i=(0,n.Z)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add")},799881:(e,t,l)=>{l.d(t,{Z:()=>$});var n=l(747313),r=l(683061),i=l(608007),s=l(913392),a=l(617592),o=l(577342),c=l(691615),d=l(270501),u=l(814363),p=l(601167);function m(e){return(0,p.ZP)("MuiAlert",e)}const h=(0,u.Z)("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);var x=l(947131),v=l(181171),g=l(346417);const f=(0,v.Z)((0,g.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),j=(0,v.Z)((0,g.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Z=(0,v.Z)((0,g.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),b=(0,v.Z)((0,g.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined");var y=l(891251);const C=(0,a.ZP)(d.Z,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,t[l.variant],t[`${l.variant}${(0,c.Z)(l.color||l.severity)}`]]}})((e=>{let{theme:t,ownerState:l}=e;const n="light"===t.palette.mode?s._j:s.$n,r="light"===t.palette.mode?s.$n:s._j,i=l.color||l.severity;return{...t.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",...i&&"standard"===l.variant&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${i}StandardBg`]:r(t.palette[i].light,.9),[`& .${h.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},...i&&"outlined"===l.variant&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),border:`1px solid ${(t.vars||t).palette[i].light}`,[`& .${h.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},...i&&"filled"===l.variant&&{fontWeight:t.typography.fontWeightMedium,...t.vars?{color:t.vars.palette.Alert[`${i}FilledColor`],backgroundColor:t.vars.palette.Alert[`${i}FilledBg`]}:{backgroundColor:"dark"===t.palette.mode?t.palette[i].dark:t.palette[i].main,color:t.palette.getContrastText(t.palette[i].main)}}}})),S=(0,a.ZP)("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),P=(0,a.ZP)("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),A=(0,a.ZP)("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),k={success:(0,g.jsx)(f,{fontSize:"inherit"}),warning:(0,g.jsx)(j,{fontSize:"inherit"}),error:(0,g.jsx)(Z,{fontSize:"inherit"}),info:(0,g.jsx)(b,{fontSize:"inherit"})},$=n.forwardRef((function(e,t){var l,n,s,a,d,u;const p=(0,o.Z)({props:e,name:"MuiAlert"}),{action:h,children:v,className:f,closeText:j="Close",color:Z,components:b={},componentsProps:$={},icon:q,iconMapping:M=k,onClose:_,role:N="alert",severity:w="success",slotProps:L={},slots:z={},variant:R="standard",...I}=p,W={...p,color:Z,severity:w,variant:R},F=(e=>{const{variant:t,color:l,severity:n,classes:r}=e,s={root:["root",`${t}${(0,c.Z)(l||n)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]};return(0,i.Z)(s,m,r)})(W),B=null!=(l=null!=(n=z.closeButton)?n:b.CloseButton)?l:x.Z,E=null!=(s=null!=(a=z.closeIcon)?a:b.CloseIcon)?s:y.Z,O=null!=(d=L.closeButton)?d:$.closeButton,D=null!=(u=L.closeIcon)?u:$.closeIcon;return(0,g.jsxs)(C,{role:N,elevation:0,ownerState:W,className:(0,r.Z)(F.root,f),ref:t,...I,children:[!1!==q?(0,g.jsx)(S,{ownerState:W,className:F.icon,children:q||M[w]||k[w]}):null,(0,g.jsx)(P,{ownerState:W,className:F.message,children:v}),null!=h?(0,g.jsx)(A,{ownerState:W,className:F.action,children:h}):null,null==h&&_?(0,g.jsx)(A,{ownerState:W,className:F.action,children:(0,g.jsx)(B,{size:"small","aria-label":j,title:j,color:"inherit",onClick:_,...O,children:(0,g.jsx)(E,{fontSize:"small",...D})})}):null]})}))},183929:(e,t,l)=>{l.d(t,{Z:()=>j});var n=l(747313),r=l(683061),i=l(608007),s=l(799008),a=l(261113),o=l(691615),c=l(617592),d=l(577342),u=l(814363),p=l(601167);function m(e){return(0,p.ZP)("MuiFormControlLabel",e)}const h=(0,u.Z)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var x=l(880300),v=l(346417);const g=(0,c.ZP)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[{[`& .${h.label}`]:t.label},t.root,t[`labelPlacement${(0,o.Z)(l.labelPlacement)}`]]}})((e=>{let{theme:t,ownerState:l}=e;return{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${h.disabled}`]:{cursor:"default"},..."start"===l.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},..."top"===l.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},..."bottom"===l.labelPlacement&&{flexDirection:"column",marginLeft:16},[`& .${h.label}`]:{[`&.${h.disabled}`]:{color:(t.vars||t).palette.text.disabled}}}})),f=(0,c.ZP)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${h.error}`]:{color:(t.vars||t).palette.error.main}}})),j=n.forwardRef((function(e,t){var l,c;const u=(0,d.Z)({props:e,name:"MuiFormControlLabel"}),{checked:p,className:h,componentsProps:j={},control:Z,disabled:b,disableTypography:y,inputRef:C,label:S,labelPlacement:P="end",name:A,onChange:k,required:$,slotProps:q={},value:M,..._}=u,N=(0,s.Z)(),w=null!=(l=null!=b?b:Z.props.disabled)?l:null==N?void 0:N.disabled,L=null!=$?$:Z.props.required,z={disabled:w,required:L};["checked","name","onChange","value","inputRef"].forEach((e=>{"undefined"===typeof Z.props[e]&&"undefined"!==typeof u[e]&&(z[e]=u[e])}));const R=(0,x.Z)({props:u,muiFormControl:N,states:["error"]}),I={...u,disabled:w,labelPlacement:P,required:L,error:R.error},W=(e=>{const{classes:t,disabled:l,labelPlacement:n,error:r,required:s}=e,a={root:["root",l&&"disabled",`labelPlacement${(0,o.Z)(n)}`,r&&"error",s&&"required"],label:["label",l&&"disabled"],asterisk:["asterisk",r&&"error"]};return(0,i.Z)(a,m,t)})(I),F=null!=(c=q.typography)?c:j.typography;let B=S;return null==B||B.type===a.Z||y||(B=(0,v.jsx)(a.Z,{component:"span",...F,className:(0,r.Z)(W.label,null==F?void 0:F.className),children:B})),(0,v.jsxs)(g,{className:(0,r.Z)(W.root,h),ownerState:I,ref:t,..._,children:[n.cloneElement(Z,z),B,L&&(0,v.jsxs)(f,{ownerState:I,"aria-hidden":!0,className:W.asterisk,children:["\u2009","*"]})]})}))},891251:(e,t,l)=>{l.d(t,{Z:()=>i});l(747313);var n=l(181171),r=l(346417);const i=(0,n.Z)((0,r.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},522960:()=>{}}]);